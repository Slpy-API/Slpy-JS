{"version":3,"file":"index.openlayers.js","sources":["../src/globals.js","../src/autocomplete.js","../src/utils.js","../src/markers.js","../src/streetLevel.js","../index.js","../src/addressAutocomplete.js","../src/aerialImagery.js","../src/openlayersFunctions.js","../src/loadOL.js","../src/loadOLMS.js","../index.openlayers.js"],"sourcesContent":["export let mapState = {\r\n    maplibreLoaded: false,\r\n    openlayersLoaded: false,\r\n    openlayersLoading: false,\r\n    openlayersReady: undefined,\r\n    mapStyleUrl: process.env.API_URL + \".slpy.com/style/slpy-mgl-style.json\",\r\n    oldIE: false,\r\n    aerialImageryOn: false,\r\n    streetLevelOn: false,\r\n};\r\n\r\nexport let settings = {\r\n    openlayersFallback: false,\r\n    rasterFallback: false,\r\n    mapFilter: [],\r\n    apiKey: \"\",\r\n    language: \"en\"\r\n};\r\n\r\nexport let openlayersParts = {\r\n    view: {},\r\n    controls: {},\r\n    interactions: {},\r\n};\r\n\r\nexport let mapLibraries = {\r\n    ol: undefined,\r\n    olms: undefined,\r\n    maplibregl: undefined\r\n}","//Copyright 2023, Slpy, all rights reserved.\r\n//Check out https://github.com/Spy-API/Slpy-JS and https://www.slpy.com/legal for licensing and terms\r\n\r\nimport { settings } from \"./globals.js\";\r\n\r\nexport function addAutocomplete(targetInput, autoOptions, onInputChange) {\r\n    if (typeof targetInput === \"string\") {\r\n        var inputField = document.getElementById(targetInput);\r\n    } else if (\r\n        targetInput &&\r\n        (targetInput.nodeName.toLowerCase() === \"input\" ||\r\n            targetInput.nodeName.toLowerCase() === \"textarea\")\r\n    ) {\r\n        var inputField = targetInput;\r\n    } else {\r\n        console.log(\"Target input for autocomplete is not a valid element or id\");\r\n    }\r\n    var onInputChange = onInputChange === undefined ? \"\" : onInputChange;\r\n    var autoCountry = \"US\";\r\n    if (autoOptions[\"country\"] !== undefined) {\r\n        autoCountry = autoOptions[\"country\"].toLowerCase();\r\n    }\r\n    var autoKey = \"\";\r\n    if (autoOptions[\"apiKey\"] !== undefined) {\r\n        autoKey = autoOptions[\"apiKey\"].toLowerCase();\r\n    }\r\n    var dropdownWidth = inputField.offsetWidth - 6 + \"px\";\r\n    if (autoOptions[\"width\"] !== undefined) {\r\n        dropdownWidth = autoOptions[\"width\"];\r\n    }\r\n    var offsetLeft = 3;\r\n    if (autoOptions[\"offsetLeft\"] !== undefined) {\r\n        offsetLeft = autoOptions[\"offsetLeft\"];\r\n    }\r\n    var offsetTop = 3;\r\n    if (autoOptions[\"offsetTop\"] !== undefined) {\r\n        offsetTop = autoOptions[\"offsetTop\"];\r\n    }\r\n    var autoCompleteType = \"all\";\r\n    if (autoOptions[\"autocompleteType\"] !== undefined) {\r\n        autoCompleteType = autoOptions[\"autocompleteType\"].toLowerCase();\r\n    }\r\n    var autoFilter = \"\";\r\n    if (autoOptions[\"filter\"] !== undefined) {\r\n        autoFilter = \"&filter=\" + autoOptions[\"filter\"].toLowerCase();\r\n    }\r\n    if (autoOptions[\"language\"] !== undefined) {\r\n        settings.language = autoOptions[\"language\"].toLowerCase();\r\n    }\r\n    var resultsLimit = 10;\r\n    if (autoOptions[\"limit\"] !== undefined) {\r\n        autoOptions[\"limit\"] = parseInt(autoOptions[\"limit\"]);\r\n        if (autoOptions[\"limit\"] < 10 && autoOptions[\"limit\"] > 0) {\r\n            resultsLimit = autoOptions[\"limit\"];\r\n        } else {\r\n            console.log(\"Autocomplete limit is outside of 1-10 range.\");\r\n        }\r\n    }\r\n    var debounceTime = 175;\r\n    if (autoOptions[\"debounceTime\"] !== undefined) {\r\n        autoOptions[\"debounceTime\"] = parseInt(autoOptions[\"debounceTime\"]);\r\n        if (autoOptions[\"debounceTime\"] < 1000 && autoOptions[\"debounceTime\"] > 0) {\r\n            debounceTime = autoOptions[\"debounceTime\"];\r\n        } else {\r\n            console.log(\"Autocomplete debounceTime is outside of 1-1000 range.\");\r\n        }\r\n    }\r\n    var listContainer = document.createElement(\"div\");\r\n    listContainer.className = \"apiautodropdown-content\";\r\n    listContainer.id = \"apiautodropdownContent \" + inputField.id;\r\n    var insertId = inputField;\r\n    if (typeof autoOptions[\"insertId\"] !== \"undefined\") {\r\n        var insertId = document.getElementById(autoOptions[\"insertId\"]);\r\n        insertId.appendChild(listContainer);\r\n    } else {\r\n        document.body.appendChild(listContainer);\r\n    }\r\n    function updateListContainerPosition(event) {\r\n        var containerPosition = inputField.parentNode.getBoundingClientRect();\r\n        var inputFieldRectStart = inputField.getBoundingClientRect();\r\n        if (typeof autoOptions[\"insertId\"] !== \"undefined\") {\r\n            var inputFieldRect = {\r\n                left: inputFieldRectStart.left - containerPosition.left,\r\n                top: inputFieldRectStart.top - containerPosition.top,\r\n                height: inputFieldRectStart.height\r\n            };\r\n        } else {\r\n            var inputFieldRect = inputField.getBoundingClientRect();\r\n        }\r\n        var viewportHeight = window.visualViewport\r\n            ? window.visualViewport.height\r\n            : window.innerHeight;\r\n        if (!event || event.type === \"resize\") {\r\n            // Set the listContainer's position and dimensions\r\n            listContainer.style.position = \"absolute\";\r\n            listContainer.style.left =\r\n                inputFieldRect.left + offsetLeft + window.pageXOffset + \"px\";\r\n            listContainer.style.top =\r\n                inputFieldRect.top +\r\n                inputFieldRect.height +\r\n                window.pageYOffset +\r\n                offsetTop +\r\n                \"px\";\r\n            listContainer.style.width = dropdownWidth;\r\n        }\r\n        if (!event || event.type === \"scroll\") {\r\n            var maxHeight = Math.max(\r\n                165,\r\n                viewportHeight -\r\n                inputFieldRectStart.top -\r\n                inputFieldRect.height -\r\n                offsetTop -\r\n                5\r\n            );\r\n            listContainer.style.maxHeight = maxHeight + \"px\";\r\n        }\r\n    }\r\n    function scrollIfNeeded(element) {\r\n        var rect = element.getBoundingClientRect();\r\n        var windowHeight =\r\n            window.innerHeight || document.documentElement.clientHeight;\r\n        var scrollAmount;\r\n        if (rect.bottom > windowHeight) {\r\n            var elementHeight = rect.height;\r\n            var visibleHeight = windowHeight - rect.top;\r\n            var scrollToHeight = elementHeight < 165 ? elementHeight : 165;\r\n            if (visibleHeight < scrollToHeight) {\r\n                scrollAmount = scrollToHeight - visibleHeight;\r\n                window.scrollBy(0, scrollAmount);\r\n            }\r\n        }\r\n    }\r\n    var lastSelect = 0;\r\n    var lastSearch = \"\";\r\n    function getClosest(elem, selector) {\r\n        for (; elem && elem !== document; elem = elem.parentNode) {\r\n            if (\r\n                elem.matches ? elem.matches(selector) : elem.msMatchesSelector(selector)\r\n            ) {\r\n                return elem;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    function addEvent(element, event, handler, useCapture) {\r\n        if (element.addEventListener) {\r\n            element.addEventListener(event, handler, useCapture);\r\n        } else if (element.attachEvent) {\r\n            element.attachEvent(\"on\" + event, handler);\r\n        }\r\n    }\r\n    function removeEvent(element, eventType, eventHandler, useCapture) {\r\n        if (element.removeEventListener) {\r\n            // Modern browsers\r\n            element.removeEventListener(eventType, eventHandler, useCapture);\r\n        } else if (element.detachEvent) {\r\n            // Internet Explorer 8 and older\r\n            element.detachEvent(\"on\" + eventType, eventHandler);\r\n        }\r\n    }\r\n    addEvent(\r\n        inputField,\r\n        \"keydown\",\r\n        function (e) {\r\n            lastSelect = 0;\r\n            if (e.keyCode === 40 || e.keyCode == 9) {\r\n                e.preventDefault();\r\n                listContainer.getElementsByClassName(\"apiautodropdown-item\")[0].focus();\r\n            } else if (e.keyCode == 13) {\r\n                listContainer.classList.remove(\"apiautodropdown-content-show\");\r\n                removeEvent(window, \"resize\", updateListContainerPosition, false);\r\n                removeEvent(window, \"scroll\", updateListContainerPosition, false);\r\n            }\r\n        },\r\n        false\r\n    );\r\n    addEvent(\r\n        listContainer,\r\n        \"keydown\",\r\n        function (e) {\r\n            if (e.keyCode === 40 || e.keyCode == 9) {\r\n                e.preventDefault();\r\n                if (\r\n                    typeof listContainer.getElementsByClassName(\"apiautodropdown-item\")[\r\n                    lastSelect + 1\r\n                    ] !== \"undefined\"\r\n                ) {\r\n                    lastSelect++;\r\n                    listContainer\r\n                        .getElementsByClassName(\"apiautodropdown-item\")\r\n                    [lastSelect].focus();\r\n                }\r\n            }\r\n            if (e.keyCode === 38) {\r\n                e.preventDefault();\r\n                if (lastSelect > 0) {\r\n                    lastSelect--;\r\n                } else {\r\n                    setTimeout(function () {\r\n                        inputField.focus();\r\n                    }, 10);\r\n                }\r\n                listContainer\r\n                    .getElementsByClassName(\"apiautodropdown-item\")\r\n                [lastSelect].focus();\r\n            }\r\n        },\r\n        false\r\n    );\r\n    function createCORSRequest(method, url) {\r\n        var xhr = new XMLHttpRequest();\r\n\r\n        // Check if the XMLHttpRequest object has the withCredentials property\r\n        // (not present in older versions of IE)\r\n        if (\"withCredentials\" in xhr) {\r\n            xhr.open(method, url, true);\r\n        }\r\n        // Check if XDomainRequest is available (IE9)\r\n        else if (typeof XDomainRequest != \"undefined\") {\r\n            xhr = new XDomainRequest();\r\n            xhr.open(method, url);\r\n        }\r\n        else {\r\n            // CORS not supported\r\n            xhr = null;\r\n        }\r\n        return xhr;\r\n    }\r\n    var currentRequest = null;\r\n    function makeRequest(url, callback) {\r\n        if (currentRequest) {\r\n            currentRequest.abort();\r\n        }\r\n        var xhr = createCORSRequest(\"POST\", url);\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState === 4) {\r\n                if (xhr.status === 200) {\r\n                    var obj = JSON.parse(xhr.responseText);\r\n                    callback(obj);\r\n                } else {\r\n                    console.log('Slpy Api: There was a problem with the request. Make sure the API Key is set correctly and the origin/referer request header matches your whitelisted domains.');\r\n                    var obj = JSON.parse(xhr.responseText);\r\n                    callback(obj);\r\n                }\r\n                currentRequest = null;\r\n            }\r\n        };\r\n        currentRequest = xhr;\r\n        xhr.send();\r\n    }\r\n    var resultsObj = {};\r\n    function updateGlobalObj(obj) {\r\n        resultsObj = obj;\r\n    }\r\n    function handleInput(e) {\r\n        if (e.keyCode === 13) {\r\n            if (listContainer.classList.contains(\"apiautodropdown-content-show\")) {\r\n                listContainer.classList.remove(\"apiautodropdown-content-show\");\r\n            }\r\n            return;\r\n        }\r\n        if (e.keyCode === 9) {\r\n            return;\r\n        }\r\n        var query = inputField.value.toLowerCase();\r\n        if (query.length > 1) {\r\n            query = encodeURIComponent(query);\r\n            if (query !== lastSearch + \" \" && query !== lastSearch) {\r\n                var processDropdown = function processDropdown(obj) {\r\n                    if (Object.keys(obj).length > 0) {\r\n                        var hasResults = false;\r\n                        if (\r\n                            typeof obj[0] !== \"undefined\" &&\r\n                            typeof obj[0].focus !== \"undefined\"\r\n                        ) {\r\n                            hasResults = true;\r\n                            listContainer.innerHTML = \"\";\r\n                        }\r\n                        Object.keys(obj).forEach(function (key) {\r\n                            if (\r\n                                typeof obj[key] !== \"undefined\" &&\r\n                                typeof obj[key].focus !== \"undefined\" &&\r\n                                key < resultsLimit\r\n                            ) {\r\n                                var ele = document.createElement(\"button\");\r\n                                ele.className = \"apiautodropdown-item\";\r\n                                ele.type = \"button\";\r\n                                var objIcon =\r\n                                    '<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"apiautodropdown-icon\" width=\"17px\" height=\"13px\" viewBox=\"0 0 448 512\"><!-- Font Awesome Pro 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) -->';\r\n                                switch (obj[key].quality) {\r\n                                    case 6:\r\n                                        objIcon =\r\n                                            objIcon +\r\n                                            '<path d=\"M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z\"/></svg>';\r\n                                        break;\r\n                                    case 5:\r\n                                        objIcon =\r\n                                            objIcon +\r\n                                            '<path d=\"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z\"/></svg>';\r\n                                        break;\r\n                                    case 4:\r\n                                        objIcon =\r\n                                            objIcon +\r\n                                            '<path d=\"M616 192H480V24c0-13.26-10.74-24-24-24H312c-13.26 0-24 10.74-24 24v72h-64V16c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v80h-64V16c0-8.84-7.16-16-16-16H80c-8.84 0-16 7.16-16 16v80H24c-13.26 0-24 10.74-24 24v360c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V216c0-13.26-10.75-24-24-24zM128 404c0 6.63-5.37 12-12 12H76c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12H76c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12H76c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm128 192c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm160 96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12V76c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm160 288c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40z\"/></svg>';\r\n                                        break;\r\n                                    case 3:\r\n                                        objIcon =\r\n                                            objIcon +\r\n                                            '<path d=\"M256 336h-.02c0-16.18 1.34-8.73-85.05-181.51-17.65-35.29-68.19-35.36-85.87 0C-2.06 328.75.02 320.33.02 336H0c0 44.18 57.31 80 128 80s128-35.82 128-80zM128 176l72 144H56l72-144zm511.98 160c0-16.18 1.34-8.73-85.05-181.51-17.65-35.29-68.19-35.36-85.87 0-87.12 174.26-85.04 165.84-85.04 181.51H384c0 44.18 57.31 80 128 80s128-35.82 128-80h-.02zM440 320l72-144 72 144H440zm88 128H352V153.25c23.51-10.29 41.16-31.48 46.39-57.25H528c8.84 0 16-7.16 16-16V48c0-8.84-7.16-16-16-16H383.64C369.04 12.68 346.09 0 320 0s-49.04 12.68-63.64 32H112c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h129.61c5.23 25.76 22.87 46.96 46.39 57.25V448H112c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h416c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z\"/></svg>';\r\n                                        break;\r\n                                    case 2:\r\n                                        objIcon =\r\n                                            objIcon +\r\n                                            '<path d=\"M496 128v16a8 8 0 0 1-8 8h-24v12c0 6.627-5.373 12-12 12H60c-6.627 0-12-5.373-12-12v-12H24a8 8 0 0 1-8-8v-16a8 8 0 0 1 4.941-7.392l232-88a7.996 7.996 0 0 1 6.118 0l232 88A8 8 0 0 1 496 128zm-24 304H40c-13.255 0-24 10.745-24 24v16a8 8 0 0 0 8 8h464a8 8 0 0 0 8-8v-16c0-13.255-10.745-24-24-24zM96 192v192H60c-6.627 0-12 5.373-12 12v20h416v-20c0-6.627-5.373-12-12-12h-36V192h-64v192h-64V192h-64v192h-64V192H96z\"/></svg>';\r\n                                        break;\r\n                                    case 1:\r\n                                        objIcon =\r\n                                            objIcon +\r\n                                            '<path d=\"M248 8C111.03 8 0 119.03 0 256s111.03 248 248 248 248-111.03 248-248S384.97 8 248 8zm82.29 357.6c-3.9 3.88-7.99 7.95-11.31 11.28-2.99 3-5.1 6.7-6.17 10.71-1.51 5.66-2.73 11.38-4.77 16.87l-17.39 46.85c-13.76 3-28 4.69-42.65 4.69v-27.38c1.69-12.62-7.64-36.26-22.63-51.25-6-6-9.37-14.14-9.37-22.63v-32.01c0-11.64-6.27-22.34-16.46-27.97-14.37-7.95-34.81-19.06-48.81-26.11-11.48-5.78-22.1-13.14-31.65-21.75l-.8-.72a114.792 114.792 0 0 1-18.06-20.74c-9.38-13.77-24.66-36.42-34.59-51.14 20.47-45.5 57.36-82.04 103.2-101.89l24.01 12.01C203.48 89.74 216 82.01 216 70.11v-11.3c7.99-1.29 16.12-2.11 24.39-2.42l28.3 28.3c6.25 6.25 6.25 16.38 0 22.63L264 112l-10.34 10.34c-3.12 3.12-3.12 8.19 0 11.31l4.69 4.69c3.12 3.12 3.12 8.19 0 11.31l-8 8a8.008 8.008 0 0 1-5.66 2.34h-8.99c-2.08 0-4.08.81-5.58 2.27l-9.92 9.65a8.008 8.008 0 0 0-1.58 9.31l15.59 31.19c2.66 5.32-1.21 11.58-7.15 11.58h-5.64c-1.93 0-3.79-.7-5.24-1.96l-9.28-8.06a16.017 16.017 0 0 0-15.55-3.1l-31.17 10.39a11.95 11.95 0 0 0-8.17 11.34c0 4.53 2.56 8.66 6.61 10.69l11.08 5.54c9.41 4.71 19.79 7.16 30.31 7.16s22.59 27.29 32 32h66.75c8.49 0 16.62 3.37 22.63 9.37l13.69 13.69a30.503 30.503 0 0 1 8.93 21.57 46.536 46.536 0 0 1-13.72 32.98zM417 274.25c-5.79-1.45-10.84-5-14.15-9.97l-17.98-26.97a23.97 23.97 0 0 1 0-26.62l19.59-29.38c2.32-3.47 5.5-6.29 9.24-8.15l12.98-6.49C440.2 193.59 448 223.87 448 256c0 8.67-.74 17.16-1.82 25.54L417 274.25z\"/></svg>';\r\n                                        break;\r\n                                    default:\r\n                                        objIcon =\r\n                                            objIcon +\r\n                                            '<path d=\"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z\"/></svg>';\r\n                                        break;\r\n                                }\r\n                                if (obj[key].focus.indexOf(\",\") > -1) {\r\n                                    ele.innerHTML =\r\n                                        objIcon +\r\n                                        '<div class=\"apiautodropdown-text\">' +\r\n                                        obj[key].focus.replace(\r\n                                            \",\",\r\n                                            '<span class=\"apiautodropdown-muted\">,'\r\n                                        ) +\r\n                                        \"</span></div>\";\r\n                                } else {\r\n                                    ele.innerHTML =\r\n                                        objIcon +\r\n                                        '<div class=\"apiautodropdown-text\">' +\r\n                                        obj[key].focus +\r\n                                        \"</div>\";\r\n                                }\r\n                                ele.setAttribute(\"autocompleteID\", key);\r\n                                listContainer.appendChild(ele);\r\n                            }\r\n                        });\r\n                        if (hasResults) {\r\n                            var poweredByLabel = document.createElement(\"div\");\r\n                            listContainer.appendChild(poweredByLabel);\r\n                            poweredByLabel.innerHTML =\r\n                                '<a href=\"https://www.slpy.com\" style=\"color:#888f94; text-decoration:none;\">powered by <span style=\"color:#5e849f;font-size:13px\">Slpy</a>';\r\n                            poweredByLabel.setAttribute(\r\n                                \"style\",\r\n                                \"line-height:13px; font-size: 12px; padding:2px 10px 0px 0px; margin: 0px; text-align:right\"\r\n                            );\r\n                            if (\r\n                                !listContainer.classList.contains(\r\n                                    \"apiautodropdown-content-show\"\r\n                                )\r\n                            ) {\r\n                                listContainer.classList.add(\"apiautodropdown-content-show\");\r\n                                updateListContainerPosition();\r\n                                addEvent(window, \"resize\", updateListContainerPosition, false);\r\n                                addEvent(window, \"scroll\", updateListContainerPosition, false);\r\n                                scrollIfNeeded(listContainer);\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (\r\n                            listContainer.classList.contains(\"apiautodropdown-content-show\")\r\n                        ) {\r\n                            listContainer.classList.remove(\"apiautodropdown-content-show\");\r\n                            removeEvent(window, \"resize\", updateListContainerPosition, false);\r\n                            removeEvent(window, \"scroll\", updateListContainerPosition, false);\r\n                        }\r\n                    }\r\n                };\r\n                lastSearch = query;\r\n                lastSelect = 0;\r\n                if (autoCompleteType == \"all\") {\r\n                    makeRequest(\r\n                        process.env.API_URL + \".slpy.com/v1/search?autocomplete=admin\" +\r\n                        autoFilter +\r\n                        \"&country=\" +\r\n                        autoCountry +\r\n                        \"&key=\" +\r\n                        autoKey +\r\n                        \"&language=\" +\r\n                        settings.language +\r\n                        \"&search=\" +\r\n                        query,\r\n                        function (obj) {\r\n                            if (Object.keys(obj).length < resultsLimit) {\r\n                                makeRequest(\r\n                                    process.env.API_URL + \".slpy.com/v1/search?autocomplete=address&country=\" +\r\n                                    autoCountry +\r\n                                    \"&key=\" +\r\n                                    autoKey +\r\n                                    \"&language=\" +\r\n                                    settings.language +\r\n                                    \"&search=\" +\r\n                                    query,\r\n                                    function (response) {\r\n                                        if (\r\n                                            typeof obj[0] === \"undefined\" ||\r\n                                            typeof obj[0].focus === \"undefined\" ||\r\n                                            obj[0].focus === \"\"\r\n                                        ) {\r\n                                            obj = response;\r\n                                        } else {\r\n                                            if (\r\n                                                typeof response[0].focus !== \"undefined\" &&\r\n                                                response[0].focus !== \"\"\r\n                                            ) {\r\n                                                var obj1Length = Object.keys(obj).filter(function (\r\n                                                    key\r\n                                                ) {\r\n                                                    return (\r\n                                                        !isNaN(parseInt(key, resultsLimit)) &&\r\n                                                        key === String(parseInt(key, resultsLimit))\r\n                                                    );\r\n                                                }).length;\r\n                                                for (var key in response) {\r\n                                                    if (\r\n                                                        Object.prototype.hasOwnProperty.call(response, key)\r\n                                                    ) {\r\n                                                        var newKey =\r\n                                                            parseInt(key, resultsLimit) + obj1Length;\r\n                                                        if (newKey < resultsLimit) {\r\n                                                            obj[newKey] = response[key];\r\n                                                        } else {\r\n                                                            break;\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                        processDropdown(obj);\r\n                                        updateGlobalObj(obj);\r\n                                    }\r\n                                );\r\n                            } else {\r\n                                processDropdown(obj);\r\n                                updateGlobalObj(obj);\r\n                            }\r\n                        }\r\n                    );\r\n                } else {\r\n                    var url;\r\n                    if (autoCompleteType == \"admin\") {\r\n                        url =\r\n                            process.env.API_URL + \".slpy.com/v1/search?autocomplete=admin\" +\r\n                            autoFilter +\r\n                            \"&country=\" +\r\n                            autoCountry +\r\n                            \"&key=\" +\r\n                            autoKey +\r\n                            \"&language=\" +\r\n                            settings.language +\r\n                            \"&search=\" +\r\n                            query;\r\n                    } else {\r\n                        url =\r\n                            process.env.API_URL + \".slpy.com/v1/search?autocomplete=address&country=\" +\r\n                            autoCountry +\r\n                            \"&key=\" +\r\n                            autoKey +\r\n                            \"&language=\" +\r\n                            settings.language +\r\n                            \"&search=\" +\r\n                            query;\r\n                    }\r\n                    makeRequest(url, function (obj) {\r\n                        processDropdown(obj);\r\n                        updateGlobalObj(obj);\r\n                    });\r\n                }\r\n            }\r\n        } else {\r\n            if (listContainer.classList.contains(\"apiautodropdown-content-show\")) {\r\n                listContainer.classList.remove(\"apiautodropdown-content-show\");\r\n                removeEvent(window, \"resize\", updateListContainerPosition, false);\r\n                removeEvent(window, \"scroll\", updateListContainerPosition, false);\r\n            }\r\n        }\r\n    }\r\n    function debounce(func, timeout) {\r\n        if (timeout === undefined) {\r\n            timeout = 175;\r\n        }\r\n        var timer;\r\n        return function () {\r\n            clearTimeout(timer);\r\n            var args = Array.prototype.slice.call(arguments);\r\n            timer = setTimeout(\r\n                function () {\r\n                    func.apply(this, args);\r\n                }.bind(this),\r\n                timeout\r\n            );\r\n        };\r\n    }\r\n    var debouncedInput = debounce(handleInput, debounceTime);\r\n    addEvent(inputField, \"input\", debouncedInput, false);\r\n    var dragging = false;\r\n    addEvent(\r\n        listContainer,\r\n        \"touchstart\",\r\n        function (event) {\r\n            if (\r\n                event.currentTarget.getAttribute(\"id\") ==\r\n                \"apiautodropdownContent \" + inputField.id\r\n            ) {\r\n                dragging = false;\r\n            }\r\n        },\r\n        false\r\n    );\r\n    addEvent(\r\n        listContainer,\r\n        \"touchmove\",\r\n        function (event) {\r\n            if (\r\n                event.currentTarget.getAttribute(\"id\") ==\r\n                \"apiautodropdownContent \" + inputField.id\r\n            ) {\r\n                dragging = true;\r\n            }\r\n        },\r\n        false\r\n    );\r\n    function handleClickOutside(event) {\r\n        if (!listContainer.contains(event.target) && event.target !== inputField) {\r\n            listContainer.classList.remove(\"apiautodropdown-content-show\");\r\n            removeEvent(window, \"resize\", updateListContainerPosition, false);\r\n            removeEvent(window, \"scroll\", updateListContainerPosition, false);\r\n        }\r\n    }\r\n    addEvent(document, \"click\", handleClickOutside, true);\r\n    addEvent(document, \"touchend\", handleClickOutside, true);\r\n    function handlerDropdownItemClick(targetInput, listContainer) {\r\n        return function (event) {\r\n            var dropdownItem = getClosest(event.target, \".apiautodropdown-item\");\r\n            if (dropdownItem) {\r\n                event.preventDefault();\r\n                if (dragging) {\r\n                    return;\r\n                }\r\n                if (document.activeElement !== dropdownItem) {\r\n                    dropdownItem.focus();\r\n                }\r\n                var txt = dropdownItem.textContent.trim();\r\n                lastSearch = txt.toLowerCase();\r\n                targetInput.value = txt;\r\n                listContainer.classList.remove(\"apiautodropdown-content-show\");\r\n                removeEvent(window, \"resize\", updateListContainerPosition, false);\r\n                removeEvent(window, \"scroll\", updateListContainerPosition, false);\r\n                var selectedObj = dropdownItem.getAttribute(\"autocompleteID\");\r\n\r\n                //do extra stuff\r\n                if (typeof onInputChange === \"function\") {\r\n                    onInputChange(inputField, resultsObj[selectedObj]);\r\n                }\r\n            } else if (event.target.getAttribute(\"id\") != targetInput.id) {\r\n                listContainer.classList.remove(\"apiautodropdown-content-show\");\r\n                removeEvent(window, \"resize\", updateListContainerPosition, false);\r\n                removeEvent(window, \"scroll\", updateListContainerPosition, false);\r\n            }\r\n        };\r\n    }\r\n    var handleDropdownItemClick = handlerDropdownItemClick(\r\n        inputField,\r\n        listContainer\r\n    );\r\n    addEvent(listContainer, \"click\", handleDropdownItemClick, true);\r\n    addEvent(listContainer, \"touchend\", handleDropdownItemClick, true);\r\n    function updateAutocomplete(newOptions) {\r\n        if (newOptions[\"country\"] !== undefined) {\r\n            autoCountry = newOptions[\"country\"].toLowerCase();\r\n        }\r\n        if (newOptions[\"autocomplete\"] !== undefined) {\r\n            autoCompleteType = newOptions[\"autocomplete\"].toLowerCase();\r\n        }\r\n        if (newOptions[\"filter\"] !== undefined) {\r\n            autoFilter = \"&filter=\" + newOptions[\"filter\"].toLowerCase();\r\n        }\r\n        removeEvent(inputField, \"input\", debouncedInput, false);\r\n        addEvent(inputField, \"input\", debouncedInput, false);\r\n    }\r\n    return {\r\n        updateAutocomplete: updateAutocomplete\r\n    };\r\n}","//Copyright 2023, Slpy, all rights reserved.\r\n//Check out https://github.com/Spy-API/Slpy-JS and https://www.slpy.com/legal for licensing and terms\r\n\r\nimport { mapState, mapLibraries } from './globals.js'\r\n\r\nexport function isEmptyObj(obj) {\r\n    for (var prop in obj) {\r\n        if (obj.hasOwnProperty(prop)) return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function isWebGL2Supported() {\r\n    try {\r\n        var canvas = document.createElement('canvas');\r\n        return !!(window.WebGL2RenderingContext && (canvas.getContext('webgl2') || canvas.getContext('experimental-webgl2')));\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n}\r\n\r\nexport function isWebGL1Supported() {\r\n    try {\r\n        var canvas = document.createElement('canvas');\r\n        return !!(window.WebGLRenderingContext && (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n}\r\n\r\nexport function isVectorSupported() {\r\n\r\n    //fail on ie 10 and below.  ie 10 does support canvas, but causes other failures.\r\n    var myNav = navigator.userAgent.toLowerCase();\r\n    if (parseInt(myNav.split(\"msie\")[1]) <= 10) {\r\n        return false;\r\n    }\r\n\r\n    function isCanvasSupported() {\r\n        var elem = document.createElement('canvas');\r\n        return !!(elem.getContext && elem.getContext('2d'));\r\n    }\r\n\r\n    // Check if browser can create sufficient number of Canvas contexts (limited in some browsers)\r\n    function checkCanvasContextLimit() {\r\n        var canvasLimit = 16; // Arbitrary reasonable number\r\n        var canvasArray = [];\r\n        for (var i = 0; i < canvasLimit; i++) {\r\n            var canvas = document.createElement('canvas');\r\n            var context = canvas.getContext('2d');\r\n            if (!context) {\r\n                console.log(\"Browser has limited Canvas contexts.\");\r\n                return false; // Browser hit limit\r\n            }\r\n            canvasArray.push(canvas); // Retain reference to prevent GC cleaning up canvases\r\n        }\r\n        return true; // All canvas contexts could be created\r\n    }\r\n\r\n    // Check if fetch and Promise APIs are supported\r\n    function isFetchAndPromiseSupported() {\r\n        return 'fetch' in window && 'Promise' in window;\r\n    }\r\n\r\n    // Check if CORS is supported\r\n    function isCORSSupported() {\r\n        return 'withCredentials' in new XMLHttpRequest();\r\n    }\r\n\r\n    // Ensure necessary features are available\r\n    return isCanvasSupported() && checkCanvasContextLimit() && isFetchAndPromiseSupported() && isCORSSupported();\r\n}\r\n\r\nexport function loadScript(url) {\r\n    var script = document.createElement(\"script\");\r\n    script.type = \"text/javascript\";\r\n    script.src = url;\r\n    document.head.appendChild(script);\r\n}\r\n\r\nexport function getJSON(url, success) {\r\n    var ud = \"_\" + +new Date(),\r\n        script = document.createElement(\"script\"),\r\n        head = document.getElementsByTagName(\"head\")[0] || document.documentElement;\r\n    window[ud] = function (data) {\r\n        head.removeChild(script);\r\n        success && success(data);\r\n    };\r\n    script.src = url.replace(\"callback=?\", \"callback=\" + ud);\r\n    head.appendChild(script);\r\n}\r\n\r\nexport function setInteractionOnFocus(div, mapob) {\r\n    var mapDivEl = document.getElementById(div);\r\n    mapDivEl.style.position = \"relative\";\r\n    mapDivEl.tabIndex = 1;\r\n    mapDivEl.insertAdjacentHTML(\r\n        \"afterbegin\",\r\n        '<p id=\"mapOverlayNotice\" style=\"position:absolute;z-index:10;margin-top:20px;width:100%;height:100%;font-weight:bold;font-size:22px;color:rgb(25, 25, 25);display:none;text-align:center;justify-content: center; align-items: center;\"><span style=\"background:white;padding: 10px;border-radius: 5px;box-shadow: 2px 2px 4px rgba(0,0,0,0.3);\">Click the map to pan and zoom.</span></p>'\r\n    );\r\n    var mapDivNotice = document.getElementById(\"mapOverlayNotice\");\r\n    if (typeof mapLibraries.ol !== \"undefined\") {\r\n        if (mapState.openlayersLoaded) {\r\n            mapob.getInteractions().forEach(function (interaction) {\r\n                if (interaction instanceof mapLibraries.ol.interaction.DragPan || interaction instanceof mapLibraries.ol.interaction.MouseWheelZoom) {\r\n                    interaction.setActive(false);\r\n                }\r\n            }, this);\r\n        }\r\n        mapDivEl.onclick = function () {\r\n            mapDivEl.removeEventListener(\"wheel\", handleMapTouch, false);\r\n            mapDivEl.removeEventListener(\"touchmove\", handleMapTouch, false);\r\n            if (mapState.openlayersLoaded) {\r\n                mapob.getInteractions().forEach(function (interaction) {\r\n                    if (interaction instanceof mapLibraries.ol.interaction.DragPan || interaction instanceof mapLibraries.ol.interaction.MouseWheelZoom) {\r\n                        interaction.setActive(true);\r\n                    }\r\n                }, this);\r\n            }\r\n        };\r\n    } else {\r\n        if (mapState.maplibreLoaded) {\r\n            mapob[\"scrollZoom\"].disable();\r\n            mapob[\"dragPan\"].disable();\r\n        }\r\n        mapDivEl.onclick = function () {\r\n            mapDivEl.removeEventListener(\"wheel\", handleMapTouch, false);\r\n            mapDivEl.removeEventListener(\"touchmove\", handleMapTouch, false);\r\n            if (mapState.maplibreLoaded) {\r\n                mapob[\"scrollZoom\"].enable();\r\n                mapob[\"dragPan\"].enable();\r\n            }\r\n        };\r\n    }\r\n    var timer = null;\r\n    var handleMapTouch = function handleMapTouch(event) {\r\n        if (document.activeElement !== mapDivEl) {\r\n            mapDivEl.style.opacity = \"0.7\";\r\n            mapDivNotice.style.display = \"flex\";\r\n            if (timer !== null) {\r\n                clearTimeout(timer);\r\n            }\r\n            timer = setTimeout(function () {\r\n                mapDivNotice.style.display = \"none\";\r\n                mapDivEl.style.opacity = \"1\";\r\n            }, 500);\r\n        }\r\n    };\r\n    mapDivEl.addEventListener(\"wheel\", handleMapTouch, false);\r\n    mapDivEl.addEventListener(\"touchmove\", handleMapTouch, false);\r\n}\r\n\r\nexport function setTransform(transform, map) {\r\n    //mgl only\r\n    if (typeof map === \"undefined\") {\r\n        console.log(\"Map was undefined.  The second parameter should be of type Map.\");\r\n        return;\r\n    }\r\n    if (typeof mapLibraries.ol === \"undefined\") {\r\n        if (typeof mapState.mapStyleUrl !== \"undefined\") {\r\n            var urlParts = mapState.mapStyleUrl.split(\"?\");\r\n            var baseUrl = urlParts[0];\r\n            var queryString = urlParts[1];\r\n            var params = queryString.split(\"&\");\r\n            var newParams = [];\r\n            for (var i = 0; i < params.length; i++) {\r\n                if (params[i].indexOf(\"transform=\") === -1) {\r\n                    newParams.push(params[i]);\r\n                }\r\n            }\r\n            mapState.mapStyleUrl = baseUrl + \"?\" + newParams.join(\"&\");\r\n            if (transform != \"\" && transform != \"default\") {\r\n                mapState.mapStyleUrl = mapState.mapStyleUrl + \"&transform=\" + transform;\r\n            }\r\n            map.setStyle(mapState.mapStyleUrl);\r\n        } else {\r\n            console.log(\"Could not retrieve original url. mapStyleUrl is undefined.\");\r\n        }\r\n    } else {\r\n        console.log(\"Can not currently set Transform with OpenLayers.  Requires MapLibre.\");\r\n    }\r\n}\r\n\r\nexport function flyTo(obj, map) {\r\n    if (typeof mapLibraries.ol !== \"undefined\") {\r\n        var view = map.getView();\r\n        var startPoint = mapLibraries.ol.proj.toLonLat(view.getCenter());\r\n        var destination = mapLibraries.ol.proj.fromLonLat([obj.lon, obj.lat]);\r\n        var currentZoom = view.getZoom();\r\n        var quality = obj.quality;\r\n        var done = function done() { };\r\n        var parts = 2;\r\n        var called = false;\r\n    } else {\r\n        var getcenter = map.getCenter();\r\n        var startPoint = Object.values(getcenter);\r\n        var destination = [obj.lon, obj.lat];\r\n        var currentZoom = map.getZoom();\r\n    }\r\n    var zoom = currentZoom;\r\n    var quality = obj.quality;\r\n    var distance = distanceInKM(obj.lat, obj.lon, startPoint[1], startPoint[0]);\r\n    var duration = 1000;\r\n    var topZoom = zoom - 1;\r\n    switch (true) {\r\n        case distance < 1:\r\n            if (zoom > 16) {\r\n                topZoom = 16;\r\n            }\r\n            break;\r\n        case distance < 5:\r\n            if (zoom > 15) {\r\n                topZoom = 15;\r\n            }\r\n            break;\r\n        case distance < 10:\r\n            if (zoom > 14) {\r\n                topZoom = 14;\r\n            }\r\n            break;\r\n        case distance < 40:\r\n            if (zoom > 13) {\r\n                topZoom = 13;\r\n            }\r\n            break;\r\n        case distance < 50:\r\n            if (zoom > 12) {\r\n                topZoom = 12;\r\n            }\r\n            duration *= 2;\r\n            break;\r\n        case distance < 150:\r\n            if (zoom > 11) {\r\n                topZoom = 11;\r\n            }\r\n            duration *= 2;\r\n            break;\r\n        case distance < 250:\r\n            if (zoom > 10) {\r\n                topZoom = 10;\r\n            }\r\n            duration *= 2;\r\n            break;\r\n        case distance < 400:\r\n            if (zoom > 9) {\r\n                topZoom = 9;\r\n            }\r\n            duration *= 3;\r\n            break;\r\n        case distance < 700:\r\n            if (zoom > 8) {\r\n                topZoom = 8;\r\n            }\r\n            duration *= 3;\r\n            break;\r\n        case distance < 1000:\r\n            if (zoom > 7) {\r\n                topZoom = 7;\r\n            }\r\n            duration *= 3;\r\n            break;\r\n        case distance < 2000:\r\n            if (zoom > 6) {\r\n                topZoom = 6;\r\n            }\r\n            duration *= 4;\r\n            break;\r\n        case distance < 3500:\r\n            if (zoom > 5) {\r\n                topZoom = 5;\r\n            }\r\n            duration *= 4;\r\n            break;\r\n        case distance < 5000:\r\n            if (zoom > 4) {\r\n                topZoom = 4;\r\n            }\r\n            duration *= 4;\r\n            break;\r\n        case distance >= 5000:\r\n            if (zoom > 3) {\r\n                topZoom = 3;\r\n            }\r\n            duration *= 4;\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n    if (zoom < 13) {\r\n        zoom = 13;\r\n    }\r\n    switch (parseInt(quality)) {\r\n        case 1:\r\n            zoom = 4;\r\n            break;\r\n        case 2:\r\n            zoom = 6;\r\n            break;\r\n        case 3:\r\n            zoom = 8;\r\n            break;\r\n        case 4:\r\n            zoom = 10;\r\n            break;\r\n        case 5:\r\n            zoom = 12;\r\n            break;\r\n        case 6:\r\n            zoom = 13;\r\n            break;\r\n        case 7:\r\n            zoom = 16;\r\n            break;\r\n        case 8:\r\n            zoom = 16.5;\r\n            break;\r\n        case 9:\r\n        case 10:\r\n            zoom = 17;\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n    if (topZoom >= zoom) {\r\n        topZoom = zoom - 1;\r\n    }\r\n    if (currentZoom >= zoom) {\r\n        topZoom = zoom;\r\n    }\r\n    if (typeof mapLibraries.ol !== \"undefined\") {\r\n        var callback = function callback(complete) {\r\n            --parts;\r\n            if (called) {\r\n                return;\r\n            }\r\n            if (parts === 0 || !complete) {\r\n                called = true;\r\n                done(complete);\r\n            }\r\n        };\r\n        view.animate(\r\n            {\r\n                center: destination,\r\n                duration: duration\r\n            },\r\n            callback\r\n        );\r\n        view.animate(\r\n            {\r\n                zoom: topZoom,\r\n                duration: duration\r\n            },\r\n            {\r\n                zoom: zoom,\r\n                duration: duration / 2\r\n            },\r\n            callback\r\n        );\r\n    } else {\r\n        if (obj.boundingbox) {\r\n            var bbox = obj.boundingbox;\r\n            map.fitBounds([[bbox[2], bbox[0]],[bbox[3], bbox[1]]], {maxZoom:18,  padding: {top: 15, bottom:15, left: 15, right: 15}});\r\n        } else {\r\n            var flyOpt = {\r\n                center: destination,\r\n                zoom: zoom,\r\n                maxDuration: duration * 2.5\r\n            }\r\n            if (zoom != topZoom) {\r\n               // flyOpt.minZoom = topZoom\r\n            }\r\n            map.flyTo(\r\n                flyOpt\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\nexport function toRad(x) {\r\n    return (x * Math.PI) / 180;\r\n}\r\n\r\nexport function distanceInKM(lat1, lon1, lat2, lon2) {\r\n    var R = 6371; // km\r\n    var dLon = toRad(lon2 - lon1),\r\n        lat1 = toRad(lat1),\r\n        lat2 = toRad(lat2),\r\n        d =\r\n            Math.acos(\r\n                Math.sin(lat1) * Math.sin(lat2) +\r\n                Math.cos(lat1) * Math.cos(lat2) * Math.cos(dLon)\r\n            ) * R;\r\n    return d;\r\n}\r\n\r\nexport function distanceInMI(lat1, lon1, lat2, lon2) {\r\n    var R = 3959; // miles\r\n    var dLon = toRad(lon2 - lon1),\r\n        lat1 = toRad(lat1),\r\n        lat2 = toRad(lat2),\r\n        d =\r\n            Math.acos(\r\n                Math.sin(lat1) * Math.sin(lat2) +\r\n                Math.cos(lat1) * Math.cos(lat2) * Math.cos(dLon)\r\n            ) * R;\r\n    return d;\r\n}","//Copyright 2023, Slpy, all rights reserved.\r\n//Check out https://github.com/Spy-API/Slpy-JS and https://www.slpy.com/legal for licensing and terms\r\n\r\nimport { mapLibraries } from './globals.js'\r\nimport { distanceInKM } from './utils.js';\r\n\r\nexport let hasPopupInfo = false;\r\nexport let markerVectorSource;\r\nexport let markerVectorLayer;\r\nexport let markerOverlay;\r\n\r\nexport function addMarkers(markers, map, style) {\r\n    var style = style === undefined ? \"default\" : style;\r\n    var markerFeature = [];\r\n    if (typeof mapLibraries.ol !== \"undefined\") {\r\n        for (var i = 0; i < markers.length; i++) {\r\n            if (style == \"default\") {\r\n                markerFeature.push(\r\n                    createMarker(\r\n                        [markers[i].data[1], markers[i].data[0]],\r\n                        markers[i].name,\r\n                        i,\r\n                        style\r\n                    )\r\n                );\r\n            } else {\r\n                var markerFeatures = createMarker(\r\n                    [markers[i].data[1], markers[i].data[0]],\r\n                    markers[i].name,\r\n                    i,\r\n                    style\r\n                );\r\n                markerFeature.push(markerFeatures[0], markerFeatures[1]);\r\n            }\r\n            if (typeof markers[i].data[2] !== \"undefined\") {\r\n                if (markers[i].data[2] !== \"\") {\r\n                    hasPopupInfo = true;\r\n                }\r\n            }\r\n        }\r\n        markerVectorSource = new mapLibraries.ol.source.Vector({\r\n            features: markerFeature\r\n        });\r\n        markerVectorLayer = new mapLibraries.ol.layer.Vector({\r\n            source: markerVectorSource,\r\n            className: \"ol-markers\"\r\n        });\r\n        map.once(\"rendercomplete\", function (event) {\r\n            map.addLayer(markerVectorLayer);\r\n        });\r\n        if (hasPopupInfo) {\r\n            if (document.getElementById(\"popup\") == null) {\r\n                var popupe = document.createElement(\"div\");\r\n                popupe.innerHTML =\r\n                    '<a href=\"#\" id=\"popup-closer\" class=\"ol-popup-closer\"></a><div id=\"popup-content\"></div>';\r\n                popupe.id = \"popup\";\r\n                popupe.classList.add(\"ol-popup\");\r\n                map.getTargetElement().appendChild(popupe);\r\n            }\r\n            var container = document.getElementById(\"popup\");\r\n            var content = document.getElementById(\"popup-content\");\r\n            var closer = document.getElementById(\"popup-closer\");\r\n            markerOverlay = new mapLibraries.ol.Overlay({\r\n                element: container,\r\n                autoPan: true,\r\n                position: undefined,\r\n                autoPanAnimation: {\r\n                    duration: 250\r\n                }\r\n            });\r\n            map.addOverlay(markerOverlay);\r\n            closer.onclick = function () {\r\n                markerOverlay.setPosition(undefined);\r\n                closer.blur();\r\n                return false;\r\n            };\r\n            map.on(\"singleclick\", function (evt) {\r\n                var id = map.forEachFeatureAtPixel(evt.pixel, function (feature) {\r\n                    return feature.getId();\r\n                });\r\n                if (typeof id === \"string\") {\r\n                    markerIndex = id.replace(\"marker:\", \"\");\r\n                    if (\r\n                        markerIndex >= 0 &&\r\n                        markers[markerIndex].data[2] != \"\" &&\r\n                        typeof markers[markerIndex].data[2] !== \"undefined\"\r\n                    ) {\r\n                        container.style.display = \"block\";\r\n                        content.innerHTML = markers[markerIndex].data[2];\r\n                        markerOverlay.setPosition(\r\n                            mapLibraries.ol.proj.fromLonLat([\r\n                                markers[markerIndex].data[1],\r\n                                markers[markerIndex].data[0]\r\n                            ])\r\n                        );\r\n                    } else {\r\n                        container.style.display = \"none\";\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    } else {\r\n\r\n        var icon =\r\n            '<!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d=\"M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z\"/></svg>';\r\n        var iconSolid =\r\n            '<!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d=\"M384 192c0 87.4-117 243-168.3 307.2c-12.3 15.3-35.1 15.3-47.4 0C117 435 0 279.4 0 192C0 86 86 0 192 0S384 86 384 192z\"/></svg>';\r\n        for (var i = 0; i < markers.length; i++) {\r\n            var iconStyle =\r\n                '<svg xmlns=\"http://www.w3.org/2000/svg\" id=\"marker-' +\r\n                parseInt([i]).toString() +\r\n                '\" style=\"fill: #a11c25;width:27px; height:36px;stroke:#fff;stroke-width:15px;filter: drop-shadow(1px 2px 1px rgba(0,0,0,0.4));\" viewBox=\"0 0 384 512\">';\r\n            hasPopupInfo = false;\r\n            if (typeof markers[i].data[2] !== \"undefined\") {\r\n                if (markers[i].data[2] !== \"\") {\r\n                    hasPopupInfo = true;\r\n                }\r\n            }\r\n            if (style == \"default\") {\r\n                if (hasPopupInfo) {\r\n                    var falayers = document.createElement(\"span\");\r\n                    falayers.innerHTML = iconStyle + icon;\r\n                    new mapLibraries.maplibregl.Marker({\r\n                        element: falayers,\r\n                        anchor: \"bottom\",\r\n                        offset: [0, 5]\r\n                    })\r\n                        .setLngLat([markers[i].data[1], markers[i].data[0]])\r\n                        .setPopup(\r\n                            new mapLibraries.maplibregl.Popup({\r\n                                offset: [0, -36],\r\n                                className: \"popup-\" + [i]\r\n                            }).setHTML(markers[i].data[2])\r\n                        )\r\n                        .addTo(map);\r\n                } else {\r\n                    var falayers = document.createElement(\"span\");\r\n                    falayers.innerHTML = iconStyle + icon;\r\n                    new mapLibraries.maplibregl.Marker({\r\n                        element: falayers,\r\n                        anchor: \"bottom\",\r\n                        offset: [0, 5]\r\n                    })\r\n                        .setLngLat([markers[i].data[1], markers[i].data[0]])\r\n                        .addTo(map);\r\n                }\r\n            } else {\r\n                var markerTextStyle =\r\n                    'position: absolute;font-weight: bold;top:5px;display: block; width:27px;left:0px;font-size:14px;color:white;text-align:center;text-shadow:-1px -1px 0 rgba(0,0,0,0.25), 1px -1px 0 rgba(0,0,0,0.25), -1px 1px 0 rgba(0,0,0,0.25), 1px 1px 0 rgba(0,0,0,0.25);font-family:\"Open Sans\", \"Arial\", \"Verdana\", \"sans-serif\"';\r\n                if (hasPopupInfo) {\r\n                    var falayers = document.createElement(\"span\");\r\n                    falayers.innerHTML = iconStyle + iconSolid;\r\n                    var falayertext = document.createElement(\"span\");\r\n                    falayertext.innerHTML = (parseInt([i]) + 1).toString();\r\n                    falayertext.setAttribute(\"style\", markerTextStyle);\r\n                    falayers.appendChild(falayertext);\r\n                    new mapLibraries.maplibregl.Marker({\r\n                        element: falayers,\r\n                        anchor: \"bottom\",\r\n                        offset: [0, 5]\r\n                    })\r\n                        .setLngLat([markers[i].data[1], markers[i].data[0]])\r\n                        .setPopup(\r\n                            new mapLibraries.maplibregl.Popup({\r\n                                offset: [0, -36],\r\n                                className: \"popup-\" + [i]\r\n                            }).setHTML(markers[i].data[2])\r\n                        )\r\n                        .addTo(map);\r\n                } else {\r\n                    var falayers = document.createElement(\"span\");\r\n                    falayers.innerHTML = iconStyle + iconSolid;\r\n                    var falayertext = document.createElement(\"span\");\r\n                    falayertext.innerHTML = (parseInt([i]) + 1).toString();\r\n                    falayertext.setAttribute(\"style\", markerTextStyle);\r\n                    falayers.appendChild(falayertext);\r\n                    new mapLibraries.maplibregl.Marker({\r\n                        element: falayers,\r\n                        anchor: \"bottom\",\r\n                        offset: [0, 5]\r\n                    })\r\n                        .setLngLat([markers[i].data[1], markers[i].data[0]])\r\n                        .addTo(map);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport function highlightMarker(markerIndex) {\r\n    if (typeof markerVectorLayer !== \"undefined\") {\r\n        var featureToHighlight = markerVectorLayer\r\n            .getSource()\r\n            .getFeatureById(\"marker:\" + markerIndex);\r\n        if (featureToHighlight !== null) {\r\n            var featureImage = featureToHighlight.getStyle().getImage();\r\n            if (\r\n                typeof featureImage.iconImage_ !== \"undefined\" &&\r\n                typeof featureImage.iconImage_.color_ !== \"undefined\"\r\n            ) {\r\n                featureImage.iconImage_.color_ = [0, 130, 200, 1];\r\n            }\r\n            featureToHighlight.getStyle().setZIndex(1);\r\n        }\r\n    } else {\r\n        var hmarker = document.getElementById(\"marker-\" + markerIndex);\r\n        if (hmarker) {\r\n            hmarker.style.fill = \"#0082c8\";\r\n            hmarker.parentElement.style.zIndex = 1;\r\n        }\r\n    }\r\n}\r\n\r\nexport function dehighlightMarker(markerIndex) {\r\n    if (typeof markerVectorLayer !== \"undefined\") {\r\n        var featureToHighlight = markerVectorLayer\r\n            .getSource()\r\n            .getFeatureById(\"marker:\" + markerIndex);\r\n        if (featureToHighlight !== null) {\r\n            var featureImage = featureToHighlight.getStyle().getImage();\r\n            if (\r\n                typeof featureImage.iconImage_ !== \"undefined\" &&\r\n                typeof featureImage.iconImage_.color_ !== \"undefined\"\r\n            ) {\r\n                featureImage.iconImage_.color_ = [161, 28, 37, 1];\r\n            }\r\n            featureToHighlight.getStyle().setZIndex(0);\r\n        }\r\n    } else {\r\n        var hmarker = document.getElementById(\"marker-\" + markerIndex);\r\n        if (hmarker) {\r\n            hmarker.style.fill = \"#a11c25\";\r\n            hmarker.parentElement.style.zIndex = 0;\r\n        }\r\n    }\r\n}\r\n\r\nexport function removeMarker(markers, markerIndex) {\r\n    var markerIndex = markerIndex === undefined ? -1 : markerIndex;\r\n    if (markerIndex < 0) {\r\n        markerIndex = 0;\r\n    }\r\n    if (typeof mapLibraries.ol !== \"undefined\") {\r\n        if (typeof markerVectorLayer !== \"undefined\") {\r\n            var featureToClose = markerVectorLayer\r\n                .getSource()\r\n                .getFeatureById(\"marker:\" + markerIndex);\r\n            if (featureToClose !== null) {\r\n                markerVectorSource.removeFeature(featureToClose);\r\n            }\r\n        }\r\n        if (typeof markers[markerIndex] !== \"undefined\") {\r\n            if (typeof markers[markerIndex].data[2] !== \"undefined\") {\r\n                if (markers[markerIndex].data[2] !== \"\") {\r\n                    var container = document.getElementById(\"popup\");\r\n                    container.style.display = \"none\";\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        var hmarker = document.getElementById(\"marker-\" + markerIndex);\r\n        if (hmarker) {\r\n            var hpopup = document.querySelector(\r\n                \".maplibre-popup.popup-\" +\r\n                markerIndex\r\n            );\r\n            if (hpopup) {\r\n                hpopup.remove();\r\n            }\r\n            hmarker.parentElement.remove();\r\n        }\r\n    }\r\n}\r\n\r\nexport function createMarker(lonLat, name, id, style) {\r\n    var markerFeature = new mapLibraries.ol.Feature({\r\n        geometry: new mapLibraries.ol.geom.Point(mapLibraries.ol.proj.fromLonLat(lonLat)),\r\n        name: name\r\n    });\r\n    var icon = window.btoa(\r\n        '<svg xmlns=\"http://www.w3.org/2000/svg\" style=\"fill: #fff;display:box;stroke:#fff;stroke-width:15px;filter: drop-shadow(1px 2px 1px rgba(0,0,0,0.4));\" width=\"27px\" height=\"36px\" viewBox=\"0 0 384 512\"><!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d=\"M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z\"/></svg>'\r\n    );\r\n    var iconSolid = window.btoa(\r\n        '<svg xmlns=\"http://www.w3.org/2000/svg\" style=\"fill: #fff; display:box;stroke:#fff;stroke-width:15px;filter: drop-shadow(1px 2px 1px rgba(0,0,0,0.4));\" width=\"27px\" height=\"36px\" viewBox=\"0 0 384 512\"><!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d=\"M384 192c0 87.4-117 243-168.3 307.2c-12.3 15.3-35.1 15.3-47.4 0C117 435 0 279.4 0 192C0 86 86 0 192 0S384 86 384 192z\"/></svg>'\r\n    );\r\n    markerFeature.setId(\"marker:\" + id);\r\n    if (style == \"default\") {\r\n        var markerStyle = new mapLibraries.ol.style.Style({\r\n            image: new mapLibraries.ol.style.Icon({\r\n                opacity: 1,\r\n                color: \"#a11c25\",\r\n                anchor: [0.5, 36],\r\n                anchorXUnits: \"fraction\",\r\n                anchorYUnits: \"pixels\",\r\n                src: \"data:image/svg+xml;base64,\" + icon,\r\n                imgSize: ((window.document.documentMode) ? [27, 36] : null)\r\n            })\r\n        });\r\n        markerFeature.setStyle(markerStyle);\r\n        return markerFeature;\r\n    } else {\r\n        var markerStyle = new mapLibraries.ol.style.Style({\r\n            image: new mapLibraries.ol.style.Icon({\r\n                opacity: 1,\r\n                color: \"#a11c25\",\r\n                anchor: [0.5, 36],\r\n                anchorXUnits: \"fraction\",\r\n                anchorYUnits: \"pixels\",\r\n                src: \"data:image/svg+xml;base64,\" + iconSolid,\r\n                imgSize: ((window.document.documentMode) ? [27, 36] : null)\r\n            })\r\n        });\r\n        var markerTextStyle = new mapLibraries.ol.style.Style({\r\n            text: new mapLibraries.ol.style.Text({\r\n                text: (id + 1).toString(),\r\n                fill: new mapLibraries.ol.style.Fill({\r\n                    color: \"#fff\"\r\n                }),\r\n                stroke: new mapLibraries.ol.style.Stroke({\r\n                    color: \"rgba(0,0,0,0.1)\",\r\n                    width: 1.5\r\n                }),\r\n                offsetY: -10,\r\n                textBaseline: \"bottom\",\r\n                textAlign: \"center\",\r\n                font: 'Normal 700 12px \"Open Sans\", \"Arial\", \"Verdana\", \"sans-serif\"'\r\n            })\r\n        });\r\n        var markerTextFeature = new mapLibraries.ol.Feature({\r\n            geometry: new mapLibraries.ol.geom.Point(mapLibraries.ol.proj.fromLonLat(lonLat)),\r\n            name: name\r\n        });\r\n        markerTextFeature.setStyle(markerTextStyle);\r\n        markerFeature.setStyle(markerStyle);\r\n        return [markerFeature, markerTextFeature];\r\n    }\r\n}\r\n\r\nexport function setMarkerOpen(markers, markerIndex) {\r\n    var markerIndex = markerIndex === undefined ? -1 : markerIndex;\r\n    if (typeof mapLibraries.ol !== \"undefined\") {\r\n        var container = document.getElementById(\"popup\");\r\n        var content = document.getElementById(\"popup-content\");\r\n        //var closer = document.getElementById('popup-closer');\r\n        if (markerIndex < 0) {\r\n            markerIndex = 0;\r\n        }\r\n        container.style.display = \"block\";\r\n        content.innerHTML = markers[markerIndex].data[2];\r\n        //openlayers throws error on autopan = true.  temporarily catching error for now.\r\n        try {\r\n            markerOverlay.setPosition(\r\n                mapLibraries.ol.proj.fromLonLat([\r\n                    markers[markerIndex].data[1],\r\n                    markers[markerIndex].data[0]\r\n                ])\r\n            );\r\n        } catch (e) { }\r\n    } else {\r\n        var hmarker = document.getElementById(\"marker-\" + markerIndex);\r\n        if (hmarker) {\r\n            hmarker.parentElement.click();\r\n        }\r\n    }\r\n}\r\n\r\nexport function quickMarkersCenter(markers) {\r\n    var lat = 0,\r\n        lng = 0,\r\n        latAr = [],\r\n        lonAr = [];\r\n    var num_coords = markers.length;\r\n    for (var i = 0; i < num_coords; ++i) {\r\n        lat += Number(markers[i].data[0]);\r\n        lng += Number(markers[i].data[1]);\r\n        latAr.push(markers[i].data[0]);\r\n        lonAr.push(markers[i].data[1]);\r\n    }\r\n    var distance = distanceInKM(\r\n        Math.max.apply(Math, latAr),\r\n        Math.max.apply(Math, lonAr),\r\n        Math.min.apply(Math, latAr),\r\n        Math.min.apply(Math, lonAr)\r\n    );\r\n    var zoom = 13;\r\n    switch (true) {\r\n        case distance < 1:\r\n            zoom = 14;\r\n            break;\r\n        case distance < 4:\r\n            zoom = 13;\r\n            break;\r\n        case distance < 10:\r\n            zoom = 12;\r\n            break;\r\n        case distance < 20:\r\n            zoom = 11;\r\n            break;\r\n        case distance < 40:\r\n            zoom = 10;\r\n            break;\r\n        case distance < 100:\r\n            zoom = 9;\r\n            break;\r\n        case distance < 250:\r\n            zoom = 8;\r\n            break;\r\n        case distance < 400:\r\n            zoom = 7;\r\n            break;\r\n        case distance < 750:\r\n            zoom = 6;\r\n            break;\r\n        case distance < 2000:\r\n            zoom = 5;\r\n            break;\r\n        case distance < 4000:\r\n            zoom = 4;\r\n            break;\r\n        case distance >= 4000:\r\n            zoom = 3;\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n    lat /= num_coords;\r\n    lng /= num_coords;\r\n    return [lat, lng, zoom];\r\n}","//Copyright 2023, Slpy, all rights reserved.\r\n//Check out https://github.com/Spy-API/Slpy-JS and https://www.slpy.com/legal for licensing and terms\r\n\r\nimport { loadScript, distanceInKM } from \"./utils.js\";\r\nimport { mapState,  mapLibraries } from \"./globals.js\";\r\n\r\nexport function waitForMapillary(mpyKey, map) {\r\n    if (typeof mapillary === \"undefined\") {\r\n        setTimeout(function () {\r\n            waitForMapillary(mpyKey, map);\r\n        }, 100);\r\n    } else {\r\n        addMapillary(mpyKey, map);\r\n    }\r\n}\r\n\r\nexport function onMapillaryChange(change) {\r\n    var evt = document.createEvent(\"Event\");\r\n    evt.state = change;\r\n    evt.initEvent(\"StreetLevel\", true, false);\r\n    window.dispatchEvent(evt);\r\n}\r\n\r\nexport function addMapillary(MapillaryKey, map) {\r\n    var ua = window.navigator.userAgent;\r\n    var msie = ua.indexOf(\"MSIE \");\r\n    if (msie > 0) {\r\n        // IE 10 or mapLibraries.older not compatible with Mapillary\r\n        onMapillaryChange(\"failed load\");\r\n        return;\r\n    }\r\n    var trident = ua.indexOf(\"Trident/\");\r\n    if (trident > 0) {\r\n        if (typeof mapLibraries.ol === \"undefined\") {\r\n            //IE 11 only works well with OpenLayers\r\n            onMapillaryChange(\"failed load\");\r\n            return;\r\n        }\r\n    }\r\n    if (typeof mapillary === \"undefined\") {\r\n        //console.error(\"Slpy Developer: Street Level requires Mapillary 4.0+.  Please upgrade your library and obtain a new token, as Mapillary has disabled previous methods and keys.\");\r\n        //attempt to load mapillary\r\n        var mplycss = document.createElement(\"link\");\r\n        mplycss.href = \"https://unpkg.com/mapillary-js@4.1.1/dist/mapillary.css\";\r\n        mplycss.rel = \"stylesheet\";\r\n        document.head.appendChild(mplycss);\r\n        loadScript(\"https://unpkg.com/mapillary-js@4.1.1/dist/mapillary.js\");\r\n        waitForMapillary(MapillaryKey, map);\r\n    }\r\n    var mlyContainer = document.getElementById(\"mly\");\r\n    var maptarContainer = undefined;\r\n    if (typeof mapLibraries.ol !== \"undefined\") {\r\n        maptarContainer = map.getTargetElement();\r\n    } else {\r\n        maptarContainer = map.getContainer();\r\n    }\r\n    if (!mlyContainer) {\r\n        // user didnt add mapillary divs, so we will try for them\r\n        var newDiv = document.createElement('div');\r\n        newDiv.id = 'map-mapillary';\r\n        \r\n        // Insert the new outer div before the old element\r\n        maptarContainer.parentNode.insertBefore(newDiv, maptarContainer);\r\n        \r\n        // Move the old element into the new outer div\r\n        newDiv.appendChild(maptarContainer);\r\n        \r\n        // Create the new inner div\r\n        var mlyDiv = document.createElement('div');\r\n        mlyDiv.id = 'mly';\r\n        \r\n        // Insert the new inner div into the new outer div\r\n        newDiv.appendChild(mlyDiv);\r\n    }\r\n    \r\n    if (typeof mapillary !== \"undefined\") {\r\n        if (typeof mapLibraries.ol !== \"undefined\") {\r\n            onMapillaryChange(\"loaded\");\r\n            var streetLevelIcon = new mapLibraries.ol.style.Style({\r\n                text: new mapLibraries.ol.style.Text({\r\n                    text: \"\\uF124\",\r\n                    scale: 1,\r\n                    font: 'Normal 900 18px \"Font Awesome 5 Free\"',\r\n                    fill: new mapLibraries.ol.style.Fill({\r\n                        color: \"#a11d26\"\r\n                    }),\r\n                    stroke: new mapLibraries.ol.style.Stroke({\r\n                        color: \"white\",\r\n                        width: 3\r\n                    })\r\n                })\r\n            });\r\n            var updateBearingStyle = function updateBearingStyle(bearing) {\r\n                return [new mapLibraries.ol.style.Style({\r\n                    text: new mapLibraries.ol.style.Text({\r\n                        text: \"\\uF124\",\r\n                        scale: 1,\r\n                        font: 'Normal 900 18px \"Font Awesome 5 Free\"',\r\n                        textBaseline: \"middle\",\r\n                        textAlign: \"center\",\r\n                        rotation: (bearing * Math.PI) / 180 - 45,\r\n                        fill: new mapLibraries.ol.style.Fill({\r\n                            color: \"#a11d26\"\r\n                        }),\r\n                        stroke: new mapLibraries.ol.style.Stroke({\r\n                            color: \"white\",\r\n                            width: 3\r\n                        })\r\n                    })\r\n                })];\r\n            };\r\n            var photoDot = new mapLibraries.ol.style.Style({\r\n                image: new mapLibraries.ol.style.Circle({\r\n                    fill: new mapLibraries.ol.style.Fill({\r\n                        color: \"rgba(53, 175, 109,0.2)\"\r\n                    }),\r\n                    radius: 4\r\n                })\r\n            });\r\n            var photoDotAerial = new mapLibraries.ol.style.Style({\r\n                image: new mapLibraries.ol.style.Circle({\r\n                    fill: new mapLibraries.ol.style.Fill({\r\n                        color: \"rgba(53, 175, 109,0.5)\"\r\n                    }),\r\n                    radius: 4\r\n                })\r\n            });\r\n            var mapillarySource = new mapLibraries.ol.layer.VectorTile({\r\n                source: new mapLibraries.ol.source.VectorTile({\r\n                    format: new mapLibraries.ol.format.MVT(),\r\n                    tileGrid: mapLibraries.ol.tilegrid.createXYZ({\r\n                        maxZoom: 14\r\n                    }),\r\n                    tilePixelRatio: 16,\r\n                    maxZoom: 14,\r\n                    url:\r\n                        \"https://tiles.mapillary.com/maps/vtp/mly1_public/2/{z}/{x}/{y}?access_token=\" +\r\n                        MapillaryKey\r\n                }),\r\n                style: photoDot,\r\n                minZoom: 14\r\n            });\r\n\r\n            class streetLevelButton extends mapLibraries.ol.control.Control {\r\n                constructor(opt_options) {\r\n                    var options = opt_options || {};\r\n                    var SLbutton = document.createElement(\"button\");\r\n                    SLbutton.style.cssText = 'font: 900 1.14em \"Font Awesome 5 Free\"';\r\n                    SLbutton.innerHTML = \"\\uF554\";\r\n                    var element = document.createElement(\"div\");\r\n                    element.className = \"ol-control\";\r\n                    element.style.cssText =\r\n                        \"bottom: 55px; right: 8px; margin-bottom: 50px\";\r\n                    element.appendChild(SLbutton);\r\n                    super({\r\n                        element: element,\r\n                        target: options.target\r\n                    });\r\n                    SLbutton.addEventListener(\r\n                        \"click\",\r\n                        this.handleStreetLevel.bind(this),\r\n                        false\r\n                    );\r\n                }\r\n                handleStreetLevel() {\r\n                    if (map.getView().getZoom() < 12 && !mapState.streetLevelOn) {\r\n                        alert(\"Zoom in to get Street Level Imagery\");\r\n                    } else {\r\n                        var mpjscanvas = document.getElementsByClassName(\r\n                            \"mapillary-js-canvas\"\r\n                        )[0];\r\n                        var mpjsdom =\r\n                            document.getElementsByClassName(\"mapillary-js-dom\")[0];\r\n                        if (mapState.streetLevelOn) {\r\n                            mapillarySource.setStyle(photoDot);\r\n                            this.getMap().removeLayer(mapillarySource);\r\n                            this.getMap().removeLayer(movingPointLayer);\r\n                            mlyContainer.style.display = \"none\";\r\n                            maptarContainer.style.height = \"100%\";\r\n                            maptarContainer.style.width = \"100%\";\r\n                            map.updateSize();\r\n                            movingPointLayer.setVisible(false);\r\n                            if (typeof mpjscanvas !== \"undefined\") {\r\n                                mpjscanvas.style.display = \"none\";\r\n                            }\r\n                            if (typeof mpjsdom !== \"undefined\") {\r\n                                mpjsdom.style.display = \"none\";\r\n                            }\r\n                            onMapillaryChange(\"closed\");\r\n                            mapState.streetLevelOn = false;\r\n                        } else {\r\n                            var centerCurrent = mapLibraries.ol.proj.toLonLat(map.getView().getCenter());\r\n                            var bboxCurrent = mapLibraries.ol.proj.transformExtent(\r\n                                map.getView().calculateExtent(map.getSize()),\r\n                                \"EPSG:900913\",\r\n                                \"EPSG:4326\"\r\n                            );\r\n                            var bboxRad =\r\n                                distanceInKM(\r\n                                    bboxCurrent[0],\r\n                                    bboxCurrent[1],\r\n                                    bboxCurrent[2],\r\n                                    bboxCurrent[3]\r\n                                ) * 1000;\r\n                            var maptarParent = maptarContainer.parentNode;\r\n                            var xmlhttp = new XMLHttpRequest();\r\n                            xmlhttp.onreadystatechange = function () {\r\n                                if (this.readyState == 4 && this.status == 200) {\r\n                                    var myArr = JSON.parse(this.responseText);\r\n                                    if (typeof myArr.data[0] !== \"undefined\") {\r\n                                        onMapillaryChange(\"active\");\r\n                                        map.addLayer(mapillarySource);\r\n                                        map.addLayer(movingPointLayer);\r\n                                        if (typeof mapState.aerialImageryOn !== \"undefined\") {\r\n                                            if (mapState.aerialImageryOn) {\r\n                                                mapillarySource.setStyle(photoDotAerial);\r\n                                            }\r\n                                        }\r\n                                        mapState.streetLevelOn = true;\r\n                                        mly.moveTo(myArr.data[0].id)[\"catch\"](function (reason) {\r\n                                            console.log(\"Mapillary missing image\");\r\n                                        });\r\n                                        featureOverlay.setStyle(\r\n                                            updateBearingStyle(myArr.data[0].compass_angle)\r\n                                        );\r\n                                        if (!movingPointLayer.getVisible()) {\r\n                                            movingPointLayer.setVisible(true);\r\n                                        }\r\n                                        if (map.getView().getZoom() < 18.5) {\r\n                                            map.getView().animate({\r\n                                                zoom: 18.5,\r\n                                                duration: 250\r\n                                            });\r\n                                        }\r\n                                        mpjscanvas = document.getElementsByClassName(\r\n                                            \"mapillary-js-canvas\"\r\n                                        )[0];\r\n                                        mpjsdom =\r\n                                            document.getElementsByClassName(\"mapillary-js-dom\")[0];\r\n                                        if (typeof mpjscanvas !== \"undefined\") {\r\n                                            mpjscanvas.style.display = \"initial\";\r\n                                        }\r\n                                        if (typeof mpjsdom !== \"undefined\") {\r\n                                            mpjsdom.style.display = \"initial\";\r\n                                        }\r\n                                    } else {\r\n                                        onMapillaryChange(\"closed\");\r\n                                        mlyContainer.style.display = \"none\";\r\n                                        maptarContainer.style.width = \"100%\";\r\n                                        maptarContainer.style.height = \"100%\";\r\n                                        map.updateSize();\r\n                                        if (typeof mpjscanvas !== \"undefined\") {\r\n                                            mpjscanvas.style.display = \"none\";\r\n                                        }\r\n                                        if (typeof mpjsdom !== \"undefined\") {\r\n                                            mpjsdom.style.display = \"none\";\r\n                                        }\r\n                                        if (map.getView().getZoom() <= 15) {\r\n                                            alert(\r\n                                                \"No street level images available here.  Try zooming in.\"\r\n                                            );\r\n                                        } else {\r\n                                            alert(\"No street level images available here.\");\r\n                                        }\r\n                                    }\r\n                                } else if (this.readyState == 4) {\r\n                                    onMapillaryChange(\"closed\");\r\n                                    mlyContainer.style.display = \"none\";\r\n                                    maptarContainer.style.width = \"100%\";\r\n                                    maptarContainer.style.height = \"100%\";\r\n                                    map.updateSize();\r\n                                    if (typeof mpjscanvas !== \"undefined\") {\r\n                                        mpjscanvas.style.display = \"none\";\r\n                                    }\r\n                                    if (typeof mpjsdom !== \"undefined\") {\r\n                                        mpjsdom.style.display = \"none\";\r\n                                    }\r\n                                    console.log(\"Could not connect to Mapillary\");\r\n                                }\r\n                            };\r\n                            onMapillaryChange(\"opened\");\r\n                            mlyContainer.style.display = \"block\";\r\n                            if (maptarParent.offsetHeight > maptarParent.offsetWidth) {\r\n                                maptarContainer.style.height = \"35%\";\r\n                                maptarContainer.style.width = \"100%\";\r\n                                mlyContainer.style.width = \"100%\";\r\n                                mlyContainer.style.height = \"65%\";\r\n                            } else {\r\n                                maptarContainer.style.width = \"35%\";\r\n                                maptarContainer.style.height = \"100%\";\r\n                                mlyContainer.style.height = \"100%\";\r\n                                mlyContainer.style.width = \"65%\";\r\n                            }\r\n                            mly.resize();\r\n                            map.updateSize();\r\n                            xmlhttp.open(\r\n                                \"GET\",\r\n                                \"https://graph.mapillary.com/images?access_token=\" +\r\n                                MapillaryKey +\r\n                                \"&fields=image_key,compass_angle&limit=1&closeto=\" +\r\n                                centerCurrent.toString() +\r\n                                \"&bbox=\" +\r\n                                bboxCurrent.toString(),\r\n                                true\r\n                            );\r\n                            //xmlhttp.open(\"GET\", 'https://a.mapillary.com/v3/images?client_id='+MapillaryKey+'&closeto='+centerCurrent.toString()+'&bbox='+bboxCurrent.toString()+\"&radius=\"+bboxRad.toFixed(0), true);\r\n                            xmlhttp.send();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            map.addControl(new streetLevelButton());\r\n            var pointFeature = new mapLibraries.ol.Feature({\r\n                geometry: new mapLibraries.ol.geom.Point(ol.proj.fromLonLat(center))\r\n            });\r\n            pointFeature.setStyle([streetLevelIcon]);\r\n            var movingPointLayer = new mapLibraries.ol.layer.Vector({\r\n                source: new mapLibraries.ol.source.Vector({\r\n                    features: [pointFeature]\r\n                }),\r\n                visible: false\r\n            });\r\n            var featureOverlay = new mapLibraries.ol.layer.Vector({\r\n                source: new mapLibraries.ol.source.Vector(),\r\n                map: map,\r\n                style: [streetLevelIcon]\r\n            });\r\n            var mly = new mapillary.Viewer({\r\n                accessToken: MapillaryKey,\r\n                component: {\r\n                    cover: false\r\n                },\r\n                container: \"mly\"\r\n            });\r\n            var highlight;\r\n            var displayFeatureInfo = function displayFeatureInfo(pixel, isClick) {\r\n                var feature = map.forEachFeatureAtPixel(\r\n                    pixel,\r\n                    function (feature, layer) {\r\n                        return feature;\r\n                    },\r\n                    {\r\n                        layerFilter: function layerFilter(layer) {\r\n                            return layer === mapillarySource;\r\n                        },\r\n                        hitTolerance: 5\r\n                    }\r\n                );\r\n                if (feature) {\r\n                    if (isClick) {\r\n                        var bearing = feature.get(\"compassAngle\");\r\n                        mly.moveTo(feature.get(\"id\"))[\"catch\"](function (reason) {\r\n                            console.log(\"Mapillary missing image\");\r\n                        });\r\n                        featureOverlay.setStyle(updateBearingStyle(bearing));\r\n                        if (!movingPointLayer.getVisible()) {\r\n                            mlyContainer.style.display = \"block\";\r\n                            var maptarParent = maptarContainer.parentNode;\r\n                            if (maptarParent.offsetHeight > maptarParent.offsetWidth) {\r\n                                maptarContainer.style.height = \"35%\";\r\n                                maptarContainer.style.width = \"100%\";\r\n                                mlyContainer.style.width = \"100%\";\r\n                                mlyContainer.style.height = \"65%\";\r\n                            } else {\r\n                                maptarContainer.style.width = \"35%\";\r\n                                maptarContainer.style.height = \"100%\";\r\n                                mlyContainer.style.height = \"100%\";\r\n                                mlyContainer.style.width = \"65%\";\r\n                            }\r\n                            mly.resize();\r\n                            map.updateSize();\r\n                            movingPointLayer.setVisible(true);\r\n                        }\r\n                    }\r\n                    if (feature !== highlight) {\r\n                        if (highlight) {\r\n                            if (typeof highlight !== \"undefined\") {\r\n                                try {\r\n                                    featureOverlay.getSource().removeFeature(highlight);\r\n                                } catch (err) {\r\n                                    //sometimes causes error due to latency or missing keys\r\n                                }\r\n                            }\r\n                        }\r\n                        if (feature) {\r\n                            if (typeof feature !== \"undefined\") {\r\n                                try {\r\n                                    featureOverlay.getSource().addFeature(feature);\r\n                                } catch (err) {\r\n                                    //sometimes causes error due to latency or missing keys\r\n                                }\r\n                            }\r\n                        }\r\n                        highlight = feature;\r\n                    }\r\n                } else {\r\n                    return;\r\n                }\r\n            };\r\n            mly.on(\"image\", function (event) {\r\n                if (featureOverlay.getVisible()) {\r\n                    featureOverlay.setVisible(false);\r\n                }\r\n                var lonLat = mapLibraries.ol.proj.fromLonLat([\r\n                    event.image.originalLngLat.lng,\r\n                    event.image.originalLngLat.lat\r\n                ]);\r\n                map.getView().setCenter(lonLat);\r\n                pointFeature.getGeometry().setCoordinates(lonLat);\r\n                pointFeature.setStyle(updateBearingStyle(event.image.compassAngle));\r\n            });\r\n            map.on(\"click\", function (e) {\r\n                displayFeatureInfo(e.pixel, true);\r\n            });\r\n            window.addEventListener(\"resize\", function () {\r\n                if (mapState.streetLevelOn) {\r\n                    var maptarParent = maptarContainer.parentNode;\r\n                    if (maptarParent.offsetHeight > maptarParent.offsetWidth) {\r\n                        maptarContainer.style.height = \"35%\";\r\n                        maptarContainer.style.width = \"100%\";\r\n                        mlyContainer.style.width = \"100%\";\r\n                        mlyContainer.style.height = \"65%\";\r\n                    } else {\r\n                        maptarContainer.style.width = \"35%\";\r\n                        maptarContainer.style.height = \"100%\";\r\n                        mlyContainer.style.height = \"100%\";\r\n                        mlyContainer.style.width = \"65%\";\r\n                    }\r\n                    mly.resize();\r\n                    map.updateSize();\r\n                }\r\n            });\r\n        } else {\r\n            var StreetLevelControl = function StreetLevelControl() { };\r\n            var streetLevel = function streetLevel() {\r\n                if (map.getZoom() < 12 && !mapState.streetLevelOn) {\r\n                    alert(\"Zoom in to get Street Level Imagery\");\r\n                } else {\r\n                    var mpjscanvas = document.getElementsByClassName(\r\n                        \"mapillary-js-canvas\"\r\n                    )[0];\r\n                    var mpjsdom = document.getElementsByClassName(\"mapillary-js-dom\")[0];\r\n                    if (mapState.streetLevelOn) {\r\n                        map.removeLayer(\"mimgLayer\");\r\n                        map.removeLayer(\"streetLevelIcon\");\r\n                        mlyContainer.style.display = \"none\";\r\n                        maptarContainer.style.height = \"100%\";\r\n                        maptarContainer.style.width = \"100%\";\r\n                        map.resize();\r\n                        if (typeof mpjscanvas !== \"undefined\") {\r\n                            mpjscanvas.style.display = \"none\";\r\n                        }\r\n                        if (typeof mpjsdom !== \"undefined\") {\r\n                            mpjsdom.style.display = \"none\";\r\n                        }\r\n                        onMapillaryChange(\"closed\");\r\n                        mapState.streetLevelOn = false;\r\n                    } else {\r\n                        var centerCurrent = map.getCenter().toArray();\r\n                        var bboxCurrent = map.getBounds().toArray();\r\n                        var bboxRad =\r\n                            distanceInKM(\r\n                                bboxCurrent[0][0],\r\n                                bboxCurrent[0][1],\r\n                                bboxCurrent[1][0],\r\n                                bboxCurrent[1][1]\r\n                            ) * 1000;\r\n                        var xmlhttp = new XMLHttpRequest();\r\n                        if (streetLevelLoad) {\r\n                            map.addSource(\"mimgLayer\", mapillarySource);\r\n                            map.addSource(\"streetLevelIcon\", streetLevelIconSource);\r\n                            streetLevelLoad = false;\r\n                        }\r\n                        xmlhttp.onreadystatechange = function () {\r\n                            if (this.readyState == 4 && this.status == 200) {\r\n                                var myArr = JSON.parse(this.responseText);\r\n                                //alert(myArr.data[0].id);\r\n                                if (typeof myArr.data[0] !== \"undefined\") {\r\n                                    var cirOpac = \"0.2\";\r\n                                    if (typeof mapState.aerialImageryOn !== \"undefined\") {\r\n                                        if (mapState.aerialImageryOn) {\r\n                                            cirOpac = \"0.5\";\r\n                                        }\r\n                                    }\r\n                                    map.addLayer({\r\n                                        id: \"mimgLayer\",\r\n                                        type: \"circle\",\r\n                                        source: \"mimgLayer\",\r\n                                        \"source-layer\": \"image\",\r\n                                        minzoom: 14,\r\n                                        maxzoom: 22,\r\n                                        paint: {\r\n                                            \"circle-color\": \"rgba(53, 175, 109,\" + cirOpac + \")\"\r\n                                        }\r\n                                    });\r\n                                    map.addLayer({\r\n                                        id: \"streetLevelIcon\",\r\n                                        type: \"symbol\",\r\n                                        source: \"streetLevelIcon\",\r\n                                        paint: {\r\n                                            \"text-color\": \"#a11d26\",\r\n                                            \"text-halo-color\": \"#fff\",\r\n                                            \"text-halo-width\": 2.25,\r\n                                            \"text-translate\": [0, 0]\r\n                                        },\r\n                                        layout: {\r\n                                            \"text-field\": \"\\uF124\",\r\n                                            \"text-size\": 20,\r\n                                            \"text-font\": [\"fasolid-900\"],\r\n                                            \"text-rotate\": [\"get\", \"bearing\"],\r\n                                            \"text-anchor\": \"center\",\r\n                                            \"text-offset\": [0, 0]\r\n                                        }\r\n                                    });\r\n                                    mapState.streetLevelOn = true;\r\n                                    onMapillaryChange(\"active\");\r\n                                    mly.moveTo(myArr.data[0].id)[\"catch\"](function (reason) {\r\n                                        console.log(\"Mapillary missing image\");\r\n                                    });\r\n                                    if (map.getZoom() < 17.5) {\r\n                                        map.zoomTo(17.5);\r\n                                    }\r\n                                    mpjscanvas = document.getElementsByClassName(\r\n                                        \"mapillary-js-canvas\"\r\n                                    )[0];\r\n                                    mpjsdom =\r\n                                        document.getElementsByClassName(\"mapillary-js-dom\")[0];\r\n                                    if (typeof mpjscanvas !== \"undefined\") {\r\n                                        mpjscanvas.style.display = \"initial\";\r\n                                    }\r\n                                    if (typeof mpjsdom !== \"undefined\") {\r\n                                        mpjsdom.style.display = \"initial\";\r\n                                    }\r\n                                } else {\r\n                                    mlyContainer.style.display = \"none\";\r\n                                    maptarContainer.style.height = \"100%\";\r\n                                    maptarContainer.style.width = \"100%\";\r\n                                    map.resize();\r\n                                    if (typeof mpjscanvas !== \"undefined\") {\r\n                                        mpjscanvas.style.display = \"none\";\r\n                                    }\r\n                                    if (typeof mpjsdom !== \"undefined\") {\r\n                                        mpjsdom.style.display = \"none\";\r\n                                    }\r\n                                    onMapillaryChange(\"closed\");\r\n                                    if (map.getZoom() <= 15) {\r\n                                        alert(\r\n                                            \"No street level images available here.  Try zooming in.\"\r\n                                        );\r\n                                    } else {\r\n                                        alert(\"No street level images available here.\");\r\n                                    }\r\n                                }\r\n                            } else if (this.readyState == 4) {\r\n                                mlyContainer.style.display = \"none\";\r\n                                maptarContainer.style.height = \"100%\";\r\n                                maptarContainer.style.width = \"100%\";\r\n                                map.resize();\r\n                                if (typeof mpjscanvas !== \"undefined\") {\r\n                                    mpjscanvas.style.display = \"none\";\r\n                                }\r\n                                if (typeof mpjsdom !== \"undefined\") {\r\n                                    mpjsdom.style.display = \"none\";\r\n                                }\r\n                                onMapillaryChange(\"closed\");\r\n                            }\r\n                        };\r\n                        mlyContainer.style.display = \"block\";\r\n                        var maptarParent = maptarContainer.parentNode;\r\n                        if (maptarParent.offsetHeight > maptarParent.offsetWidth) {\r\n                            maptarContainer.style.height = \"35%\";\r\n                            maptarContainer.style.width = \"100%\";\r\n                            mlyContainer.style.width = \"100%\";\r\n                            mlyContainer.style.height = \"65%\";\r\n                        } else {\r\n                            maptarContainer.style.width = \"35%\";\r\n                            maptarContainer.style.height = \"100%\";\r\n                            mlyContainer.style.height = \"100%\";\r\n                            mlyContainer.style.width = \"65%\";\r\n                        }\r\n                        mly.resize();\r\n                        map.resize();\r\n                        onMapillaryChange(\"opened\");\r\n                        xmlhttp.open(\r\n                            \"GET\",\r\n                            \"https://graph.mapillary.com/images?access_token=\" +\r\n                            MapillaryKey +\r\n                            \"&fields=image_key&limit=1&closeto=\" +\r\n                            centerCurrent[0] +\r\n                            \",\" +\r\n                            centerCurrent[1] +\r\n                            \"&bbox=\" +\r\n                            bboxCurrent[0][0] +\r\n                            \",\" +\r\n                            bboxCurrent[0][1] +\r\n                            \",\" +\r\n                            bboxCurrent[1][0] +\r\n                            \",\" +\r\n                            bboxCurrent[1][1],\r\n                            true\r\n                        );\r\n                        //'https://a.mapillary.com/v3/images?client_id='+MapillaryKey+'&closeto='+centerCurrent[0]+','+centerCurrent[1]+'&bbox='+bboxCurrent[0][0]+','+bboxCurrent[0][1]+','+bboxCurrent[1][0]+','+bboxCurrent[1][1]+'&radius='+bboxRad.toFixed(0), true);\r\n                        xmlhttp.send();\r\n                    }\r\n                }\r\n            };\r\n            onMapillaryChange(\"loaded\");\r\n            var streetLevelIconSource = {\r\n                type: \"geojson\",\r\n                data: {\r\n                    type: \"Feature\",\r\n                    geometry: {\r\n                        type: \"Point\",\r\n                        coordinates: [0, 0]\r\n                    },\r\n                    properties: {\r\n                        bearing: 90\r\n                    }\r\n                }\r\n            };\r\n            var mapillarySource = {\r\n                type: \"vector\",\r\n                tiles: [\r\n                    \"https://tiles.mapillary.com/maps/vtp/mly1_public/2/{z}/{x}/{y}?access_token=\" +\r\n                    MapillaryKey\r\n                ],\r\n                minzoom: 14,\r\n                maxzoom: 14\r\n            };\r\n            StreetLevelControl.prototype.onAdd = function (map) {\r\n                this._map = map;\r\n                this._container = document.createElement(\"div\");\r\n                this._container.className = \"maplibregl-ctrl maplibregl-ctrl-group\";\r\n                this._container.style.cssText = \"pointer-events: auto;\";\r\n                var SLbutton = document.createElement(\"button\");\r\n                SLbutton.setAttribute(\"id\", \"streetLevButton\");\r\n                SLbutton.addEventListener(\"click\", streetLevel);\r\n                this._container.appendChild(SLbutton);\r\n                var SLicon = document.createElement(\"span\");\r\n                SLicon.style.cssText =\r\n                    'background-image: url(\"' + process.env.API_URL + '.slpy.com/symbols/walking-solid.svg\");background-size: 1em;';\r\n                SLicon.className = \"maplibregl-ctrl-icon\";\r\n                SLbutton.appendChild(SLicon);\r\n                return this._container;\r\n            };\r\n            StreetLevelControl.prototype.onRemove = function () {\r\n                this._container.parentNode.removeChild(this._container);\r\n                this._map = undefined;\r\n            };\r\n            StreetLevelControl = new StreetLevelControl();\r\n            map.addControl(StreetLevelControl, \"bottom-right\");\r\n            mapState.streetLevelOn = false;\r\n            var streetLevelLoad = true;\r\n            var mly = new mapillary.Viewer({\r\n                accessToken: MapillaryKey,\r\n                component: {\r\n                    cover: false\r\n                },\r\n                container: \"mly\"\r\n            });\r\n            mly.on(\"image\", function (event) {\r\n                var lngLat = [\r\n                    event.image.originalLngLat.lng,\r\n                    event.image.originalLngLat.lat\r\n                ];\r\n                var bearing = event.image.compassAngle - 45;\r\n                var data = {\r\n                    type: \"Feature\",\r\n                    geometry: {\r\n                        type: \"Point\",\r\n                        coordinates: lngLat\r\n                    },\r\n                    properties: {\r\n                        bearing: bearing\r\n                    }\r\n                };\r\n                map.getSource(\"streetLevelIcon\").setData(data);\r\n                map.flyTo({\r\n                    center: lngLat\r\n                });\r\n            });\r\n            map.on(\"click\", function (e) {\r\n                if (typeof mapState.streetLevelOn !== \"undefined\") {\r\n                    if (mapState.streetLevelOn) {\r\n                        var feature = map.queryRenderedFeatures(e.point, {\r\n                            layers: [\"mimgLayer\"]\r\n                        });\r\n                        if (typeof feature[0] !== \"undefined\") {\r\n                            var fkey = feature[0].properties.id;\r\n                            mly.moveTo(fkey)[\"catch\"](function (reason) {\r\n                                console.log(\"Mapillary missing image\");\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            window.addEventListener(\"resize\", function () {\r\n                if (mapState.streetLevelOn) {\r\n                    var maptarParent = maptarContainer.parentNode;\r\n                    if (maptarParent.offsetHeight > maptarParent.offsetWidth) {\r\n                        maptarContainer.style.height = \"35%\";\r\n                        maptarContainer.style.width = \"100%\";\r\n                        mlyContainer.style.width = \"100%\";\r\n                        mlyContainer.style.height = \"65%\";\r\n                    } else {\r\n                        maptarContainer.style.width = \"35%\";\r\n                        maptarContainer.style.height = \"100%\";\r\n                        mlyContainer.style.height = \"100%\";\r\n                        mlyContainer.style.width = \"65%\";\r\n                    }\r\n                    mly.resize();\r\n                    map.resize();\r\n                }\r\n            });\r\n        }\r\n    }\r\n}","//Copyright 2023, Slpy, all rights reserved.\r\n//Check out https://github.com/Spy-API/Slpy-JS and https://www.slpy.com/legal for licensing and terms\r\n\r\nimport { addressAutocomplete } from './src/addressAutocomplete.js';\r\nimport { addAerialImagery } from './src/aerialImagery.js';\r\nimport { addAutocomplete } from './src/autocomplete.js';\r\nimport { addMarkers, highlightMarker, dehighlightMarker, removeMarker, createMarker, setMarkerOpen, quickMarkersCenter } from './src/markers.js';\r\nimport { mapState, settings, openlayersParts, mapLibraries } from './src/globals.js';\r\nimport { addMapillary } from './src/streetLevel.js';\r\nimport { isWebGL2Supported, loadScript,setInteractionOnFocus, setTransform, flyTo, toRad, distanceInKM, distanceInMI } from './src/utils.js';\r\n\r\nexport default {\r\n  addressAutocomplete,\r\n  addAerialImagery,\r\n  addAutocomplete,\r\n  addMarkers,\r\n  highlightMarker,\r\n  dehighlightMarker,\r\n  removeMarker,\r\n  createMarker,\r\n  setMarkerOpen,\r\n  quickMarkersCenter,\r\n  addMapillary,\r\n  isWebGL2Supported,\r\n  loadScript,\r\n  setInteractionOnFocus,\r\n  setTransform,\r\n  flyTo,\r\n  toRad,\r\n  distanceInKM,\r\n  distanceInMI,\r\n  mapState,\r\n  settings,\r\n  openlayersParts,\r\n  mapLibraries\r\n};","//Copyright 2023, Slpy, all rights reserved.\r\n//Check out https://github.com/Spy-API/Slpy-JS and https://www.slpy.com/legal for licensing and terms\r\nimport { addAutocomplete } from \"./autocomplete.js\";\r\n\r\nexport function addressAutocomplete(targetInput, autoOptions) {\r\n    if (typeof targetInput === \"string\") {\r\n      var formTarget = document.getElementById(targetInput);\r\n    } else if (\r\n      targetInput &&\r\n      (target.nodeName.toLowerCase() === \"form\" ||\r\n        targetInput.nodeName.toLowerCase() === \"textarea\")\r\n    ) {\r\n      var formTarget = targetInput;\r\n    } else {\r\n      console.log(\r\n        \"Target form for address autocomplete is not a valid Form element or id.\"\r\n      );\r\n    }\r\n    autoOptions[\"autocompleteType\"] = \"address\";\r\n    if (formTarget.tagName.toLowerCase() === \"form\") {\r\n      var inputFields = formTarget.querySelectorAll(\r\n        \"input[autocomplete], textarea[autocomplete]\"\r\n      );\r\n      var formParts = {};\r\n      for (var i = 0; i < inputFields.length; i++) {\r\n        var autoCompleteAttr = inputFields[i].getAttribute(\"autocomplete\");\r\n        if (autoCompleteAttr) {\r\n          var autoSection = \"0\";\r\n          if (typeof autoCompleteAttr.split(\" \")[1] !== \"undefined\") {\r\n            var lastSpaceIndex = autoCompleteAttr.lastIndexOf(\" \");\r\n            autoSection = autoCompleteAttr.slice(0, lastSpaceIndex);\r\n            autoCompleteAttr = autoCompleteAttr.slice(lastSpaceIndex + 1);\r\n            if (typeof formParts[autoSection] === \"undefined\") {\r\n              formParts[autoSection] = {};\r\n            }\r\n          }\r\n          switch (autoCompleteAttr) {\r\n            case \"street-address\":\r\n              formParts[autoSection][\"street-line\"] = inputFields[i];\r\n              break;\r\n            case \"address-line1\":\r\n              formParts[autoSection][\"street-line\"] = inputFields[i];\r\n              break;\r\n            case \"address-level1\":\r\n              formParts[autoSection][\"address-level1\"] = inputFields[i];\r\n              break;\r\n            case \"address-level2\":\r\n              formParts[autoSection][\"address-level2\"] = inputFields[i];\r\n              break;\r\n            case \"address-level3\":\r\n              formParts[autoSection][\"address-level3\"] = inputFields[i];\r\n              break;\r\n            case \"address-level4\":\r\n              formParts[autoSection][\"address-level4\"] = inputFields[i];\r\n              break;\r\n            case \"postal-code\":\r\n              formParts[autoSection][\"postal-code\"] = inputFields[i];\r\n              break;\r\n            case \"country\":\r\n              formParts[autoSection][\"country\"] = inputFields[i];\r\n              break;\r\n            case \"country-name\":\r\n              formParts[autoSection][\"country-name\"] = inputFields[i];\r\n              break;\r\n            default:\r\n              break;\r\n          }\r\n        }\r\n      }\r\n      var returnUpdates = [];\r\n      for (var autoSectionKey in formParts) {\r\n        if (formParts.hasOwnProperty(autoSectionKey)) {\r\n          if (typeof formParts[autoSectionKey][\"street-line\"] !== \"undefined\") {\r\n            if (\r\n              typeof formParts[autoSectionKey][\"street-line\"].id == \"undefined\" ||\r\n              formParts[autoSectionKey][\"street-line\"].id == \"\"\r\n            ) {\r\n              formParts[autoSectionKey][\"street-line\"].id =\r\n                \"StAuto-\" + autoSectionKey;\r\n            }\r\n            (function (autoSectionKey, formParts) {\r\n              var formfill = function formfill(returnInput, selectedItem) {\r\n                returnInput.value = selectedItem[\"street\"];\r\n                for (var autoSectionEle in formParts[autoSectionKey]) {\r\n                  switch (autoSectionEle) {\r\n                    case \"address-level1\":\r\n                      formParts[autoSectionKey][\"address-level1\"].value =\r\n                        selectedItem[\"region\"];\r\n                      break;\r\n                    case \"address-level2\":\r\n                      formParts[autoSectionKey][\"address-level2\"].value =\r\n                        selectedItem[\"city\"];\r\n                      break;\r\n                    case \"postal-code\":\r\n                      formParts[autoSectionKey][\"postal-code\"].value =\r\n                        selectedItem[\"postcode\"];\r\n                      break;\r\n                    case \"country\":\r\n                      formParts[autoSectionKey][\"country\"].value =\r\n                        selectedItem[\"country\"];\r\n                      break;\r\n                    case \"country-code\":\r\n                      if (selectedItem[\"country-code\"]) {\r\n                        formParts[autoSectionKey][\"country-code\"].value =\r\n                        selectedItem[\"country-code\"];\r\n                      } else {\r\n                        formParts[autoSectionKey][\"country-code\"].value =\r\n                        selectedItem[\"country_code\"];\r\n                      }\r\n                      break;\r\n                    default:\r\n                      break;\r\n                  }\r\n                }\r\n              };\r\n              var returnUpdate = addAutocomplete(\r\n                formParts[autoSectionKey][\"street-line\"].id,\r\n                autoOptions,\r\n                formfill\r\n              );\r\n              if (typeof returnUpdate.updateAutocomplete !== \"undefined\") {\r\n                returnUpdates.push(returnUpdate);\r\n              }\r\n            })(autoSectionKey, formParts);\r\n          } else {\r\n            console.log(\r\n              \"API: An input with autocomplete attribute 'street-address' or 'address-line1' was not found.\"\r\n            );\r\n          }\r\n        }\r\n      }\r\n      return returnUpdates;\r\n    }\r\n  }","//Copyright 2023, Slpy, all rights reserved.\r\n//Check out https://github.com/Spy-API/Slpy-JS and https://www.slpy.com/legal for licensing and terms\r\n\r\nimport { mapState, settings, mapLibraries } from \"./globals.js\";\r\n\r\nexport function addAerialImagery(map) {\r\n    var aerialImageryLoad = true;\r\n    var AIbbox = [\r\n        [\r\n            [-104.853516, 29.774649],\r\n            [-80.90332, 41.808621]\r\n        ],\r\n        // s_c\r\n        [\r\n            [-114.697266, 31.733423],\r\n            [-106.54541, 49.09563]\r\n        ],\r\n        // w_c\r\n        [\r\n            [-125.727539, 32.407206],\r\n            [-114.609375, 49.125338]\r\n        ],\r\n        // w\r\n        [\r\n            [-108.149414, 31.735093],\r\n            [-104.633789, 49.152471]\r\n        ],\r\n        // c\r\n        [\r\n            [-81.101074, 31.864267],\r\n            [-69.675293, 42.359457]\r\n        ],\r\n        // e\r\n        [\r\n            [-83.693848, 24.493357],\r\n            [-79.848633, 30.395503]\r\n        ],\r\n        // fl\r\n        [\r\n            [-101.645508, 28.849233],\r\n            [-84.528809, 29.749476]\r\n        ],\r\n        // tx_l\r\n        [\r\n            [-100.623779, 25.743899],\r\n            [-95.339355, 28.827531]\r\n        ],\r\n        // tx_s\r\n        [\r\n            [-106.479492, 30.340827],\r\n            [-104.699707, 32.162079]\r\n        ],\r\n        // tx_w\r\n        [\r\n            [-112.543945, 31.25324],\r\n            [-108.105469, 31.964051]\r\n        ],\r\n        // az\r\n        [\r\n            [-104.897461, 41.758319],\r\n            [-82.375488, 46.029057]\r\n        ],\r\n        // io\r\n        [\r\n            [-104.919434, 45.943561],\r\n            [-83.210449, 47.548488]\r\n        ],\r\n        // mi\r\n        [\r\n            [-104.941406, 47.48012],\r\n            [-88.088379, 48.298688]\r\n        ],\r\n        // nd\r\n        [\r\n            [-104.952393, 48.277197],\r\n            [-92.362061, 49.418971]\r\n        ],\r\n        // ca_s\r\n        [\r\n            [-79.969482, 42.295311],\r\n            [-69.829102, 43.573655]\r\n        ],\r\n        // ny\r\n        [\r\n            [-76.640625, 43.53305],\r\n            [-66.52771, 45.077231]\r\n        ],\r\n        // vt\r\n        [\r\n            [-71.5979, 45.03054],\r\n            [-66.994629, 47.493728]\r\n        ],\r\n        // mn\r\n        [\r\n            [-67.985919, 17.265936],\r\n            [-64.52648, 18.884333]\r\n        ],\r\n        // pr\r\n    ];\r\n    if (typeof mapLibraries.ol !== \"undefined\") {\r\n        var isInAerialArea = function isInAerialArea() {\r\n            var curmapaiz = map.getView().getZoom();\r\n            if (curmapaiz > 20) {\r\n                return false;\r\n            }\r\n            var inSatArea = false;\r\n            var bbarea = 0;\r\n            var curmapcentr = map.getView().getCenter();\r\n            do {\r\n                var BBX = new mapLibraries.ol.extent.boundingExtent([\r\n                    mapLibraries.ol.proj.fromLonLat(AIbbox[bbarea][0]),\r\n                    mapLibraries.ol.proj.fromLonLat(AIbbox[bbarea][1])\r\n                ]);\r\n                inSatArea = mapLibraries.ol.extent.containsCoordinate(BBX, curmapcentr);\r\n                bbarea++;\r\n            } while (!inSatArea && bbarea < 18);\r\n            if (!inSatArea && curmapaiz > 15.5) {\r\n                return false;\r\n            }\r\n            return true;\r\n        };\r\n        var satelliteSource = new mapLibraries.ol.layer.Tile({\r\n            source: new mapLibraries.ol.source.XYZ({\r\n                format: new mapLibraries.ol.format.MVT(),\r\n                maxZoom: 17,\r\n                url:\r\n                    process.env.API_URL + \".slpy.com/v1/app/aerial-imagery/{z}/{x}/{y}.png?key=\" +\r\n                    settings.apiKey\r\n            }),\r\n            minZoom: 0,\r\n            maxZoom: 20,\r\n            zindex: 0\r\n        });\r\n        //use below for ie9 since vector overlay will be missing\r\n        var satelliteSourceRaster = new mapLibraries.ol.layer.Tile({\r\n            source: new mapLibraries.ol.source.XYZ({\r\n                format: new mapLibraries.ol.format.MVT(),\r\n                maxZoom: 16,\r\n                url:\r\n                    process.env.API_URL + \".slpy.com/v1/app/aerial-topo/{z}/{x}/{y}.png?key=\" +\r\n                    settings.apiKey\r\n            }),\r\n            minZoom: 0,\r\n            maxZoom: 19,\r\n            zindex: 0\r\n        });\r\n        class AIbutton extends mapLibraries.ol.control.Control {\r\n            constructor(opt_options) {\r\n                var options = opt_options || {};\r\n                var AIicon = document.createElement(\"button\");\r\n                AIicon.style.cssText =\r\n                    'background-image: url(\"https://www.slpy.com/img/AerialImagery.png\");background-size: contain;border-radius: 4px; width: 45px; height: 45px';\r\n                AIicon.setAttribute(\"id\", \"AerialImageryIcon\");\r\n                var element = document.createElement(\"div\");\r\n                element.className = \"ol-control\";\r\n                element.setAttribute(\"id\", \"AerialImageryButton\");\r\n                element.style.cssText =\r\n                    \"bottom: 0; right: 8px; margin-bottom: 50px; width: 45px; height: 45px\";\r\n                element.appendChild(AIicon);\r\n                super({\r\n                    element: element,\r\n                    target: options.target\r\n                });\r\n                AIicon.addEventListener(\r\n                    \"click\",\r\n                    this.AerialImageryControl.bind(this),\r\n                    false\r\n                );\r\n            }\r\n            AerialImageryControl() {\r\n\r\n                if (mapState.aerialImageryOn) {\r\n                    if (mapState.oldIE) {\r\n                        this.getMap().removeLayer(satelliteSourceRaster);\r\n                    } else {\r\n                        this.getMap().removeLayer(satelliteSource);\r\n                        if (typeof mapState.streetLevelOn !== \"undefined\") {\r\n                            if (mapState.streetLevelOn) {\r\n                                mapillarySource.setStyle(photoDot);\r\n                            }\r\n                        }\r\n                    }\r\n                    document.getElementById(\"AerialImageryIcon\").style.backgroundImage =\r\n                        \"url('https://www.slpy.com/img/AerialImagery.png')\";\r\n                    mapState.aerialImageryOn = false;\r\n                    map.getLayers().forEach(function (layer) {\r\n                        layer.getSource().refresh();\r\n                    });\r\n                } else if (isInAerialArea()) {\r\n                    mapState.aerialImageryOn = true;\r\n                    //setting oldie true is temporary hack until we fix aerial on openlayers with a gl style\r\n                    mapState.oldIE = true;\r\n                    if (mapState.oldIE) {\r\n                        map.addLayer(satelliteSourceRaster);\r\n                    } else {\r\n                        map.getLayers().forEach(function (layer) {\r\n                            layer.getSource().refresh();\r\n                        });\r\n                        map.getLayers().insertAt(0, satelliteSource);\r\n                        if (typeof mapState.streetLevelOn !== \"undefined\") {\r\n                            if (mapState.streetLevelOn) {\r\n                                mapillarySource.setStyle(photoDotAerial);\r\n                            }\r\n                        }\r\n                    }\r\n                    document.getElementById(\"AerialImageryIcon\").style.backgroundImage =\r\n                        \"url('https://www.slpy.com/img/VectorImagery.png')\";\r\n                } else {\r\n                    if (map.getView().getZoom() > 19) {\r\n                        alert(\"No Aerial Imagery at this level.  Try zooming out.\");\r\n                    } else {\r\n                        alert(\"No Aerial Imagery available in this region.\");\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        map.addControl(new AIbutton());\r\n        var showingAerialButton = true;\r\n        var AerialButton = document.getElementById(\"AerialImageryButton\");\r\n        if (!isInAerialArea()) {\r\n            AerialButton.style.display = \"none\";\r\n            showingAerialButton = false;\r\n        }\r\n        map.on(\"moveend\", function () {\r\n            if (isInAerialArea() && !showingAerialButton) {\r\n                AerialButton.style.display = \"block\";\r\n                showingAerialButton = true;\r\n            } else if (!isInAerialArea() && showingAerialButton) {\r\n                AerialButton.style.display = \"none\";\r\n                showingAerialButton = false;\r\n                if (mapState.aerialImageryOn) {\r\n                    document.getElementById(\"AerialImageryIcon\").click();\r\n                }\r\n            }\r\n        });\r\n    } else if (mapState.maplibreLoaded) {\r\n        var isInAerialAreaMb = function isInAerialAreaMb() {\r\n            var curmapaiz = map.getZoom();\r\n            if (curmapaiz > 19) {\r\n                return false;\r\n            }\r\n            var inSatArea = false;\r\n            var bbarea = 0;\r\n            var curmapcentr = map.getCenter();\r\n            do {\r\n                var BBX = new mapLibraries.maplibregl.LngLatBounds(AIbbox[bbarea]);\r\n                inSatArea = BBX.contains(curmapcentr);\r\n                bbarea++;\r\n            } while (!inSatArea && bbarea < 18);\r\n            if (!inSatArea && curmapaiz > 14.5) {\r\n                return false;\r\n            }\r\n            return true;\r\n        };\r\n        var originalStyle = \"\";\r\n        var AerialImageryControl = function AerialImageryControl() { };\r\n        var AerialImagery = function AerialImagery() {\r\n            if (mapState.aerialImageryOn) {\r\n                if (typeof mapState.streetLevelOn !== \"undefined\") {\r\n                    if (!mapState.streetLevelOn) {\r\n                        map.setStyle(originalStyle);\r\n                        if (map.getLayer(\"mimgLayer\")) {\r\n                            map.removeLayer(\"mimgLayer\");\r\n                        }\r\n                        if (map.getLayer(\"streetLevelIcon\")) {\r\n                            map.removeLayer(\"streetLevelIcon\");\r\n                        }\r\n                    } else {\r\n                        var slicosour = map.getSource(\"streetLevelIcon\");\r\n                        var mimgsour = map.getSource(\"mimgLayer\");\r\n                        var mimglay = map.getLayer(\"mimgLayer\");\r\n                        var slilay = map.getLayer(\"streetLevelIcon\");\r\n                        map.setStyle(originalStyle);\r\n                        if (!mimgsour) {\r\n                            map.addSource(\"mimgLayer\", {\r\n                                type: \"vector\",\r\n                                tiles: mimgsour[\"tiles\"],\r\n                                minzoom: mimgsour[\"minzoom\"],\r\n                                maxzoom: mimgsour[\"maxzoom\"]\r\n                            });\r\n                        }\r\n                        if (!slicosour) {\r\n                            map.addSource(\"streetLevelIcon\", {\r\n                                type: \"geojson\",\r\n                                data: slicosour[\"_data\"]\r\n                            });\r\n                        }\r\n                        if (!mimglay) {\r\n                            map.addLayer({\r\n                                id: \"mimgLayer\",\r\n                                type: \"circle\",\r\n                                source: \"mimgLayer\",\r\n                                \"source-layer\": \"mapillary-images\",\r\n                                minzoom: mimglay[\"minzoom\"],\r\n                                maxzoom: mimglay[\"maxzoom\"],\r\n                                paint: mimglay[\"paint_\"]\r\n                            });\r\n                        }\r\n                        if (!slilay) {\r\n                            map.addLayer({\r\n                                id: \"streetLevelIcon\",\r\n                                type: \"symbol\",\r\n                                source: \"streetLevelIcon\",\r\n                                paint: slilay[\"paint_\"],\r\n                                layout: slilay[\"layout_\"]\r\n                            });\r\n                        }\r\n                    }\r\n                } else {\r\n                    map.setStyle(originalStyle);\r\n                }\r\n                document.getElementById(\"AerialImageryIcon\").style.backgroundImage =\r\n                    \"url('https://www.slpy.com/img/AerialImagery.png')\";\r\n                mapState.aerialImageryOn = false;\r\n            } else if (isInAerialAreaMb()) {\r\n                if (aerialImageryLoad) {\r\n                    map.addSource(\"satellite\", aerialImagerySource);\r\n                    aerialImageryLoad = false;\r\n                }\r\n                originalStyle = map.getStyle();\r\n                if (typeof mapState.streetLevelOn !== \"undefined\") {\r\n                    if (mapState.streetLevelOn) {\r\n                        map.setPaintProperty(\r\n                            \"mimgLayer\",\r\n                            \"circle-color\",\r\n                            \"rgba(53, 175, 109,0.5)\"\r\n                        );\r\n                    }\r\n                }\r\n                map.addLayer(\r\n                    {\r\n                        id: \"satellite\",\r\n                        type: \"raster\",\r\n                        source: \"satellite\",\r\n                        minzoom: 0,\r\n                        maxzoom: 19\r\n                    },\r\n                    \"necountries-4\"\r\n                );\r\n                document.getElementById(\"AerialImageryIcon\").style.backgroundImage =\r\n                    \"url('https://www.slpy.com/img/VectorImagery.png')\";\r\n                map.setLayoutProperty(\"roads-casing\", \"visibility\", \"none\");\r\n                map.setLayoutProperty(\"roads-motorway-casing-low-zoom\", \"visibility\", \"none\");\r\n                map.setLayoutProperty(\"highway-area-fill\", \"visibility\", \"none\");\r\n                map.setLayoutProperty(\"highway-motorway-shadow\", \"visibility\", \"none\");\r\n                map.setLayoutProperty(\"highway-trunk-shadow\", \"visibility\", \"none\");\r\n                map.setLayoutProperty(\"roads-low-zoom-primary-shadow\", \"visibility\", \"none\");\r\n                map.setLayoutProperty(\"roads-low-zoom-secondary-shadow\", \"visibility\", \"none\");\r\n                map.setLayoutProperty(\"roads-low-zoom-motorway-shadow\", \"visibility\", \"none\");\r\n                map.setLayoutProperty(\"roads-low-zoom-trunk-shadow\", \"visibility\", \"none\");\r\n                map.setPaintProperty(\"highway-motorway\", \"line-color\", \"#edaa82\");\r\n                map.setPaintProperty(\"roads\", \"line-opacity\", 0.5);\r\n                map.setPaintProperty(\"roads-low-zoom-secondary\", \"line-opacity\", 0.5);\r\n                map.setPaintProperty(\"roads-low-zoom-trunk\", \"line-opacity\", 0.3);\r\n                map.setPaintProperty(\"highway-motorway\", \"line-opacity\", 0.5);\r\n                map.setPaintProperty(\"highway-trunk\", \"line-color\", \"#bbb\");\r\n                map.setPaintProperty(\"highway-trunk\", \"line-width\", 1);\r\n                map.setPaintProperty(\"highway-trunk\", \"line-opacity\", 0.5);\r\n                map.setPaintProperty(\"ferry-routes\", \"line-opacity\", 0.5);\r\n                map.setPaintProperty(\"roads-text-name\", \"text-color\", \"#000\");\r\n                map.setPaintProperty(\"roads-text-name\", \"text-halo-width\", 1.25);\r\n                map.setPaintProperty(\"placenames\", \"text-color\", \"#fff\");\r\n                map.setPaintProperty(\"placenames\", \"text-halo-color\", \"#000\");\r\n                map.setPaintProperty(\"placenames\", \"text-halo-width\", 1);\r\n                map.setPaintProperty(\"placenames-small\", \"text-color\", \"#fff\");\r\n                map.setPaintProperty(\"placenames-small\", \"text-halo-color\", \"#555\");\r\n                map.setPaintProperty(\"placenames-small\", \"text-halo-width\", 1.5);\r\n                map.setPaintProperty(\"ocean-points\", \"text-halo-color\", \"#4f6f80\");\r\n                map.setPaintProperty(\"ocean-points\", \"text-color\", \"#fff\");\r\n                map.setPaintProperty(\r\n                    \"state-names\",\r\n                    \"text-halo-color\",\r\n                    \"rgba(114, 83, 128, 0.6)\"\r\n                );\r\n                map.setPaintProperty(\r\n                    \"state-names\",\r\n                    \"text-color\",\r\n                    \"rgba(255, 255, 255, 0.6)\"\r\n                );\r\n                map.setPaintProperty(\r\n                    \"state-names-low-zoom\",\r\n                    \"text-halo-color\",\r\n                    \"rgba(114, 83, 128, 0.6)\"\r\n                );\r\n                map.setPaintProperty(\r\n                    \"state-names-low-zoom\",\r\n                    \"text-color\",\r\n                    \"rgba(255, 255, 255, 0.6)\"\r\n                );\r\n                map.setPaintProperty(\r\n                    \"amenity-points-landuse\",\r\n                    \"text-halo-color\",\r\n                    \"#fff\"\r\n                );\r\n                map.setPaintProperty(\"amenity-points-landuse\", \"text-halo-width\", 1);\r\n                map.setPaintProperty(\"text-poly-low-zoom\", \"text-halo-color\", \"#fff\");\r\n                map.setPaintProperty(\"text-poly-low-zoom\", \"text-halo-width\", 0.5);\r\n                map.setPaintProperty(\"amenity-points-low\", \"icon-halo-width\", 0.5);\r\n                map.setPaintProperty(\"amenity-points\", \"icon-halo-width\", 0.5);\r\n                map.setPaintProperty(\"amenity-points-mid\", \"icon-halo-width\", 0.5);\r\n                map.setPaintProperty(\"amenity-points-high\", \"icon-halo-width\", 0.5);\r\n                map.setPaintProperty(\"amenity-points-low\", \"text-halo-width\", 0.6);\r\n                map.setPaintProperty(\"amenity-points\", \"text-halo-width\", 0.6);\r\n                map.setPaintProperty(\"amenity-points-mid\", \"text-halo-width\", 0.6);\r\n                map.setPaintProperty(\"amenity-points-high\", \"text-halo-width\", 0.6);\r\n                map.setPaintProperty(\"necountries-4\", \"line-color\", \"#222\");\r\n                map.setPaintProperty(\"necountries-2\", \"line-color\", \"#222\");\r\n                map.setPaintProperty(\"admin-mid-zoom-2\", \"line-color\", \"#222\");\r\n                map.setPaintProperty(\"admin-mid-zoom-3\", \"line-color\", \"#222\");\r\n                map.setPaintProperty(\"admin-mid-zoom-4\", \"line-color\", \"#222\");\r\n                map.setPaintProperty(\"admin-high-zoom-2\", \"line-color\", \"#222\");\r\n                map.setPaintProperty(\"admin-high-zoom-3\", \"line-color\", \"#222\");\r\n                map.setPaintProperty(\"admin-high-zoom-4\", \"line-color\", \"#222\");\r\n                mapState.aerialImageryOn = true;\r\n            } else {\r\n                if (map.getZoom() > 19) {\r\n                    alert(\"No Aerial Imagery at this level.  Try zooming out.\");\r\n                } else {\r\n                    alert(\"No Aerial Imagery available in this region.\");\r\n                }\r\n            }\r\n        };\r\n        var aerialImagerySource = {\r\n            type: \"raster\",\r\n            scheme: \"xyz\",\r\n            tiles: [\r\n                process.env.API_URL + \".slpy.com/v1/app/aerial-imagery/{z}/{x}/{y}.png?key=\" +\r\n                settings.apiKey\r\n            ],\r\n            minzoom: 0,\r\n            maxzoom: 17,\r\n            tileSize: 256\r\n        };\r\n        AerialImageryControl.prototype.onAdd = function (map) {\r\n            this._map = map;\r\n            this._container = document.createElement(\"div\");\r\n            this._container.className = \"maplibregl-ctrl maplibregl-ctrl-group\";\r\n            this._container.style.cssText = \"pointer-events: auto;\";\r\n            this._container.setAttribute(\"id\", \"AerialImageryButton\");\r\n            var AIbutton = document.createElement(\"button\");\r\n            AIbutton.style.width = \"45px\";\r\n            AIbutton.style.height = \"45px\";\r\n            AIbutton.addEventListener(\"click\", AerialImagery);\r\n            this._container.appendChild(AIbutton);\r\n            var AIicon = document.createElement(\"span\");\r\n            AIicon.style.cssText =\r\n                'background-image: url(\"https://www.slpy.com/img/AerialImagery.png\");background-size: contain;border-radius: 4px;';\r\n            AIicon.setAttribute(\"id\", \"AerialImageryIcon\");\r\n            AIicon.className = \"maplibregl-ctrl-icon\";\r\n            AIbutton.appendChild(AIicon);\r\n            return this._container;\r\n        };\r\n        AerialImageryControl.prototype.onRemove = function () {\r\n            this._container.parentNode.removeChild(this._container);\r\n            this._map = undefined;\r\n        };\r\n        AerialImageryControl = new AerialImageryControl();\r\n        map.addControl(AerialImageryControl, \"bottom-right\");\r\n        var showingAerialButton = true;\r\n        var AerialButton = document.getElementById(\"AerialImageryButton\");\r\n        if (!isInAerialAreaMb()) {\r\n            AerialButton.style.display = \"none\";\r\n            showingAerialButton = false;\r\n        }\r\n        map.on(\"idle\", function () {\r\n            if (isInAerialAreaMb() && !showingAerialButton) {\r\n                AerialButton.style.display = \"block\";\r\n                showingAerialButton = true;\r\n            } else if (!isInAerialAreaMb() && showingAerialButton) {\r\n                AerialButton.style.display = \"none\";\r\n                showingAerialButton = false;\r\n                if (mapState.aerialImageryOn) {\r\n                    AerialImagery();\r\n                }\r\n            }\r\n        });\r\n    }\r\n}","//Copyright 2023, Slpy, all rights reserved.\r\n//Check out https://github.com/Spy-API/Slpy-JS and https://www.slpy.com/legal for licensing and terms\r\n\r\nimport { isVectorSupported } from './utils.js';\r\nimport { settings, openlayersParts, mapState, mapLibraries } from './globals.js';\r\nimport { loadOpenLayers } from './loadOL.js'\r\nimport { loadOLMS } from './loadOLMS.js';\r\n\r\nexport function openlayersMap(options) {\r\n    mapLibraries.ol = loadOpenLayers();\r\n\r\n    if (!options[\"controls\"]) {\r\n        var olDefaults = {\r\n            rotate: true,\r\n            rotateOptions: {\r\n                autoHide: false\r\n            },\r\n            zoom: true,\r\n            zoomOptions: {\r\n                zoomDuration: 500\r\n            },\r\n            attribution: true,\r\n            attributionOptions: {\r\n                collapsible: false\r\n            }\r\n        };\r\n\r\n        // Check if the \"defaults\" function exists for map controls.\r\n        if (typeof mapLibraries.ol.control.defaults == \"function\") {\r\n            options[\"controls\"] = mapLibraries.ol.control.defaults(olDefaults);\r\n        } else {\r\n            options[\"controls\"] = mapLibraries.ol.control.defaults.defaults(olDefaults);\r\n        }\r\n    }\r\n    openlayersParts.controls = options[\"controls\"];\r\n    if (!options[\"interactions\"]) {\r\n        // Check if the \"defaults\" function exists for map interactions.\r\n        if (typeof mapLibraries.ol.interaction.defaults == \"function\") {\r\n            options[\"interactions\"] = mapLibraries.ol.interaction.defaults({\r\n                pinchRotate: false\r\n            });\r\n        } else {\r\n            options[\"interactions\"] = mapLibraries.ol.interaction.defaults.defaults({\r\n                pinchRotate: false\r\n            });\r\n        }\r\n    }\r\n    openlayersParts.interactions = options[\"interactions\"];\r\n    var mapType = \"vector\";\r\n    if (typeof options[\"mapType\"] !== \"undefined\" && options[\"mapType\"] == \"raster\") {\r\n        mapType = \"raster\";\r\n    }\r\n    if (!options[\"apiKey\"]) {\r\n        console.log(\"Slpy Map Missing apiKey: Please add your Slpy apiKey to the options object in the olMap function.\");\r\n    }\r\n    if (!options[\"target\"] && !options[\"container\"]) {\r\n        console.log(\"Slpy Map Missing target: Please add your target id or element to the options object in the olMap function.\");\r\n    } else if (options[\"container\"]) {\r\n        options[\"target\"] = options[\"container\"];\r\n    }\r\n    if (!options[\"center\"]) {\r\n        console.log(\"Slpy Map Missing center: Please add your center as a [longitude, latitude] element to the options object in the olMap function.\");\r\n    }\r\n    if (!options[\"zoom\"]) {\r\n        console.log(\"Slpy Map Missing zoom: Please add a zoom value to the options object in the olMap function. Level 0 is globe, 20 is house level.\");\r\n    }\r\n    if (!options[\"view\"]) {\r\n        // Check if the \"defaults\" function exists for map interactions.\r\n        options[\"view\"] = getView(options[\"center\"], options[\"zoom\"]);\r\n    }\r\n    if (typeof options[\"language\"] !== \"undefined\" && options[\"language\"].toLowerCase() != \"en\") {\r\n        options[\"mapLanguage\"] = options[\"language\"].toLowerCase();\r\n    } else if (typeof options[\"mapLanguage\"] !== \"undefined\" && options[\"mapLanguage\"].toLowerCase() != \"en\") {\r\n        options[\"mapLanguage\"] = options[\"mapLanguage\"].toLowerCase();\r\n    } else {\r\n        options[\"mapLanguage\"] = \"en\";\r\n    }\r\n    openlayersParts.view = options[\"view\"];\r\n    settings.apiKey = options[\"apiKey\"];\r\n    if (mapType == \"raster\") {\r\n        mapState.openlayersLoaded = true;\r\n        return new mapLibraries.ol.Map({\r\n            controls: openlayersParts.controls,\r\n            interactions: openlayersParts.interactions,\r\n            layers: [getLayer(mapType, settings.apiKey, options)],\r\n            target: options[\"target\"],\r\n            view: openlayersParts.view\r\n        });\r\n    } else {\r\n        var map = new mapLibraries.ol.Map({\r\n            controls: openlayersParts.controls,\r\n            interactions: openlayersParts.interactions,\r\n            target: options[\"target\"],\r\n            view: openlayersParts.view\r\n        });\r\n        mapLibraries.olms = loadOLMS();\r\n        if (typeof mapLibraries.olms !== \"undefined\") {\r\n            mapLibraries.olms.apply(map, process.env.API_URL + \".slpy.com/style/slpy-mgl-style.json?key=\" + settings.apiKey);\r\n        }\r\n        mapState.openlayersLoaded = true;\r\n        return map;\r\n    }\r\n\r\n}\r\n\r\nexport function getView(center, startZoom) {\r\n    return new mapLibraries.ol.View({\r\n        center: mapLibraries.ol.proj.fromLonLat(center),\r\n        zoom: startZoom,\r\n        maxZoom: 21\r\n    });\r\n}\r\n\r\n//create Layer function\r\nexport function getLayer(type, apiKey, options) {\r\n    var myNav = navigator.userAgent.toLowerCase();\r\n\r\n    //check for IE Raster fallback\r\n    var showRaster = false;\r\n    if (settings.rasterFallback && type != \"raster\") {\r\n        if (!isVectorSupported()) {\r\n            showRaster = true;\r\n            mapState.oldIE = true;\r\n        }\r\n    } else if (type == \"raster\") {\r\n        if (!isVectorSupported()) {\r\n            mapState.oldIE = true;\r\n        }\r\n    }\r\n    var requiredAttribution =\r\n        '©&nbsp;<a href=\"https://www.slpy.com\">Slpy</a> ©&nbsp;<a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>&nbsp;contributors';\r\n    if (showRaster || type == \"raster\") {\r\n        //raster layer\r\n        var tilePixelRatioS = 2;\r\n        if (mapState.oldIE) {\r\n            if (parseInt(myNav.split(\"msie\")[1]) <= 9) {\r\n                tilePixelRatioS = 1;\r\n            }\r\n        }\r\n        return new mapLibraries.ol.layer.Tile({\r\n            source: new mapLibraries.ol.source.XYZ({\r\n                maxZoom: 19,\r\n                tileSize: 256,\r\n                tilePixelRatio: tilePixelRatioS,\r\n                attributions: requiredAttribution,\r\n                url:\r\n                    process.env.API_URL + \".slpy.com/v1/raster/\" +\r\n                    options[\"mapLanguage\"] +\r\n                    \"/{z}/{x}/{y}.png?key=\" +\r\n                    apiKey\r\n            })\r\n        });\r\n    } else {\r\n        //vector layer\r\n        return new mapLibraries.ol.layer.VectorTile({\r\n            declutter: true,\r\n            source: new mapLibraries.ol.source.VectorTile({\r\n                maxZoom: 15,\r\n                renderMode: \"hybrid\",\r\n                format: new mapLibraries.ol.format.MVT(),\r\n                url:\r\n                    process.env.API_URL + \".slpy.com/v1/vector/\" +\r\n                    options[\"mapLanguage\"] +\r\n                    \"/{z}/{x}/{y}.pbf?key=\" +\r\n                    apiKey\r\n            }),\r\n            zIndex: 0\r\n        });\r\n    }\r\n}","import Map from 'ol/Map'\r\nimport View from 'ol/View'\r\nimport { defaults as olcondef, Control } from 'ol/control'\r\nimport { defaults as olintdef } from 'ol/interaction'\r\nimport { fromLonLat } from 'ol/proj'\r\nimport { VectorTile as vecLayer, Tile } from 'ol/layer'\r\nimport { VectorTile as vecSource, XYZ } from 'ol/source'\r\nimport { MVT } from 'ol/format'\r\nimport { boundingExtent, containsCoordinate } from 'ol/extent'\r\n\r\nexport function loadOpenLayers() {\r\n    let ol = {};\r\n    if (typeof window !== \"undefined\" && typeof window.ol !== \"undefined\") {\r\n        return window.ol;\r\n    } else {\r\n        try {\r\n            ol = {\r\n                Map,\r\n                control: { defaults: olcondef, Control },\r\n                extent: { boundingExtent, containsCoordinate },\r\n                interaction: { defaults: olintdef },\r\n                proj: { fromLonLat },\r\n                View,\r\n                layer: { VectorTile: vecLayer, Tile },\r\n                source: { VectorTile: vecSource, XYZ },\r\n                format: { MVT }\r\n            };\r\n        } catch (e) {\r\n            console.log(e);\r\n            console.log(\"Slpy JS: 'ol' could not be found. Make sure https://github.com/openlayers/openlayers  is installed and/or the script has been run before this function.\");\r\n        }\r\n    }\r\n    return ol;\r\n}","import { apply } from 'ol-mapbox-style'\r\n\r\nexport function loadOLMS() {\r\n    let olms = {};\r\n    if (typeof window !== \"undefined\" && typeof window.olms !== \"undefined\") {\r\n        return window.olms;\r\n    } else {\r\n        try {\r\n            olms = { apply };\r\n        } catch (e) {\r\n            console.log(e);\r\n            console.log(\"Slpy JS: 'olms' could not be found. Make sure https://github.com/openlayers/ol-mapbox-style  is installed and/or the script has been run before this function.\");\r\n        }\r\n    }\r\n    return olms;\r\n}","import generalFunctions from './index.js';\r\nimport { openlayersMap  } from './src/openlayersFunctions';\r\n\r\nconst slpy = {\r\n    openlayersMap,\r\n    ...generalFunctions\r\n  };\r\n\r\nexport {\r\n    slpy,\r\n    generalFunctions,\r\n    openlayersMap\r\n  };"],"names":["mapState","maplibreLoaded","openlayersLoaded","openlayersLoading","openlayersReady","undefined","mapStyleUrl","oldIE","aerialImageryOn","streetLevelOn","settings","openlayersFallback","rasterFallback","mapFilter","apiKey","language","openlayersParts","view","controls","interactions","mapLibraries","ol","olms","maplibregl","addAutocomplete","targetInput","autoOptions","onInputChange","inputField","document","getElementById","nodeName","toLowerCase","console","log","autoCountry","autoKey","dropdownWidth","offsetWidth","offsetLeft","offsetTop","autoCompleteType","autoFilter","resultsLimit","parseInt","debounceTime","listContainer","createElement","className","id","appendChild","body","updateListContainerPosition","event","containerPosition","parentNode","getBoundingClientRect","inputFieldRectStart","inputFieldRect","left","top","height","viewportHeight","window","visualViewport","innerHeight","type","style","position","pageXOffset","pageYOffset","width","maxHeight","Math","max","lastSelect","lastSearch","addEvent","element","handler","useCapture","addEventListener","attachEvent","removeEvent","eventType","eventHandler","removeEventListener","detachEvent","e","keyCode","preventDefault","getElementsByClassName","focus","classList","remove","setTimeout","currentRequest","makeRequest","url","callback","abort","xhr","method","XMLHttpRequest","open","XDomainRequest","createCORSRequest","onreadystatechange","readyState","status","obj","JSON","parse","responseText","send","resultsObj","updateGlobalObj","func","timeout","timer","debouncedInput","query","value","length","encodeURIComponent","processDropdown","Object","keys","hasResults","innerHTML","forEach","key","ele","objIcon","quality","indexOf","replace","setAttribute","poweredByLabel","contains","add","scrollAmount","rect","windowHeight","documentElement","clientHeight","bottom","elementHeight","visibleHeight","scrollToHeight","scrollBy","scrollIfNeeded","response","obj1Length","filter","isNaN","String","prototype","hasOwnProperty","call","newKey","clearTimeout","args","Array","slice","arguments","apply","this","bind","dragging","handleClickOutside","target","currentTarget","getAttribute","handleDropdownItemClick","dropdownItem","elem","selector","matches","msMatchesSelector","getClosest","activeElement","txt","textContent","trim","selectedObj","handlerDropdownItemClick","updateAutocomplete","newOptions","isVectorSupported","myNav","navigator","userAgent","split","getContext","i","checkCanvasContextLimit","loadScript","script","src","head","toRad","x","PI","distanceInKM","lat1","lon1","lat2","lon2","dLon","acos","sin","cos","markerVectorSource","markerVectorLayer","markerOverlay","hasPopupInfo","createMarker","lonLat","name","markerFeature","Feature","geometry","geom","Point","proj","fromLonLat","icon","btoa","iconSolid","setId","markerStyle","Style","image","Icon","opacity","color","anchor","anchorXUnits","anchorYUnits","imgSize","documentMode","setStyle","markerTextStyle","text","Text","toString","fill","Fill","stroke","Stroke","offsetY","textBaseline","textAlign","font","markerTextFeature","waitForMapillary","mpyKey","map","mapillary","addMapillary","onMapillaryChange","change","evt","createEvent","state","initEvent","dispatchEvent","MapillaryKey","ua","mplycss","href","rel","mlyContainer","maptarContainer","getTargetElement","getContainer","newDiv","insertBefore","mlyDiv","streetLevelIcon","scale","updateBearingStyle","bearing","rotation","photoDot","Circle","radius","photoDotAerial","mapillarySource","layer","VectorTile","source","format","MVT","tileGrid","tilegrid","createXYZ","maxZoom","tilePixelRatio","minZoom","streetLevelButton","control","Control","constructor","opt_options","options","SLbutton","cssText","super","handleStreetLevel","getView","getZoom","alert","mpjscanvas","mpjsdom","getMap","removeLayer","movingPointLayer","display","updateSize","setVisible","centerCurrent","toLonLat","getCenter","bboxCurrent","transformExtent","calculateExtent","getSize","maptarParent","xmlhttp","myArr","data","addLayer","mly","moveTo","reason","featureOverlay","compass_angle","getVisible","animate","zoom","duration","offsetHeight","resize","addControl","pointFeature","center","highlight","Vector","features","visible","Viewer","accessToken","component","cover","container","on","originalLngLat","lng","lat","setCenter","getGeometry","setCoordinates","compassAngle","pixel","isClick","feature","forEachFeatureAtPixel","layerFilter","hitTolerance","get","getSource","removeFeature","err","addFeature","displayFeatureInfo","StreetLevelControl","streetLevel","toArray","getBounds","streetLevelLoad","addSource","streetLevelIconSource","cirOpac","minzoom","maxzoom","paint","layout","zoomTo","coordinates","properties","tiles","onAdd","_map","_container","SLicon","onRemove","removeChild","lngLat","setData","flyTo","queryRenderedFeatures","point","layers","fkey","generalFunctions","addressAutocomplete","formTarget","tagName","inputFields","querySelectorAll","formParts","autoCompleteAttr","autoSection","lastSpaceIndex","lastIndexOf","returnUpdates","autoSectionKey","returnUpdate","returnInput","selectedItem","autoSectionEle","push","addAerialImagery","aerialImageryLoad","AIbbox","isInAerialArea","curmapaiz","inSatArea","bbarea","curmapcentr","BBX","extent","boundingExtent","containsCoordinate","satelliteSource","Tile","XYZ","zindex","satelliteSourceRaster","AIbutton","AIicon","AerialImageryControl","backgroundImage","getLayers","refresh","insertAt","showingAerialButton","AerialButton","click","isInAerialAreaMb","LngLatBounds","originalStyle","AerialImagery","slicosour","mimgsour","mimglay","getLayer","slilay","aerialImagerySource","getStyle","setPaintProperty","setLayoutProperty","scheme","tileSize","addMarkers","markers","markerFeatures","once","popupe","content","closer","Overlay","autoPan","autoPanAnimation","addOverlay","onclick","setPosition","blur","getId","markerIndex","iconStyle","falayers","Marker","offset","setLngLat","setPopup","Popup","setHTML","addTo","falayertext","highlightMarker","featureToHighlight","getFeatureById","featureImage","getImage","iconImage_","color_","setZIndex","hmarker","parentElement","zIndex","dehighlightMarker","removeMarker","featureToClose","hpopup","querySelector","setMarkerOpen","quickMarkersCenter","latAr","lonAr","num_coords","Number","distance","min","isWebGL2Supported","canvas","WebGL2RenderingContext","setInteractionOnFocus","div","mapob","mapDivEl","tabIndex","insertAdjacentHTML","mapDivNotice","getInteractions","interaction","DragPan","MouseWheelZoom","setActive","handleMapTouch","disable","enable","setTransform","transform","urlParts","baseUrl","params","newParams","join","startPoint","destination","lon","currentZoom","done","parts","called","getcenter","values","topZoom","complete","boundingbox","bbox","fitBounds","padding","right","flyOpt","maxDuration","distanceInMI","openlayersMap","Map","defaults","olcondef","olintdef","View","vecLayer","vecSource","loadOpenLayers","olDefaults","rotate","rotateOptions","autoHide","zoomOptions","zoomDuration","attribution","attributionOptions","collapsible","pinchRotate","mapType","startZoom","loadOLMS","showRaster","tilePixelRatioS","attributions","declutter","renderMode","slpy"],"mappings":"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"}