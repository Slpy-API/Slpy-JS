import e from"maplibre-gl";let t={maplibreLoaded:!1,openlayersLoaded:!1,openlayersLoading:!1,openlayersReady:void 0,mapStyleUrl:"https://api.slpy.com/style/slpy-mgl-style.json",oldIE:!1,aerialImageryOn:!1,streetLevelOn:!1},o={openlayersFallback:!1,rasterFallback:!1,mapFilter:[],apiKey:"",language:"en"},a={ol:void 0,olms:void 0,maplibregl:void 0};function n(e,t,a){if("string"==typeof e)var n=document.getElementById(e);else if(!e||"input"!==e.nodeName.toLowerCase()&&"textarea"!==e.nodeName.toLowerCase())console.log("Target input for autocomplete is not a valid element or id");else n=e;a=void 0===a?"":a;var i="US";void 0!==t.country&&(i=t.country.toLowerCase());var r="";void 0!==t.apiKey&&(r=t.apiKey.toLowerCase());var l=n.offsetWidth-6+"px";void 0!==t.width&&(l=t.width);var s=3;void 0!==t.offsetLeft&&(s=t.offsetLeft);var c=3;void 0!==t.offsetTop&&(c=t.offsetTop);var d="all";void 0!==t.autocompleteType&&(d=t.autocompleteType.toLowerCase());var m="";void 0!==t.filter&&(m="&filter="+t.filter.toLowerCase()),void 0!==t.language&&(o.language=t.language.toLowerCase());var p=10;void 0!==t.limit&&(t.limit=parseInt(t.limit),t.limit<10&&t.limit>0?p=t.limit:console.log("Autocomplete limit is outside of 1-10 range."));var y=175;void 0!==t.debounceTime&&(t.debounceTime=parseInt(t.debounceTime),t.debounceTime<1e3&&t.debounceTime>0?y=t.debounceTime:console.log("Autocomplete debounceTime is outside of 1-1000 range."));var u=document.createElement("div");u.className="apiautodropdown-content",u.id="apiautodropdownContent "+n.id;void 0!==t.insertId?document.getElementById(t.insertId).appendChild(u):document.body.appendChild(u);function g(e){var o=n.parentNode.getBoundingClientRect(),a=n.getBoundingClientRect();if(void 0!==t.insertId)var i={left:a.left-o.left,top:a.top-o.top,height:a.height};else i=n.getBoundingClientRect();var r=window.visualViewport?window.visualViewport.height:window.innerHeight;if(e&&"resize"!==e.type||(u.style.position="absolute",u.style.left=i.left+s+window.pageXOffset+"px",u.style.top=i.top+i.height+window.pageYOffset+c+"px",u.style.width=l),!e||"scroll"===e.type){var d=Math.max(165,r-a.top-i.height-c-5);u.style.maxHeight=d+"px"}}var h=0,v="";function f(e,t,o,a){e.addEventListener?e.addEventListener(t,o,a):e.attachEvent&&e.attachEvent("on"+t,o)}function w(e,t,o,a){e.removeEventListener?e.removeEventListener(t,o,a):e.detachEvent&&e.detachEvent("on"+t,o)}f(n,"keydown",(function(e){h=0,40===e.keyCode||9==e.keyCode?(e.preventDefault(),u.getElementsByClassName("apiautodropdown-item")[0].focus()):13==e.keyCode&&(u.classList.remove("apiautodropdown-content-show"),w(window,"resize",g,!1),w(window,"scroll",g,!1))}),!1),f(u,"keydown",(function(e){40!==e.keyCode&&9!=e.keyCode||(e.preventDefault(),void 0!==u.getElementsByClassName("apiautodropdown-item")[h+1]&&(h++,u.getElementsByClassName("apiautodropdown-item")[h].focus())),38===e.keyCode&&(e.preventDefault(),h>0?h--:setTimeout((function(){n.focus()}),10),u.getElementsByClassName("apiautodropdown-item")[h].focus())}),!1);var b=null;function L(e,t){b&&b.abort();var o=function(e,t){var o=new XMLHttpRequest;return"withCredentials"in o?o.open(e,t,!0):"undefined"!=typeof XDomainRequest?(o=new XDomainRequest).open(e,t):o=null,o}("POST",e);o.onreadystatechange=function(){if(4===o.readyState){if(200===o.status){var e=JSON.parse(o.responseText);t(e)}else{console.log("Slpy Api: There was a problem with the request. Make sure the API Key is set correctly and the origin/referer request header matches your whitelisted domains.");e=JSON.parse(o.responseText);t(e)}b=null}},b=o,o.send()}var x={};function k(e){x=e}var I,C,z,P=(I=function(e){if(13!==e.keyCode){if(9!==e.keyCode){var t=n.value.toLowerCase();if(t.length>1){if((t=encodeURIComponent(t))!==v+" "&&t!==v){var a=function(e){if(Object.keys(e).length>0){var t=!1;if(void 0!==e[0]&&void 0!==e[0].focus&&(t=!0,u.innerHTML=""),Object.keys(e).forEach((function(t){if(void 0!==e[t]&&void 0!==e[t].focus&&t<p){var o=document.createElement("button");o.className="apiautodropdown-item",o.type="button";var a='<svg xmlns="http://www.w3.org/2000/svg" class="apiautodropdown-icon" width="17px" height="13px" viewBox="0 0 448 512">\x3c!-- Font Awesome Pro 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) --\x3e';switch(e[t].quality){case 6:a+='<path d="M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z"/></svg>';break;case 5:a+='<path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>';break;case 4:a+='<path d="M616 192H480V24c0-13.26-10.74-24-24-24H312c-13.26 0-24 10.74-24 24v72h-64V16c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v80h-64V16c0-8.84-7.16-16-16-16H80c-8.84 0-16 7.16-16 16v80H24c-13.26 0-24 10.74-24 24v360c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V216c0-13.26-10.75-24-24-24zM128 404c0 6.63-5.37 12-12 12H76c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12H76c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12H76c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm128 192c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm160 96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12V76c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm160 288c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40z"/></svg>';break;case 3:a+='<path d="M256 336h-.02c0-16.18 1.34-8.73-85.05-181.51-17.65-35.29-68.19-35.36-85.87 0C-2.06 328.75.02 320.33.02 336H0c0 44.18 57.31 80 128 80s128-35.82 128-80zM128 176l72 144H56l72-144zm511.98 160c0-16.18 1.34-8.73-85.05-181.51-17.65-35.29-68.19-35.36-85.87 0-87.12 174.26-85.04 165.84-85.04 181.51H384c0 44.18 57.31 80 128 80s128-35.82 128-80h-.02zM440 320l72-144 72 144H440zm88 128H352V153.25c23.51-10.29 41.16-31.48 46.39-57.25H528c8.84 0 16-7.16 16-16V48c0-8.84-7.16-16-16-16H383.64C369.04 12.68 346.09 0 320 0s-49.04 12.68-63.64 32H112c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h129.61c5.23 25.76 22.87 46.96 46.39 57.25V448H112c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h416c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"/></svg>';break;case 2:a+='<path d="M496 128v16a8 8 0 0 1-8 8h-24v12c0 6.627-5.373 12-12 12H60c-6.627 0-12-5.373-12-12v-12H24a8 8 0 0 1-8-8v-16a8 8 0 0 1 4.941-7.392l232-88a7.996 7.996 0 0 1 6.118 0l232 88A8 8 0 0 1 496 128zm-24 304H40c-13.255 0-24 10.745-24 24v16a8 8 0 0 0 8 8h464a8 8 0 0 0 8-8v-16c0-13.255-10.745-24-24-24zM96 192v192H60c-6.627 0-12 5.373-12 12v20h416v-20c0-6.627-5.373-12-12-12h-36V192h-64v192h-64V192h-64v192h-64V192H96z"/></svg>';break;case 1:a+='<path d="M248 8C111.03 8 0 119.03 0 256s111.03 248 248 248 248-111.03 248-248S384.97 8 248 8zm82.29 357.6c-3.9 3.88-7.99 7.95-11.31 11.28-2.99 3-5.1 6.7-6.17 10.71-1.51 5.66-2.73 11.38-4.77 16.87l-17.39 46.85c-13.76 3-28 4.69-42.65 4.69v-27.38c1.69-12.62-7.64-36.26-22.63-51.25-6-6-9.37-14.14-9.37-22.63v-32.01c0-11.64-6.27-22.34-16.46-27.97-14.37-7.95-34.81-19.06-48.81-26.11-11.48-5.78-22.1-13.14-31.65-21.75l-.8-.72a114.792 114.792 0 0 1-18.06-20.74c-9.38-13.77-24.66-36.42-34.59-51.14 20.47-45.5 57.36-82.04 103.2-101.89l24.01 12.01C203.48 89.74 216 82.01 216 70.11v-11.3c7.99-1.29 16.12-2.11 24.39-2.42l28.3 28.3c6.25 6.25 6.25 16.38 0 22.63L264 112l-10.34 10.34c-3.12 3.12-3.12 8.19 0 11.31l4.69 4.69c3.12 3.12 3.12 8.19 0 11.31l-8 8a8.008 8.008 0 0 1-5.66 2.34h-8.99c-2.08 0-4.08.81-5.58 2.27l-9.92 9.65a8.008 8.008 0 0 0-1.58 9.31l15.59 31.19c2.66 5.32-1.21 11.58-7.15 11.58h-5.64c-1.93 0-3.79-.7-5.24-1.96l-9.28-8.06a16.017 16.017 0 0 0-15.55-3.1l-31.17 10.39a11.95 11.95 0 0 0-8.17 11.34c0 4.53 2.56 8.66 6.61 10.69l11.08 5.54c9.41 4.71 19.79 7.16 30.31 7.16s22.59 27.29 32 32h66.75c8.49 0 16.62 3.37 22.63 9.37l13.69 13.69a30.503 30.503 0 0 1 8.93 21.57 46.536 46.536 0 0 1-13.72 32.98zM417 274.25c-5.79-1.45-10.84-5-14.15-9.97l-17.98-26.97a23.97 23.97 0 0 1 0-26.62l19.59-29.38c2.32-3.47 5.5-6.29 9.24-8.15l12.98-6.49C440.2 193.59 448 223.87 448 256c0 8.67-.74 17.16-1.82 25.54L417 274.25z"/></svg>';break;default:a+='<path d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"/></svg>'}e[t].focus.indexOf(",")>-1?o.innerHTML=a+'<div class="apiautodropdown-text">'+e[t].focus.replace(",",'<span class="apiautodropdown-muted">,')+"</span></div>":o.innerHTML=a+'<div class="apiautodropdown-text">'+e[t].focus+"</div>",o.setAttribute("autocompleteID",t),u.appendChild(o)}})),t){var o=document.createElement("div");u.appendChild(o),o.innerHTML='<a href="https://www.slpy.com" style="color:#888f94; text-decoration:none;">powered by <span style="color:#5e849f;font-size:13px">Slpy</a>',o.setAttribute("style","line-height:13px; font-size: 12px; padding:2px 10px 0px 0px; margin: 0px; text-align:right"),u.classList.contains("apiautodropdown-content-show")||(u.classList.add("apiautodropdown-content-show"),g(),f(window,"resize",g,!1),f(window,"scroll",g,!1),function(e){var t,o=e.getBoundingClientRect(),a=window.innerHeight||document.documentElement.clientHeight;if(o.bottom>a){var n=o.height,i=a-o.top,r=n<165?n:165;i<r&&(t=r-i,window.scrollBy(0,t))}}(u))}}else u.classList.contains("apiautodropdown-content-show")&&(u.classList.remove("apiautodropdown-content-show"),w(window,"resize",g,!1),w(window,"scroll",g,!1))};v=t,h=0,"all"==d?L("https://api.slpy.com/v1/search?autocomplete=admin"+m+"&country="+i+"&key="+r+"&language="+o.language+"&search="+t,(function(e){Object.keys(e).length<p?L("https://api.slpy.com/v1/search?autocomplete=address&country="+i+"&key="+r+"&language="+o.language+"&search="+t,(function(t){if(void 0===e[0]||void 0===e[0].focus||""===e[0].focus)e=t;else if(void 0!==t[0].focus&&""!==t[0].focus){var o=Object.keys(e).filter((function(e){return!isNaN(parseInt(e,p))&&e===String(parseInt(e,p))})).length;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=parseInt(n,p)+o;if(!(i<p))break;e[i]=t[n]}}a(e),k(e)})):(a(e),k(e))})):L("admin"==d?"https://api.slpy.com/v1/search?autocomplete=admin"+m+"&country="+i+"&key="+r+"&language="+o.language+"&search="+t:"https://api.slpy.com/v1/search?autocomplete=address&country="+i+"&key="+r+"&language="+o.language+"&search="+t,(function(e){a(e),k(e)}))}}else u.classList.contains("apiautodropdown-content-show")&&(u.classList.remove("apiautodropdown-content-show"),w(window,"resize",g,!1),w(window,"scroll",g,!1))}}else u.classList.contains("apiautodropdown-content-show")&&u.classList.remove("apiautodropdown-content-show")},void 0===(C=y)&&(C=175),function(){clearTimeout(z);var e=Array.prototype.slice.call(arguments);z=setTimeout(function(){I.apply(this,e)}.bind(this),C)});f(n,"input",P,!1);var S=!1;function M(e){u.contains(e.target)||e.target===n||(u.classList.remove("apiautodropdown-content-show"),w(window,"resize",g,!1),w(window,"scroll",g,!1))}f(u,"touchstart",(function(e){e.currentTarget.getAttribute("id")=="apiautodropdownContent "+n.id&&(S=!1)}),!1),f(u,"touchmove",(function(e){e.currentTarget.getAttribute("id")=="apiautodropdownContent "+n.id&&(S=!0)}),!1),f(document,"click",M,!0),f(document,"touchend",M,!0);var E=function(e,t){return function(o){var i=function(e,t){for(;e&&e!==document;e=e.parentNode)if(e.matches?e.matches(t):e.msMatchesSelector(t))return e;return null}(o.target,".apiautodropdown-item");if(i){if(o.preventDefault(),S)return;document.activeElement!==i&&i.focus();var r=i.textContent.trim();v=r.toLowerCase(),e.value=r,t.classList.remove("apiautodropdown-content-show"),w(window,"resize",g,!1),w(window,"scroll",g,!1);var l=i.getAttribute("autocompleteID");"function"==typeof a&&a(n,x[l])}else o.target.getAttribute("id")!=e.id&&(t.classList.remove("apiautodropdown-content-show"),w(window,"resize",g,!1),w(window,"scroll",g,!1))}}(n,u);return f(u,"click",E,!0),f(u,"touchend",E,!0),{updateAutocomplete:function(e){void 0!==e.country&&(i=e.country.toLowerCase()),void 0!==e.autocomplete&&(d=e.autocomplete.toLowerCase()),void 0!==e.filter&&(m="&filter="+e.filter.toLowerCase()),w(n,"input",P,!1),f(n,"input",P,!1)}}}function i(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2")&&!e.getContext("experimental-webgl2"))}catch(e){return!1}}function r(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,document.head.appendChild(t)}function l(e){return e*Math.PI/180}function s(e,t,o,a){var n=l(a-t);e=l(e),o=l(o);return 6371*Math.acos(Math.sin(e)*Math.sin(o)+Math.cos(e)*Math.cos(o)*Math.cos(n))}let c,d,m,p=!1;function y(e,t,o,n){var i=new a.ol.Feature({geometry:new a.ol.geom.Point(a.ol.proj.fromLonLat(e)),name:t}),r=window.btoa('<svg xmlns="http://www.w3.org/2000/svg" style="fill: #fff;display:box;stroke:#fff;stroke-width:15px;filter: drop-shadow(1px 2px 1px rgba(0,0,0,0.4));" width="27px" height="36px" viewBox="0 0 384 512">\x3c!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e<path d="M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/></svg>'),l=window.btoa('<svg xmlns="http://www.w3.org/2000/svg" style="fill: #fff; display:box;stroke:#fff;stroke-width:15px;filter: drop-shadow(1px 2px 1px rgba(0,0,0,0.4));" width="27px" height="36px" viewBox="0 0 384 512">\x3c!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e<path d="M384 192c0 87.4-117 243-168.3 307.2c-12.3 15.3-35.1 15.3-47.4 0C117 435 0 279.4 0 192C0 86 86 0 192 0S384 86 384 192z"/></svg>');if(i.setId("marker:"+o),"default"==n){var s=new a.ol.style.Style({image:new a.ol.style.Icon({opacity:1,color:"#a11c25",anchor:[.5,36],anchorXUnits:"fraction",anchorYUnits:"pixels",src:"data:image/svg+xml;base64,"+r,imgSize:window.document.documentMode?[27,36]:null})});return i.setStyle(s),i}s=new a.ol.style.Style({image:new a.ol.style.Icon({opacity:1,color:"#a11c25",anchor:[.5,36],anchorXUnits:"fraction",anchorYUnits:"pixels",src:"data:image/svg+xml;base64,"+l,imgSize:window.document.documentMode?[27,36]:null})});var c=new a.ol.style.Style({text:new a.ol.style.Text({text:(o+1).toString(),fill:new a.ol.style.Fill({color:"#fff"}),stroke:new a.ol.style.Stroke({color:"rgba(0,0,0,0.1)",width:1.5}),offsetY:-10,textBaseline:"bottom",textAlign:"center",font:'Normal 700 12px "Open Sans", "Arial", "Verdana", "sans-serif"'})}),d=new a.ol.Feature({geometry:new a.ol.geom.Point(a.ol.proj.fromLonLat(e)),name:t});return d.setStyle(c),i.setStyle(s),[i,d]}function u(e,t){"undefined"==typeof mapillary?setTimeout((function(){u(e,t)}),100):h(e,t)}function g(e){var t=document.createEvent("Event");t.state=e,t.initEvent("StreetLevel",!0,!1),window.dispatchEvent(t)}function h(e,o){var n=window.navigator.userAgent;if(n.indexOf("MSIE ")>0)g("failed load");else if(n.indexOf("Trident/")>0&&void 0===a.ol)g("failed load");else{if("undefined"==typeof mapillary){var i=document.createElement("link");i.href="https://unpkg.com/mapillary-js@4.1.1/dist/mapillary.css",i.rel="stylesheet",document.head.appendChild(i),r("https://unpkg.com/mapillary-js@4.1.1/dist/mapillary.js"),u(e,o)}var l=document.getElementById("mly"),c=void 0;if(c=void 0!==a.ol?o.getTargetElement():o.getContainer(),!l){var d=document.createElement("div");d.id="map-mapillary",c.parentNode.insertBefore(d,c),d.appendChild(c);var m=document.createElement("div");m.id="mly",d.appendChild(m)}if("undefined"!=typeof mapillary)if(void 0!==a.ol){g("loaded");var p=new a.ol.style.Style({text:new a.ol.style.Text({text:"",scale:1,font:'Normal 900 18px "Font Awesome 5 Free"',fill:new a.ol.style.Fill({color:"#a11d26"}),stroke:new a.ol.style.Stroke({color:"white",width:3})})}),y=function(e){return[new a.ol.style.Style({text:new a.ol.style.Text({text:"",scale:1,font:'Normal 900 18px "Font Awesome 5 Free"',textBaseline:"middle",textAlign:"center",rotation:e*Math.PI/180-45,fill:new a.ol.style.Fill({color:"#a11d26"}),stroke:new a.ol.style.Stroke({color:"white",width:3})})})]},h=new a.ol.style.Style({image:new a.ol.style.Circle({fill:new a.ol.style.Fill({color:"rgba(53, 175, 109,0.2)"}),radius:4})}),v=new a.ol.style.Style({image:new a.ol.style.Circle({fill:new a.ol.style.Fill({color:"rgba(53, 175, 109,0.5)"}),radius:4})}),f=new a.ol.layer.VectorTile({source:new a.ol.source.VectorTile({format:new a.ol.format.MVT,tileGrid:a.ol.tilegrid.createXYZ({maxZoom:14}),tilePixelRatio:16,maxZoom:14,url:"https://tiles.mapillary.com/maps/vtp/mly1_public/2/{z}/{x}/{y}?access_token="+e}),style:h,minZoom:14});class n extends a.ol.control.Control{constructor(e){var t=e||{},o=document.createElement("button");o.style.cssText='font: 900 1.14em "Font Awesome 5 Free"',o.innerHTML="";var a=document.createElement("div");a.className="ol-control",a.style.cssText="bottom: 55px; right: 8px; margin-bottom: 50px",a.appendChild(o),super({element:a,target:t.target}),o.addEventListener("click",this.handleStreetLevel.bind(this),!1)}handleStreetLevel(){if(o.getView().getZoom()<12&&!t.streetLevelOn)alert("Zoom in to get Street Level Imagery");else{var n=document.getElementsByClassName("mapillary-js-canvas")[0],i=document.getElementsByClassName("mapillary-js-dom")[0];if(t.streetLevelOn)f.setStyle(h),this.getMap().removeLayer(f),this.getMap().removeLayer(L),l.style.display="none",c.style.height="100%",c.style.width="100%",o.updateSize(),L.setVisible(!1),void 0!==n&&(n.style.display="none"),void 0!==i&&(i.style.display="none"),g("closed"),t.streetLevelOn=!1;else{var r=a.ol.proj.toLonLat(o.getView().getCenter()),d=a.ol.proj.transformExtent(o.getView().calculateExtent(o.getSize()),"EPSG:900913","EPSG:4326");s(d[0],d[1],d[2],d[3]);var m=c.parentNode,p=new XMLHttpRequest;p.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText);void 0!==e.data[0]?(g("active"),o.addLayer(f),o.addLayer(L),void 0!==t.aerialImageryOn&&t.aerialImageryOn&&f.setStyle(v),t.streetLevelOn=!0,k.moveTo(e.data[0].id).catch((function(e){console.log("Mapillary missing image")})),x.setStyle(y(e.data[0].compass_angle)),L.getVisible()||L.setVisible(!0),o.getView().getZoom()<18.5&&o.getView().animate({zoom:18.5,duration:250}),n=document.getElementsByClassName("mapillary-js-canvas")[0],i=document.getElementsByClassName("mapillary-js-dom")[0],void 0!==n&&(n.style.display="initial"),void 0!==i&&(i.style.display="initial")):(g("closed"),l.style.display="none",c.style.width="100%",c.style.height="100%",o.updateSize(),void 0!==n&&(n.style.display="none"),void 0!==i&&(i.style.display="none"),o.getView().getZoom()<=15?alert("No street level images available here.  Try zooming in."):alert("No street level images available here."))}else 4==this.readyState&&(g("closed"),l.style.display="none",c.style.width="100%",c.style.height="100%",o.updateSize(),void 0!==n&&(n.style.display="none"),void 0!==i&&(i.style.display="none"),console.log("Could not connect to Mapillary"))},g("opened"),l.style.display="block",m.offsetHeight>m.offsetWidth?(c.style.height="35%",c.style.width="100%",l.style.width="100%",l.style.height="65%"):(c.style.width="35%",c.style.height="100%",l.style.height="100%",l.style.width="65%"),k.resize(),o.updateSize(),p.open("GET","https://graph.mapillary.com/images?access_token="+e+"&fields=image_key,compass_angle&limit=1&closeto="+r.toString()+"&bbox="+d.toString(),!0),p.send()}}}}o.addControl(new n);var w=new a.ol.Feature({geometry:new a.ol.geom.Point(ol.proj.fromLonLat(center))});w.setStyle([p]);var b,L=new a.ol.layer.Vector({source:new a.ol.source.Vector({features:[w]}),visible:!1}),x=new a.ol.layer.Vector({source:new a.ol.source.Vector,map:o,style:[p]}),k=new mapillary.Viewer({accessToken:e,component:{cover:!1},container:"mly"});k.on("image",(function(e){x.getVisible()&&x.setVisible(!1);var t=a.ol.proj.fromLonLat([e.image.originalLngLat.lng,e.image.originalLngLat.lat]);o.getView().setCenter(t),w.getGeometry().setCoordinates(t),w.setStyle(y(e.image.compassAngle))})),o.on("click",(function(e){!function(e,t){var a=o.forEachFeatureAtPixel(e,(function(e,t){return e}),{layerFilter:function(e){return e===f},hitTolerance:5});if(a){if(t){var n=a.get("compassAngle");if(k.moveTo(a.get("id")).catch((function(e){console.log("Mapillary missing image")})),x.setStyle(y(n)),!L.getVisible()){l.style.display="block";var i=c.parentNode;i.offsetHeight>i.offsetWidth?(c.style.height="35%",c.style.width="100%",l.style.width="100%",l.style.height="65%"):(c.style.width="35%",c.style.height="100%",l.style.height="100%",l.style.width="65%"),k.resize(),o.updateSize(),L.setVisible(!0)}}if(a!==b){if(b&&void 0!==b)try{x.getSource().removeFeature(b)}catch(e){}if(a&&void 0!==a)try{x.getSource().addFeature(a)}catch(e){}b=a}}}(e.pixel,!0)})),window.addEventListener("resize",(function(){if(t.streetLevelOn){var e=c.parentNode;e.offsetHeight>e.offsetWidth?(c.style.height="35%",c.style.width="100%",l.style.width="100%",l.style.height="65%"):(c.style.width="35%",c.style.height="100%",l.style.height="100%",l.style.width="65%"),k.resize(),o.updateSize()}}))}else{var I=function(){},C=function(){if(o.getZoom()<12&&!t.streetLevelOn)alert("Zoom in to get Street Level Imagery");else{var a=document.getElementsByClassName("mapillary-js-canvas")[0],n=document.getElementsByClassName("mapillary-js-dom")[0];if(t.streetLevelOn)o.removeLayer("mimgLayer"),o.removeLayer("streetLevelIcon"),l.style.display="none",c.style.height="100%",c.style.width="100%",o.resize(),void 0!==a&&(a.style.display="none"),void 0!==n&&(n.style.display="none"),g("closed"),t.streetLevelOn=!1;else{var i=o.getCenter().toArray(),r=o.getBounds().toArray();s(r[0][0],r[0][1],r[1][0],r[1][1]);var d=new XMLHttpRequest;P&&(o.addSource("mimgLayer",f),o.addSource("streetLevelIcon",z),P=!1),d.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText);if(void 0!==e.data[0]){var i="0.2";void 0!==t.aerialImageryOn&&t.aerialImageryOn&&(i="0.5"),o.addLayer({id:"mimgLayer",type:"circle",source:"mimgLayer","source-layer":"image",minzoom:14,maxzoom:22,paint:{"circle-color":"rgba(53, 175, 109,"+i+")"}}),o.addLayer({id:"streetLevelIcon",type:"symbol",source:"streetLevelIcon",paint:{"text-color":"#a11d26","text-halo-color":"#fff","text-halo-width":2.25,"text-translate":[0,0]},layout:{"text-field":"","text-size":20,"text-font":["fasolid-900"],"text-rotate":["get","bearing"],"text-anchor":"center","text-offset":[0,0]}}),t.streetLevelOn=!0,g("active"),k.moveTo(e.data[0].id).catch((function(e){console.log("Mapillary missing image")})),o.getZoom()<17.5&&o.zoomTo(17.5),a=document.getElementsByClassName("mapillary-js-canvas")[0],n=document.getElementsByClassName("mapillary-js-dom")[0],void 0!==a&&(a.style.display="initial"),void 0!==n&&(n.style.display="initial")}else l.style.display="none",c.style.height="100%",c.style.width="100%",o.resize(),void 0!==a&&(a.style.display="none"),void 0!==n&&(n.style.display="none"),g("closed"),o.getZoom()<=15?alert("No street level images available here.  Try zooming in."):alert("No street level images available here.")}else 4==this.readyState&&(l.style.display="none",c.style.height="100%",c.style.width="100%",o.resize(),void 0!==a&&(a.style.display="none"),void 0!==n&&(n.style.display="none"),g("closed"))},l.style.display="block";var m=c.parentNode;m.offsetHeight>m.offsetWidth?(c.style.height="35%",c.style.width="100%",l.style.width="100%",l.style.height="65%"):(c.style.width="35%",c.style.height="100%",l.style.height="100%",l.style.width="65%"),k.resize(),o.resize(),g("opened"),d.open("GET","https://graph.mapillary.com/images?access_token="+e+"&fields=image_key&limit=1&closeto="+i[0]+","+i[1]+"&bbox="+r[0][0]+","+r[0][1]+","+r[1][0]+","+r[1][1],!0),d.send()}}};g("loaded");var z={type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[0,0]},properties:{bearing:90}}};f={type:"vector",tiles:["https://tiles.mapillary.com/maps/vtp/mly1_public/2/{z}/{x}/{y}?access_token="+e],minzoom:14,maxzoom:14};I.prototype.onAdd=function(e){this._map=e,this._container=document.createElement("div"),this._container.className="maplibregl-ctrl maplibregl-ctrl-group",this._container.style.cssText="pointer-events: auto;";var t=document.createElement("button");t.setAttribute("id","streetLevButton"),t.addEventListener("click",C),this._container.appendChild(t);var o=document.createElement("span");return o.style.cssText='background-image: url("https://api.slpy.com/symbols/walking-solid.svg");background-size: 1em;',o.className="maplibregl-ctrl-icon",t.appendChild(o),this._container},I.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map=void 0},I=new I,o.addControl(I,"bottom-right"),t.streetLevelOn=!1;var P=!0;(k=new mapillary.Viewer({accessToken:e,component:{cover:!1},container:"mly"})).on("image",(function(e){var t=[e.image.originalLngLat.lng,e.image.originalLngLat.lat],a={type:"Feature",geometry:{type:"Point",coordinates:t},properties:{bearing:e.image.compassAngle-45}};o.getSource("streetLevelIcon").setData(a),o.flyTo({center:t})})),o.on("click",(function(e){if(void 0!==t.streetLevelOn&&t.streetLevelOn){var a=o.queryRenderedFeatures(e.point,{layers:["mimgLayer"]});if(void 0!==a[0]){var n=a[0].properties.id;k.moveTo(n).catch((function(e){console.log("Mapillary missing image")}))}}})),window.addEventListener("resize",(function(){if(t.streetLevelOn){var e=c.parentNode;e.offsetHeight>e.offsetWidth?(c.style.height="35%",c.style.width="100%",l.style.width="100%",l.style.height="65%"):(c.style.width="35%",c.style.height="100%",l.style.height="100%",l.style.width="65%"),k.resize(),o.resize()}}))}}}var v={addressAutocomplete:function(e,t){if("string"==typeof e)var o=document.getElementById(e);else if(!e||"form"!==target.nodeName.toLowerCase()&&"textarea"!==e.nodeName.toLowerCase())console.log("Target form for address autocomplete is not a valid Form element or id.");else o=e;if(t.autocompleteType="address","form"===o.tagName.toLowerCase()){for(var a=o.querySelectorAll("input[autocomplete], textarea[autocomplete]"),i={},r=0;r<a.length;r++){var l=a[r].getAttribute("autocomplete");if(l){var s="0";if(void 0!==l.split(" ")[1]){var c=l.lastIndexOf(" ");s=l.slice(0,c),l=l.slice(c+1),void 0===i[s]&&(i[s]={})}switch(l){case"street-address":case"address-line1":i[s]["street-line"]=a[r];break;case"address-level1":i[s]["address-level1"]=a[r];break;case"address-level2":i[s]["address-level2"]=a[r];break;case"address-level3":i[s]["address-level3"]=a[r];break;case"address-level4":i[s]["address-level4"]=a[r];break;case"postal-code":i[s]["postal-code"]=a[r];break;case"country":i[s].country=a[r];break;case"country-name":i[s]["country-name"]=a[r]}}}var d=[];for(var m in i)i.hasOwnProperty(m)&&(void 0!==i[m]["street-line"]?(void 0!==i[m]["street-line"].id&&""!=i[m]["street-line"].id||(i[m]["street-line"].id="StAuto-"+m),function(e,o){var a=n(o[e]["street-line"].id,t,(function(t,a){for(var n in t.value=a.street,o[e])switch(n){case"address-level1":o[e]["address-level1"].value=a.region;break;case"address-level2":o[e]["address-level2"].value=a.city;break;case"postal-code":o[e]["postal-code"].value=a.postcode;break;case"country":o[e].country.value=a.country;break;case"country-code":a["country-code"]?o[e]["country-code"].value=a["country-code"]:o[e]["country-code"].value=a.country_code}}));void 0!==a.updateAutocomplete&&d.push(a)}(m,i)):console.log("API: An input with autocomplete attribute 'street-address' or 'address-line1' was not found."));return d}},addAerialImagery:function(e){var n=!0,i=[[[-104.853516,29.774649],[-80.90332,41.808621]],[[-114.697266,31.733423],[-106.54541,49.09563]],[[-125.727539,32.407206],[-114.609375,49.125338]],[[-108.149414,31.735093],[-104.633789,49.152471]],[[-81.101074,31.864267],[-69.675293,42.359457]],[[-83.693848,24.493357],[-79.848633,30.395503]],[[-101.645508,28.849233],[-84.528809,29.749476]],[[-100.623779,25.743899],[-95.339355,28.827531]],[[-106.479492,30.340827],[-104.699707,32.162079]],[[-112.543945,31.25324],[-108.105469,31.964051]],[[-104.897461,41.758319],[-82.375488,46.029057]],[[-104.919434,45.943561],[-83.210449,47.548488]],[[-104.941406,47.48012],[-88.088379,48.298688]],[[-104.952393,48.277197],[-92.362061,49.418971]],[[-79.969482,42.295311],[-69.829102,43.573655]],[[-76.640625,43.53305],[-66.52771,45.077231]],[[-71.5979,45.03054],[-66.994629,47.493728]],[[-67.985919,17.265936],[-64.52648,18.884333]]];if(void 0!==a.ol){var r=function(){var t=e.getView().getZoom();if(t>20)return!1;var o=!1,n=0,r=e.getView().getCenter();do{var l=new a.ol.extent.boundingExtent([a.ol.proj.fromLonLat(i[n][0]),a.ol.proj.fromLonLat(i[n][1])]);o=a.ol.extent.containsCoordinate(l,r),n++}while(!o&&n<18);return!(!o&&t>15.5)},l=new a.ol.layer.Tile({source:new a.ol.source.XYZ({format:new a.ol.format.MVT,maxZoom:17,url:"https://api.slpy.com/v1/app/aerial-imagery/{z}/{x}/{y}.png?key="+o.apiKey}),minZoom:0,maxZoom:20,zindex:0}),s=new a.ol.layer.Tile({source:new a.ol.source.XYZ({format:new a.ol.format.MVT,maxZoom:16,url:"https://api.slpy.com/v1/app/aerial-topo/{z}/{x}/{y}.png?key="+o.apiKey}),minZoom:0,maxZoom:19,zindex:0});class n extends a.ol.control.Control{constructor(e){var t=e||{},o=document.createElement("button");o.style.cssText='background-image: url("https://www.slpy.com/img/AerialImagery.png");background-size: contain;border-radius: 4px; width: 45px; height: 45px',o.setAttribute("id","AerialImageryIcon");var a=document.createElement("div");a.className="ol-control",a.setAttribute("id","AerialImageryButton"),a.style.cssText="bottom: 0; right: 8px; margin-bottom: 50px; width: 45px; height: 45px",a.appendChild(o),super({element:a,target:t.target}),o.addEventListener("click",this.AerialImageryControl.bind(this),!1)}AerialImageryControl(){t.aerialImageryOn?(t.oldIE?this.getMap().removeLayer(s):(this.getMap().removeLayer(l),void 0!==t.streetLevelOn&&t.streetLevelOn&&mapillarySource.setStyle(photoDot)),document.getElementById("AerialImageryIcon").style.backgroundImage="url('https://www.slpy.com/img/AerialImagery.png')",t.aerialImageryOn=!1,e.getLayers().forEach((function(e){e.getSource().refresh()}))):r()?(t.aerialImageryOn=!0,t.oldIE=!0,t.oldIE?e.addLayer(s):(e.getLayers().forEach((function(e){e.getSource().refresh()})),e.getLayers().insertAt(0,l),void 0!==t.streetLevelOn&&t.streetLevelOn&&mapillarySource.setStyle(photoDotAerial)),document.getElementById("AerialImageryIcon").style.backgroundImage="url('https://www.slpy.com/img/VectorImagery.png')"):e.getView().getZoom()>19?alert("No Aerial Imagery at this level.  Try zooming out."):alert("No Aerial Imagery available in this region.")}}e.addControl(new n);var c=!0,d=document.getElementById("AerialImageryButton");r()||(d.style.display="none",c=!1),e.on("moveend",(function(){r()&&!c?(d.style.display="block",c=!0):!r()&&c&&(d.style.display="none",c=!1,t.aerialImageryOn&&document.getElementById("AerialImageryIcon").click())}))}else if(t.maplibreLoaded){var m=function(){var t=e.getZoom();if(t>19)return!1;var o=!1,n=0,r=e.getCenter();do{o=new a.maplibregl.LngLatBounds(i[n]).contains(r),n++}while(!o&&n<18);return!(!o&&t>14.5)},p="",y=function(){},u=function(){if(t.aerialImageryOn){if(void 0!==t.streetLevelOn)if(t.streetLevelOn){var o=e.getSource("streetLevelIcon"),a=e.getSource("mimgLayer"),i=e.getLayer("mimgLayer"),r=e.getLayer("streetLevelIcon");e.setStyle(p),a||e.addSource("mimgLayer",{type:"vector",tiles:a.tiles,minzoom:a.minzoom,maxzoom:a.maxzoom}),o||e.addSource("streetLevelIcon",{type:"geojson",data:o._data}),i||e.addLayer({id:"mimgLayer",type:"circle",source:"mimgLayer","source-layer":"mapillary-images",minzoom:i.minzoom,maxzoom:i.maxzoom,paint:i.paint_}),r||e.addLayer({id:"streetLevelIcon",type:"symbol",source:"streetLevelIcon",paint:r.paint_,layout:r.layout_})}else e.setStyle(p),e.getLayer("mimgLayer")&&e.removeLayer("mimgLayer"),e.getLayer("streetLevelIcon")&&e.removeLayer("streetLevelIcon");else e.setStyle(p);document.getElementById("AerialImageryIcon").style.backgroundImage="url('https://www.slpy.com/img/AerialImagery.png')",t.aerialImageryOn=!1}else m()?(n&&(e.addSource("satellite",g),n=!1),p=e.getStyle(),void 0!==t.streetLevelOn&&t.streetLevelOn&&e.setPaintProperty("mimgLayer","circle-color","rgba(53, 175, 109,0.5)"),e.addLayer({id:"satellite",type:"raster",source:"satellite",minzoom:0,maxzoom:19},"necountries-4"),document.getElementById("AerialImageryIcon").style.backgroundImage="url('https://www.slpy.com/img/VectorImagery.png')",e.setLayoutProperty("roads-casing","visibility","none"),e.setLayoutProperty("roads-motorway-casing-low-zoom","visibility","none"),e.setLayoutProperty("highway-area-fill","visibility","none"),e.setLayoutProperty("highway-motorway-shadow","visibility","none"),e.setLayoutProperty("highway-trunk-shadow","visibility","none"),e.setLayoutProperty("roads-low-zoom-primary-shadow","visibility","none"),e.setLayoutProperty("roads-low-zoom-secondary-shadow","visibility","none"),e.setLayoutProperty("roads-low-zoom-motorway-shadow","visibility","none"),e.setLayoutProperty("roads-low-zoom-trunk-shadow","visibility","none"),e.setPaintProperty("highway-motorway","line-color","#edaa82"),e.setPaintProperty("roads","line-opacity",.5),e.setPaintProperty("roads-low-zoom-secondary","line-opacity",.5),e.setPaintProperty("roads-low-zoom-trunk","line-opacity",.3),e.setPaintProperty("highway-motorway","line-opacity",.5),e.setPaintProperty("highway-trunk","line-color","#bbb"),e.setPaintProperty("highway-trunk","line-width",1),e.setPaintProperty("highway-trunk","line-opacity",.5),e.setPaintProperty("ferry-routes","line-opacity",.5),e.setPaintProperty("roads-text-name","text-color","#000"),e.setPaintProperty("roads-text-name","text-halo-width",1.25),e.setPaintProperty("placenames","text-color","#fff"),e.setPaintProperty("placenames","text-halo-color","#000"),e.setPaintProperty("placenames","text-halo-width",1),e.setPaintProperty("placenames-small","text-color","#fff"),e.setPaintProperty("placenames-small","text-halo-color","#555"),e.setPaintProperty("placenames-small","text-halo-width",1.5),e.setPaintProperty("ocean-points","text-halo-color","#4f6f80"),e.setPaintProperty("ocean-points","text-color","#fff"),e.setPaintProperty("state-names","text-halo-color","rgba(114, 83, 128, 0.6)"),e.setPaintProperty("state-names","text-color","rgba(255, 255, 255, 0.6)"),e.setPaintProperty("state-names-low-zoom","text-halo-color","rgba(114, 83, 128, 0.6)"),e.setPaintProperty("state-names-low-zoom","text-color","rgba(255, 255, 255, 0.6)"),e.setPaintProperty("amenity-points-landuse","text-halo-color","#fff"),e.setPaintProperty("amenity-points-landuse","text-halo-width",1),e.setPaintProperty("text-poly-low-zoom","text-halo-color","#fff"),e.setPaintProperty("text-poly-low-zoom","text-halo-width",.5),e.setPaintProperty("amenity-points-low","icon-halo-width",.5),e.setPaintProperty("amenity-points","icon-halo-width",.5),e.setPaintProperty("amenity-points-mid","icon-halo-width",.5),e.setPaintProperty("amenity-points-high","icon-halo-width",.5),e.setPaintProperty("amenity-points-low","text-halo-width",.6),e.setPaintProperty("amenity-points","text-halo-width",.6),e.setPaintProperty("amenity-points-mid","text-halo-width",.6),e.setPaintProperty("amenity-points-high","text-halo-width",.6),e.setPaintProperty("necountries-4","line-color","#222"),e.setPaintProperty("necountries-2","line-color","#222"),e.setPaintProperty("admin-mid-zoom-2","line-color","#222"),e.setPaintProperty("admin-mid-zoom-3","line-color","#222"),e.setPaintProperty("admin-mid-zoom-4","line-color","#222"),e.setPaintProperty("admin-high-zoom-2","line-color","#222"),e.setPaintProperty("admin-high-zoom-3","line-color","#222"),e.setPaintProperty("admin-high-zoom-4","line-color","#222"),t.aerialImageryOn=!0):e.getZoom()>19?alert("No Aerial Imagery at this level.  Try zooming out."):alert("No Aerial Imagery available in this region.")},g={type:"raster",scheme:"xyz",tiles:["https://api.slpy.com/v1/app/aerial-imagery/{z}/{x}/{y}.png?key="+o.apiKey],minzoom:0,maxzoom:17,tileSize:256};y.prototype.onAdd=function(e){this._map=e,this._container=document.createElement("div"),this._container.className="maplibregl-ctrl maplibregl-ctrl-group",this._container.style.cssText="pointer-events: auto;",this._container.setAttribute("id","AerialImageryButton");var t=document.createElement("button");t.style.width="45px",t.style.height="45px",t.addEventListener("click",u),this._container.appendChild(t);var o=document.createElement("span");return o.style.cssText='background-image: url("https://www.slpy.com/img/AerialImagery.png");background-size: contain;border-radius: 4px;',o.setAttribute("id","AerialImageryIcon"),o.className="maplibregl-ctrl-icon",t.appendChild(o),this._container},y.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map=void 0},y=new y,e.addControl(y,"bottom-right");c=!0,d=document.getElementById("AerialImageryButton");m()||(d.style.display="none",c=!1),e.on("idle",(function(){m()&&!c?(d.style.display="block",c=!0):!m()&&c&&(d.style.display="none",c=!1,t.aerialImageryOn&&u())}))}},addAutocomplete:n,addMarkers:function(e,t,o){o=void 0===o?"default":o;var n=[];if(void 0!==a.ol){for(var i=0;i<e.length;i++){if("default"==o)n.push(y([e[i].data[1],e[i].data[0]],e[i].name,i,o));else{var r=y([e[i].data[1],e[i].data[0]],e[i].name,i,o);n.push(r[0],r[1])}void 0!==e[i].data[2]&&""!==e[i].data[2]&&(p=!0)}if(c=new a.ol.source.Vector({features:n}),d=new a.ol.layer.Vector({source:c,className:"ol-markers"}),t.once("rendercomplete",(function(e){t.addLayer(d)})),p){if(null==document.getElementById("popup")){var l=document.createElement("div");l.innerHTML='<a href="#" id="popup-closer" class="ol-popup-closer"></a><div id="popup-content"></div>',l.id="popup",l.classList.add("ol-popup"),t.getTargetElement().appendChild(l)}var s=document.getElementById("popup"),u=document.getElementById("popup-content"),g=document.getElementById("popup-closer");m=new a.ol.Overlay({element:s,autoPan:!0,position:void 0,autoPanAnimation:{duration:250}}),t.addOverlay(m),g.onclick=function(){return m.setPosition(void 0),g.blur(),!1},t.on("singleclick",(function(o){var n=t.forEachFeatureAtPixel(o.pixel,(function(e){return e.getId()}));"string"==typeof n&&(markerIndex=n.replace("marker:",""),markerIndex>=0&&""!=e[markerIndex].data[2]&&void 0!==e[markerIndex].data[2]?(s.style.display="block",u.innerHTML=e[markerIndex].data[2],m.setPosition(a.ol.proj.fromLonLat([e[markerIndex].data[1],e[markerIndex].data[0]]))):s.style.display="none")}))}}else{var h='\x3c!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e<path d="M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/></svg>',v='\x3c!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e<path d="M384 192c0 87.4-117 243-168.3 307.2c-12.3 15.3-35.1 15.3-47.4 0C117 435 0 279.4 0 192C0 86 86 0 192 0S384 86 384 192z"/></svg>';for(i=0;i<e.length;i++){var f='<svg xmlns="http://www.w3.org/2000/svg" id="marker-'+parseInt([i]).toString()+'" style="fill: #a11c25;width:27px; height:36px;stroke:#fff;stroke-width:15px;filter: drop-shadow(1px 2px 1px rgba(0,0,0,0.4));" viewBox="0 0 384 512">';if(p=!1,void 0!==e[i].data[2]&&""!==e[i].data[2]&&(p=!0),"default"==o){if(p)(w=document.createElement("span")).innerHTML=f+h,new a.maplibregl.Marker({element:w,anchor:"bottom",offset:[0,5]}).setLngLat([e[i].data[1],e[i].data[0]]).setPopup(new a.maplibregl.Popup({offset:[0,-36],className:"popup-"+[i]}).setHTML(e[i].data[2])).addTo(t);else(w=document.createElement("span")).innerHTML=f+h,new a.maplibregl.Marker({element:w,anchor:"bottom",offset:[0,5]}).setLngLat([e[i].data[1],e[i].data[0]]).addTo(t)}else{var w,b,L='position: absolute;font-weight: bold;top:5px;display: block; width:27px;left:0px;font-size:14px;color:white;text-align:center;text-shadow:-1px -1px 0 rgba(0,0,0,0.25), 1px -1px 0 rgba(0,0,0,0.25), -1px 1px 0 rgba(0,0,0,0.25), 1px 1px 0 rgba(0,0,0,0.25);font-family:"Open Sans", "Arial", "Verdana", "sans-serif"';if(p)(w=document.createElement("span")).innerHTML=f+v,(b=document.createElement("span")).innerHTML=(parseInt([i])+1).toString(),b.setAttribute("style",L),w.appendChild(b),new a.maplibregl.Marker({element:w,anchor:"bottom",offset:[0,5]}).setLngLat([e[i].data[1],e[i].data[0]]).setPopup(new a.maplibregl.Popup({offset:[0,-36],className:"popup-"+[i]}).setHTML(e[i].data[2])).addTo(t);else(w=document.createElement("span")).innerHTML=f+v,(b=document.createElement("span")).innerHTML=(parseInt([i])+1).toString(),b.setAttribute("style",L),w.appendChild(b),new a.maplibregl.Marker({element:w,anchor:"bottom",offset:[0,5]}).setLngLat([e[i].data[1],e[i].data[0]]).addTo(t)}}}},highlightMarker:function(e){if(void 0!==d){var t=d.getSource().getFeatureById("marker:"+e);if(null!==t){var o=t.getStyle().getImage();void 0!==o.iconImage_&&void 0!==o.iconImage_.color_&&(o.iconImage_.color_=[0,130,200,1]),t.getStyle().setZIndex(1)}}else{var a=document.getElementById("marker-"+e);a&&(a.style.fill="#0082c8",a.parentElement.style.zIndex=1)}},dehighlightMarker:function(e){if(void 0!==d){var t=d.getSource().getFeatureById("marker:"+e);if(null!==t){var o=t.getStyle().getImage();void 0!==o.iconImage_&&void 0!==o.iconImage_.color_&&(o.iconImage_.color_=[161,28,37,1]),t.getStyle().setZIndex(0)}}else{var a=document.getElementById("marker-"+e);a&&(a.style.fill="#a11c25",a.parentElement.style.zIndex=0)}},removeMarker:function(e,t){if((t=void 0===t?-1:t)<0&&(t=0),void 0!==a.ol){if(void 0!==d){var o=d.getSource().getFeatureById("marker:"+t);null!==o&&c.removeFeature(o)}if(void 0!==e[t])if(void 0!==e[t].data[2])if(""!==e[t].data[2])document.getElementById("popup").style.display="none"}else{var n=document.getElementById("marker-"+t);if(n){var i=document.querySelector(".maplibre-popup.popup-"+t);i&&i.remove(),n.parentElement.remove()}}},createMarker:y,setMarkerOpen:function(e,t){if(t=void 0===t?-1:t,void 0!==a.ol){var o=document.getElementById("popup"),n=document.getElementById("popup-content");t<0&&(t=0),o.style.display="block",n.innerHTML=e[t].data[2];try{m.setPosition(a.ol.proj.fromLonLat([e[t].data[1],e[t].data[0]]))}catch(e){}}else{var i=document.getElementById("marker-"+t);i&&i.parentElement.click()}},quickMarkersCenter:function(e){for(var t=0,o=0,a=[],n=[],i=e.length,r=0;r<i;++r)t+=Number(e[r].data[0]),o+=Number(e[r].data[1]),a.push(e[r].data[0]),n.push(e[r].data[1]);var l=s(Math.max.apply(Math,a),Math.max.apply(Math,n),Math.min.apply(Math,a),Math.min.apply(Math,n)),c=13;switch(!0){case l<1:c=14;break;case l<4:c=13;break;case l<10:c=12;break;case l<20:c=11;break;case l<40:c=10;break;case l<100:c=9;break;case l<250:c=8;break;case l<400:c=7;break;case l<750:c=6;break;case l<2e3:c=5;break;case l<4e3:c=4;break;case l>=4e3:c=3}return[t/=i,o/=i,c]},addMapillary:h,isWebGL2Supported:i,loadScript:r,setInteractionOnFocus:function(e,o){var n=document.getElementById(e);n.style.position="relative",n.tabIndex=1,n.insertAdjacentHTML("afterbegin",'<p id="mapOverlayNotice" style="position:absolute;z-index:10;margin-top:20px;width:100%;height:100%;font-weight:bold;font-size:22px;color:rgb(25, 25, 25);display:none;text-align:center;justify-content: center; align-items: center;"><span style="background:white;padding: 10px;border-radius: 5px;box-shadow: 2px 2px 4px rgba(0,0,0,0.3);">Click the map to pan and zoom.</span></p>');var i=document.getElementById("mapOverlayNotice");void 0!==a.ol?(t.openlayersLoaded&&o.getInteractions().forEach((function(e){(e instanceof a.ol.interaction.DragPan||e instanceof a.ol.interaction.MouseWheelZoom)&&e.setActive(!1)}),this),n.onclick=function(){n.removeEventListener("wheel",l,!1),n.removeEventListener("touchmove",l,!1),t.openlayersLoaded&&o.getInteractions().forEach((function(e){(e instanceof a.ol.interaction.DragPan||e instanceof a.ol.interaction.MouseWheelZoom)&&e.setActive(!0)}),this)}):(t.maplibreLoaded&&(o.scrollZoom.disable(),o.dragPan.disable()),n.onclick=function(){n.removeEventListener("wheel",l,!1),n.removeEventListener("touchmove",l,!1),t.maplibreLoaded&&(o.scrollZoom.enable(),o.dragPan.enable())});var r=null,l=function(e){document.activeElement!==n&&(n.style.opacity="0.7",i.style.display="flex",null!==r&&clearTimeout(r),r=setTimeout((function(){i.style.display="none",n.style.opacity="1"}),500))};n.addEventListener("wheel",l,!1),n.addEventListener("touchmove",l,!1)},setTransform:function(e,o){if(void 0!==o)if(void 0===a.ol)if(void 0!==t.mapStyleUrl){for(var n=t.mapStyleUrl.split("?"),i=n[0],r=n[1].split("&"),l=[],s=0;s<r.length;s++)-1===r[s].indexOf("transform=")&&l.push(r[s]);t.mapStyleUrl=i+"?"+l.join("&"),""!=e&&"default"!=e&&(t.mapStyleUrl=t.mapStyleUrl+"&transform="+e),o.setStyle(t.mapStyleUrl)}else console.log("Could not retrieve original url. mapStyleUrl is undefined.");else console.log("Can not currently set Transform with OpenLayers.  Requires MapLibre.");else console.log("Map was undefined.  The second parameter should be of type Map.")},flyTo:function(e,t){if(void 0!==a.ol)var o=t.getView(),n=a.ol.proj.toLonLat(o.getCenter()),i=a.ol.proj.fromLonLat([e.lon,e.lat]),r=o.getZoom(),l=e.quality,c=function(){},d=2,m=!1;else{var p=t.getCenter();n=Object.values(p),i=[e.lon,e.lat],r=t.getZoom()}var y=r,u=(l=e.quality,s(e.lat,e.lon,n[1],n[0])),g=1e3,h=y-1;switch(!0){case u<1:y>16&&(h=16);break;case u<5:y>15&&(h=15);break;case u<10:y>14&&(h=14);break;case u<40:y>13&&(h=13);break;case u<50:y>12&&(h=12),g*=2;break;case u<150:y>11&&(h=11),g*=2;break;case u<250:y>10&&(h=10),g*=2;break;case u<400:y>9&&(h=9),g*=3;break;case u<700:y>8&&(h=8),g*=3;break;case u<1e3:y>7&&(h=7),g*=3;break;case u<2e3:y>6&&(h=6),g*=4;break;case u<3500:y>5&&(h=5),g*=4;break;case u<5e3:y>4&&(h=4),g*=4;break;case u>=5e3:y>3&&(h=3),g*=4}switch(y<13&&(y=13),parseInt(l)){case 1:y=4;break;case 2:y=6;break;case 3:y=8;break;case 4:y=10;break;case 5:y=12;break;case 6:y=13;break;case 7:y=16;break;case 8:y=16.5;break;case 9:case 10:y=17}if(h>=y&&(h=y-1),r>=y&&(h=y),void 0!==a.ol){var v=function(e){--d,m||0!==d&&e||(m=!0,c(e))};o.animate({center:i,duration:g},v),o.animate({zoom:h,duration:g},{zoom:y,duration:g/2},v)}else if(e.boundingbox){var f=e.boundingbox;t.fitBounds([[f[2],f[0]],[f[3],f[1]]],{maxZoom:18,padding:{top:15,bottom:15,left:15,right:15}})}else{var w={center:i,zoom:y,maxDuration:2.5*g};t.flyTo(w)}},toRad:l,distanceInKM:s,distanceInMI:function(e,t,o,a){var n=l(a-t);return e=l(e),o=l(o),3959*Math.acos(Math.sin(e)*Math.sin(o)+Math.cos(e)*Math.cos(o)*Math.cos(n))},mapState:t,settings:o,openlayersParts:{view:{},controls:{},interactions:{}},mapLibraries:a};function f(e,t){if(void 0===a.maplibregl||!i()){if(void 0!==a.maplibregl&&function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}())try{if(a.maplibregl.getVersion().split(".").map(Number)>=5)return!0;console.log("MapLibre requries v5+ for WebGL 1 support.")}catch(e){console.log("Browser has WebGL, but lacks full support for MapLibre.")}if("string"==typeof(o=e))var o=document.getElementById(e);return void 0===a.maplibregl?o.insertAdjacentHTML("afterbegin",'<p id="mapOverlayNotice">The Maplibre GL library could not be found or imported.</p>'):o.insertAdjacentHTML("afterbegin",'<p id="mapOverlayNotice">Your Web Browser is not compatible.  Please upgrade.</p>'),!1}return!0}function w(n){return a.maplibregl=function(){let t={};if("undefined"!=typeof window&&void 0!==window.maplibregl)return window.maplibregl;try{t={...e}}catch(e){console.log(e),console.log("Slpy JS: 'maplibre' could not be found. Make sure https://github.com/maplibre/maplibre-gl-js  is installed and/or the script has been run before this function.")}return t}(),f((n=function(e){return e.apiKey||console.log("Slpy Map Missing apiKey: Please add your Slpy apiKey to the options object in the maplibreMap function."),e.container||console.log("Slpy Map Missing container: Please add your container id or element to the options object in the maplibreMap function."),e.center||console.log("Slpy Map Missing center: Please add your center as a [longitude, latitude] element to the options object in the maplibreMap function."),e.zoom||console.log("Slpy Map Missing zoom: Please add a zoom value to the options object in the maplibreMap function. Level 0 is globe, 20 is house level."),void 0!==e.mapType&&"raster"==e.mapType.toLowerCase()?e.mapType="raster":e.mapType="vector",void 0!==e.language&&"en"!=e.language.toLowerCase()?e.mapLanguage=e.language.toLowerCase():void 0!==e.mapLanguage&&"en"!=e.mapLanguage.toLowerCase()?e.mapLanguage=e.mapLanguage.toLowerCase():e.mapLanguage="en",void 0!==e.mapFilter&&e.mapFilter.length>0&&(o.mapFilter=e.mapFilter),o.apiKey=e.apiKey.toLowerCase(),e}(n)).container)?function(e){t.maplibreLoaded=!0,"undefined"!=typeof MglOptions&&(e=Object.assign(e,MglOptions));var n=!1;t.mapStyleUrl="https://api.slpy.com/style/slpy-mgl-style.json?key="+o.apiKey;var i="top-left";"raster"==e.mapType?(n=!1,t.mapStyleUrl+="&raster=true"):e.mapStyle&&"3d"==e.mapStyle.toLowerCase()&&(n=!0,t.mapStyleUrl+="&style=3d"),void 0!==e.antialias&&(n=e.antialias);var r=21;if(void 0!==e.maxZoom&&(r=e.maxZoom),void 0!==e.mapTransform&&e.mapTransform.length>0&&(t.mapStyleUrl+="&transform="+e.mapTransform.toLowerCase()),void 0!==o.mapFilter&&o.mapFilter.length>0){t.mapStyleUrl+="&filter=",t.mapStyleUrl+="&filter=";for(var l=0;l<o.mapFilter.length;l++)t.mapStyleUrl+=o.mapFilter[l].toLowerCase().replace("_points","")+",";t.mapStyleUrl=t.mapStyleUrl.substring(0,t.mapStyleUrl.length-1)}"en"!=e.mapLanguage&&(t.mapStyleUrl+="&lang="+e.mapLanguage);var s={container:e.container,style:t.mapStyleUrl,maxZoom:r,center:e.center,zoom:e.zoom,antialias:n,hash:!1,attributionControl:!1};if(""!==e)for(var c in e)s[c]=e[c];return void 0!==e.navControl&&"none"==e.navControl.toLowerCase()?new a.maplibregl.Map(s).addControl(new a.maplibregl.AttributionControl({compact:!1})):(e.navControl&&(i=e.navControl),new a.maplibregl.Map(s).addControl(new a.maplibregl.AttributionControl({compact:!1})).addControl(new a.maplibregl.NavigationControl,i))}(n):""}const b={maplibreMap:w,...v};export{v as generalFunctions,w as maplibreMap,b as slpy};
//# sourceMappingURL=index.js.map
