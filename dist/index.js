import e from"maplibre-gl";function t(e,t,o){if("string"==typeof e)var a=document.getElementById(e);else if(!e||"input"!==e.nodeName.toLowerCase()&&"textarea"!==e.nodeName.toLowerCase())console.log("Target input for autocomplete is not a valid element or id");else a=e;o=void 0===o?"":o;var n="US";void 0!==t.country&&(n=t.country.toLowerCase());var i="";void 0!==t.apiKey&&(i=t.apiKey.toLowerCase());var r=a.offsetWidth-6+"px";void 0!==t.width&&(r=t.width);var l=3;void 0!==t.offsetLeft&&(l=t.offsetLeft);var s=3;void 0!==t.offsetTop&&(s=t.offsetTop);var c="all";void 0!==t.autocompleteType&&(c=t.autocompleteType.toLowerCase());var d="";void 0!==t.filter&&(d="&filter="+t.filter.toLowerCase());var m=10;void 0!==t.limit&&(t.limit=parseInt(t.limit),t.limit<10&&t.limit>0?m=t.limit:console.log("Autocomplete limit is outside of 1-10 range."));var p=175;void 0!==t.debounceTime&&(t.debounceTime=parseInt(t.debounceTime),t.debounceTime<1e3&&t.debounceTime>0?p=t.debounceTime:console.log("Autocomplete debounceTime is outside of 1-1000 range."));var y=document.createElement("div");y.className="apiautodropdown-content",y.id="apiautodropdownContent "+a.id;void 0!==t.insertId?document.getElementById(t.insertId).appendChild(y):document.body.appendChild(y);function u(e){var o=a.parentNode.getBoundingClientRect(),n=a.getBoundingClientRect();if(void 0!==t.insertId)var i={left:n.left-o.left,top:n.top-o.top,height:n.height};else i=a.getBoundingClientRect();var c=window.visualViewport?window.visualViewport.height:window.innerHeight;if(e&&"resize"!==e.type||(y.style.position="absolute",y.style.left=i.left+l+window.pageXOffset+"px",y.style.top=i.top+i.height+window.pageYOffset+s+"px",y.style.width=r),!e||"scroll"===e.type){var d=Math.max(165,c-n.top-i.height-s-5);y.style.maxHeight=d+"px"}}var g=0,h="";function v(e,t,o,a){e.addEventListener?e.addEventListener(t,o,a):e.attachEvent&&e.attachEvent("on"+t,o)}function f(e,t,o,a){e.removeEventListener?e.removeEventListener(t,o,a):e.detachEvent&&e.detachEvent("on"+t,o)}v(a,"keydown",(function(e){g=0,40===e.keyCode||9==e.keyCode?(e.preventDefault(),y.getElementsByClassName("apiautodropdown-item")[0].focus()):13==e.keyCode&&(y.classList.remove("apiautodropdown-content-show"),f(window,"resize",u,!1),f(window,"scroll",u,!1))}),!1),v(y,"keydown",(function(e){40!==e.keyCode&&9!=e.keyCode||(e.preventDefault(),void 0!==y.getElementsByClassName("apiautodropdown-item")[g+1]&&(g++,y.getElementsByClassName("apiautodropdown-item")[g].focus())),38===e.keyCode&&(e.preventDefault(),g>0?g--:setTimeout((function(){a.focus()}),10),y.getElementsByClassName("apiautodropdown-item")[g].focus())}),!1);var w=null;function b(e,t){w&&w.abort();var o=function(e,t){var o=new XMLHttpRequest;return"withCredentials"in o?o.open(e,t,!0):"undefined"!=typeof XDomainRequest?(o=new XDomainRequest).open(e,t):o=null,o}("POST",e);o.onreadystatechange=function(){if(4===o.readyState){if(200===o.status){var e=JSON.parse(o.responseText);t(e)}w=null}},w=o,o.send()}var L={};function x(e){L=e}var k,I,P,C=(k=function(e){if(13!==e.keyCode){if(9!==e.keyCode){var t=a.value.toLowerCase();if(t.length>1){if(t!==h+" "&&t!==h){var o=function(e){if(Object.keys(e).length>0){var t=!1;if(void 0!==e[0]&&void 0!==e[0].focus&&(t=!0,y.innerHTML=""),Object.keys(e).forEach((function(t){if(void 0!==e[t]&&void 0!==e[t].focus&&t<m){var o=document.createElement("button");o.className="apiautodropdown-item",o.type="button";var a='<svg xmlns="http://www.w3.org/2000/svg" class="apiautodropdown-icon" width="17px" height="13px" viewBox="0 0 448 512">\x3c!-- Font Awesome Pro 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) --\x3e';switch(e[t].quality){case 6:a+='<path d="M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z"/></svg>';break;case 5:a+='<path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>';break;case 4:a+='<path d="M616 192H480V24c0-13.26-10.74-24-24-24H312c-13.26 0-24 10.74-24 24v72h-64V16c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v80h-64V16c0-8.84-7.16-16-16-16H80c-8.84 0-16 7.16-16 16v80H24c-13.26 0-24 10.74-24 24v360c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V216c0-13.26-10.75-24-24-24zM128 404c0 6.63-5.37 12-12 12H76c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12H76c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12H76c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm128 192c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm160 96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12V76c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm160 288c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40zm0-96c0 6.63-5.37 12-12 12h-40c-6.63 0-12-5.37-12-12v-40c0-6.63 5.37-12 12-12h40c6.63 0 12 5.37 12 12v40z"/></svg>';break;case 3:a+='<path d="M256 336h-.02c0-16.18 1.34-8.73-85.05-181.51-17.65-35.29-68.19-35.36-85.87 0C-2.06 328.75.02 320.33.02 336H0c0 44.18 57.31 80 128 80s128-35.82 128-80zM128 176l72 144H56l72-144zm511.98 160c0-16.18 1.34-8.73-85.05-181.51-17.65-35.29-68.19-35.36-85.87 0-87.12 174.26-85.04 165.84-85.04 181.51H384c0 44.18 57.31 80 128 80s128-35.82 128-80h-.02zM440 320l72-144 72 144H440zm88 128H352V153.25c23.51-10.29 41.16-31.48 46.39-57.25H528c8.84 0 16-7.16 16-16V48c0-8.84-7.16-16-16-16H383.64C369.04 12.68 346.09 0 320 0s-49.04 12.68-63.64 32H112c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h129.61c5.23 25.76 22.87 46.96 46.39 57.25V448H112c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h416c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"/></svg>';break;case 2:a+='<path d="M496 128v16a8 8 0 0 1-8 8h-24v12c0 6.627-5.373 12-12 12H60c-6.627 0-12-5.373-12-12v-12H24a8 8 0 0 1-8-8v-16a8 8 0 0 1 4.941-7.392l232-88a7.996 7.996 0 0 1 6.118 0l232 88A8 8 0 0 1 496 128zm-24 304H40c-13.255 0-24 10.745-24 24v16a8 8 0 0 0 8 8h464a8 8 0 0 0 8-8v-16c0-13.255-10.745-24-24-24zM96 192v192H60c-6.627 0-12 5.373-12 12v20h416v-20c0-6.627-5.373-12-12-12h-36V192h-64v192h-64V192h-64v192h-64V192H96z"/></svg>';break;case 1:a+='<path d="M248 8C111.03 8 0 119.03 0 256s111.03 248 248 248 248-111.03 248-248S384.97 8 248 8zm82.29 357.6c-3.9 3.88-7.99 7.95-11.31 11.28-2.99 3-5.1 6.7-6.17 10.71-1.51 5.66-2.73 11.38-4.77 16.87l-17.39 46.85c-13.76 3-28 4.69-42.65 4.69v-27.38c1.69-12.62-7.64-36.26-22.63-51.25-6-6-9.37-14.14-9.37-22.63v-32.01c0-11.64-6.27-22.34-16.46-27.97-14.37-7.95-34.81-19.06-48.81-26.11-11.48-5.78-22.1-13.14-31.65-21.75l-.8-.72a114.792 114.792 0 0 1-18.06-20.74c-9.38-13.77-24.66-36.42-34.59-51.14 20.47-45.5 57.36-82.04 103.2-101.89l24.01 12.01C203.48 89.74 216 82.01 216 70.11v-11.3c7.99-1.29 16.12-2.11 24.39-2.42l28.3 28.3c6.25 6.25 6.25 16.38 0 22.63L264 112l-10.34 10.34c-3.12 3.12-3.12 8.19 0 11.31l4.69 4.69c3.12 3.12 3.12 8.19 0 11.31l-8 8a8.008 8.008 0 0 1-5.66 2.34h-8.99c-2.08 0-4.08.81-5.58 2.27l-9.92 9.65a8.008 8.008 0 0 0-1.58 9.31l15.59 31.19c2.66 5.32-1.21 11.58-7.15 11.58h-5.64c-1.93 0-3.79-.7-5.24-1.96l-9.28-8.06a16.017 16.017 0 0 0-15.55-3.1l-31.17 10.39a11.95 11.95 0 0 0-8.17 11.34c0 4.53 2.56 8.66 6.61 10.69l11.08 5.54c9.41 4.71 19.79 7.16 30.31 7.16s22.59 27.29 32 32h66.75c8.49 0 16.62 3.37 22.63 9.37l13.69 13.69a30.503 30.503 0 0 1 8.93 21.57 46.536 46.536 0 0 1-13.72 32.98zM417 274.25c-5.79-1.45-10.84-5-14.15-9.97l-17.98-26.97a23.97 23.97 0 0 1 0-26.62l19.59-29.38c2.32-3.47 5.5-6.29 9.24-8.15l12.98-6.49C440.2 193.59 448 223.87 448 256c0 8.67-.74 17.16-1.82 25.54L417 274.25z"/></svg>';break;default:a+='<path d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"/></svg>'}e[t].focus.indexOf(",")>-1?o.innerHTML=a+'<div class="apiautodropdown-text">'+e[t].focus.replace(",",'<span class="apiautodropdown-muted">,')+"</span></div>":o.innerHTML=a+'<div class="apiautodropdown-text">'+e[t].focus+"</div>",o.setAttribute("autocompleteID",t),y.appendChild(o)}})),t){var o=document.createElement("div");y.appendChild(o),o.innerHTML='<a href="https://www.slpy.com" style="color:#888f94; text-decoration:none;">powered by <span style="color:#5e849f;font-size:13px">Slpy</a>',o.setAttribute("style","line-height:13px; font-size: 12px; padding:2px 10px 0px 0px; margin: 0px; text-align:right"),y.classList.contains("apiautodropdown-content-show")||(y.classList.add("apiautodropdown-content-show"),u(),v(window,"resize",u,!1),v(window,"scroll",u,!1),function(e){var t,o=e.getBoundingClientRect(),a=window.innerHeight||document.documentElement.clientHeight;if(o.bottom>a){var n=o.height,i=a-o.top,r=n<165?n:165;i<r&&(t=r-i,window.scrollBy(0,t))}}(y))}}else y.classList.contains("apiautodropdown-content-show")&&(y.classList.remove("apiautodropdown-content-show"),f(window,"resize",u,!1),f(window,"scroll",u,!1))};h=t,g=0,"all"==c?b("https://api.slpy.com/v1/search?autocomplete=admin"+d+"&country="+n+"&key="+i+"&search="+t,(function(e){Object.keys(e).length<m?b("https://api.slpy.com/v1/search?autocomplete=address&country="+n+"&key="+i+"&search="+t,(function(t){if(void 0===e[0]||void 0===e[0].focus||""===e[0].focus)e=t;else if(void 0!==t[0].focus&&""!==t[0].focus){var a=Object.keys(e).filter((function(e){return!isNaN(parseInt(e,m))&&e===String(parseInt(e,m))})).length;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=parseInt(n,m)+a;if(!(i<m))break;e[i]=t[n]}}o(e),x(e)})):(o(e),x(e))})):b("admin"==c?"https://api.slpy.com/v1/search?autocomplete=admin"+d+"&country="+n+"&key="+i+"&search="+t:"https://api.slpy.com/v1/search?autocomplete=address&country="+n+"&key="+i+"&search="+t,(function(e){o(e),x(e)}))}}else y.classList.contains("apiautodropdown-content-show")&&(y.classList.remove("apiautodropdown-content-show"),f(window,"resize",u,!1),f(window,"scroll",u,!1))}}else y.classList.contains("apiautodropdown-content-show")&&y.classList.remove("apiautodropdown-content-show")},void 0===(I=p)&&(I=175),function(){clearTimeout(P);var e=Array.prototype.slice.call(arguments);P=setTimeout(function(){k.apply(this,e)}.bind(this),I)});v(a,"input",C,!1);var z=!1;function S(e){y.contains(e.target)||e.target===a||(y.classList.remove("apiautodropdown-content-show"),f(window,"resize",u,!1),f(window,"scroll",u,!1))}v(y,"touchstart",(function(e){e.currentTarget.getAttribute("id")=="apiautodropdownContent "+a.id&&(z=!1)}),!1),v(y,"touchmove",(function(e){e.currentTarget.getAttribute("id")=="apiautodropdownContent "+a.id&&(z=!0)}),!1),v(document,"click",S,!0),v(document,"touchend",S,!0);var M=function(e,t){return function(n){var i=function(e,t){for(;e&&e!==document;e=e.parentNode)if(e.matches?e.matches(t):e.msMatchesSelector(t))return e;return null}(n.target,".apiautodropdown-item");if(i){if(z)return;document.activeElement!==i&&i.focus();var r=i.textContent.trim();h=r.toLowerCase(),e.value=r,t.classList.remove("apiautodropdown-content-show"),f(window,"resize",u,!1),f(window,"scroll",u,!1);var l=i.getAttribute("autocompleteID");"function"==typeof o&&o(a,L[l])}else n.target.getAttribute("id")!=e.id&&(t.classList.remove("apiautodropdown-content-show"),f(window,"resize",u,!1),f(window,"scroll",u,!1))}}(a,y);return v(y,"click",M,!0),v(y,"touchend",M,!0),{updateAutocomplete:function(e){void 0!==e.country&&(n=e.country.toLowerCase()),void 0!==e.autocomplete&&(c=e.autocomplete.toLowerCase()),void 0!==e.filter&&(d="&filter="+e.filter.toLowerCase()),f(a,"input",C,!1),v(a,"input",C,!1)}}}let o={maplibreLoaded:!1,openlayersLoaded:!1,openlayersLoading:!1,openlayersReady:void 0,mapStyleUrl:"https://api.slpy.com/style/slpy-mgl-style.json",oldIE:!1,aerialImageryOn:!1,streetLevelOn:!1},a={openlayersFallback:!1,ieRasterFallback:!1,mapFilter:[],apiKey:""},n={ol:void 0,olms:void 0,maplibregl:void 0};function i(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2")&&!e.getContext("experimental-webgl2"))}catch(e){return!1}}function r(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,document.head.appendChild(t)}function l(e){return e*Math.PI/180}function s(e,t,o,a){var n=l(a-t);e=l(e),o=l(o);return 6371*Math.acos(Math.sin(e)*Math.sin(o)+Math.cos(e)*Math.cos(o)*Math.cos(n))}let c,d,m=!1;function p(e,t,o,a){var i=new n.ol.Feature({geometry:new n.ol.geom.Point(n.ol.proj.fromLonLat(e)),name:t}),r=window.btoa('<svg xmlns="http://www.w3.org/2000/svg" style="fill: #fff;display:box;stroke:#fff;stroke-width:15px;filter: drop-shadow(1px 2px 1px rgba(0,0,0,0.4));" width="27px" height="36px" viewBox="0 0 384 512">\x3c!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e<path d="M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/></svg>'),l=window.btoa('<svg xmlns="http://www.w3.org/2000/svg" style="fill: #fff; display:box;stroke:#fff;stroke-width:15px;filter: drop-shadow(1px 2px 1px rgba(0,0,0,0.4));" width="27px" height="36px" viewBox="0 0 384 512">\x3c!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e<path d="M384 192c0 87.4-117 243-168.3 307.2c-12.3 15.3-35.1 15.3-47.4 0C117 435 0 279.4 0 192C0 86 86 0 192 0S384 86 384 192z"/></svg>');if(i.setId("marker:"+o),"default"==a){var s=new n.ol.style.Style({image:new n.ol.style.Icon({opacity:1,color:"#a11c25",anchor:[.5,36],anchorXUnits:"fraction",anchorYUnits:"pixels",src:"data:image/svg+xml;base64,"+r})});return i.setStyle(s),i}s=new n.ol.style.Style({image:new n.ol.style.Icon({opacity:1,color:"#a11c25",anchor:[.5,36],anchorXUnits:"fraction",anchorYUnits:"pixels",src:"data:image/svg+xml;base64,"+l})});var c=new n.ol.style.Style({text:new n.ol.style.Text({text:(o+1).toString(),fill:new n.ol.style.Fill({color:"#fff"}),stroke:new n.ol.style.Stroke({color:"rgba(0,0,0,0.1)",width:1.5}),offsetY:-10,textBaseline:"bottom",textAlign:"center",font:'Normal 700 12px "Open Sans", "Arial", "Verdana", "sans-serif"'})}),d=new n.ol.Feature({geometry:new n.ol.geom.Point(n.ol.proj.fromLonLat(e)),name:t});return d.setStyle(c),i.setStyle(s),[i,d]}function y(e,t){"undefined"==typeof mapillary?setTimeout((function(){y(e,t)}),100):g(e,t)}function u(e){var t=document.createEvent("Event");t.state=e,t.initEvent("StreetLevel",!0,!1),window.dispatchEvent(t)}function g(e,t){var a=window.navigator.userAgent;if(a.indexOf("MSIE ")>0)u("failed load");else if(a.indexOf("Trident/")>0&&void 0===n.ol)u("failed load");else{if("undefined"==typeof mapillary){var i=document.createElement("link");i.href="https://unpkg.com/mapillary-js@4.1.1/dist/mapillary.css",i.rel="stylesheet",document.head.appendChild(i),r("https://unpkg.com/mapillary-js@4.1.1/dist/mapillary.js"),y(e,t)}var l=document.getElementById("mly"),c=void 0;if(c=void 0!==n.ol?t.getTargetElement():t.getContainer(),!l){var d=document.createElement("div");d.id="map-mapillary",c.parentNode.insertBefore(d,c),d.appendChild(c);var m=document.createElement("div");m.id="mly",d.appendChild(m)}if("undefined"!=typeof mapillary)if(void 0!==n.ol){u("loaded");var p=new n.ol.style.Style({text:new n.ol.style.Text({text:"",scale:1,font:'Normal 900 18px "Font Awesome 5 Free"',fill:new n.ol.style.Fill({color:"#a11d26"}),stroke:new n.ol.style.Stroke({color:"white",width:3})})}),g=function(e){return[new n.ol.style.Style({text:new n.ol.style.Text({text:"",scale:1,font:'Normal 900 18px "Font Awesome 5 Free"',textBaseline:"middle",textAlign:"center",rotation:e*Math.PI/180-45,fill:new n.ol.style.Fill({color:"#a11d26"}),stroke:new n.ol.style.Stroke({color:"white",width:3})})})]},h=new n.ol.style.Style({image:new n.ol.style.Circle({fill:new n.ol.style.Fill({color:"rgba(53, 175, 109,0.2)"}),radius:4})}),v=new n.ol.style.Style({image:new n.ol.style.Circle({fill:new n.ol.style.Fill({color:"rgba(53, 175, 109,0.5)"}),radius:4})}),f=new n.ol.layer.VectorTile({source:new n.ol.source.VectorTile({format:new n.ol.format.MVT,tileGrid:n.ol.tilegrid.createXYZ({maxZoom:14}),tilePixelRatio:16,maxZoom:14,url:"https://tiles.mapillary.com/maps/vtp/mly1_public/2/{z}/{x}/{y}?access_token="+e}),style:h,minZoom:14});class a extends n.ol.control.Control{constructor(e){var t=e||{},o=document.createElement("button");o.style.cssText='font: 900 1.14em "Font Awesome 5 Free"',o.innerHTML="";var a=document.createElement("div");a.className="ol-control",a.style.cssText="bottom: 55px; right: 8px; margin-bottom: 50px",a.appendChild(o),super({element:a,target:t.target}),o.addEventListener("click",this.handleStreetLevel.bind(this),!1)}handleStreetLevel(){if(t.getView().getZoom()<12&&!o.streetLevelOn)alert("Zoom in to get Street Level Imagery");else{var a=document.getElementsByClassName("mapillary-js-canvas")[0],i=document.getElementsByClassName("mapillary-js-dom")[0];if(o.streetLevelOn)f.setStyle(h),this.getMap().removeLayer(f),this.getMap().removeLayer(L),l.style.display="none",c.style.height="100%",c.style.width="100%",t.updateSize(),L.setVisible(!1),void 0!==a&&(a.style.display="none"),void 0!==i&&(i.style.display="none"),u("closed"),o.streetLevelOn=!1;else{var r=n.ol.proj.toLonLat(t.getView().getCenter()),d=n.ol.proj.transformExtent(t.getView().calculateExtent(t.getSize()),"EPSG:900913","EPSG:4326");s(d[0],d[1],d[2],d[3]);var m=c.parentNode,p=new XMLHttpRequest;p.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText);void 0!==e.data[0]?(u("active"),t.addLayer(f),t.addLayer(L),void 0!==o.aerialImageryOn&&o.aerialImageryOn&&f.setStyle(v),o.streetLevelOn=!0,k.moveTo(e.data[0].id).catch((function(e){console.log("Mapillary missing image")})),x.setStyle(g(e.data[0].compass_angle)),L.getVisible()||L.setVisible(!0),t.getView().getZoom()<18.5&&t.getView().animate({zoom:18.5,duration:250}),a=document.getElementsByClassName("mapillary-js-canvas")[0],i=document.getElementsByClassName("mapillary-js-dom")[0],void 0!==a&&(a.style.display="initial"),void 0!==i&&(i.style.display="initial")):(u("closed"),l.style.display="none",c.style.width="100%",c.style.height="100%",t.updateSize(),void 0!==a&&(a.style.display="none"),void 0!==i&&(i.style.display="none"),t.getView().getZoom()<=15?alert("No street level images available here.  Try zooming in."):alert("No street level images available here."))}else 4==this.readyState&&(u("closed"),l.style.display="none",c.style.width="100%",c.style.height="100%",t.updateSize(),void 0!==a&&(a.style.display="none"),void 0!==i&&(i.style.display="none"),console.log("Could not connect to Mapillary"))},u("opened"),l.style.display="block",m.offsetHeight>m.offsetWidth?(c.style.height="35%",c.style.width="100%",l.style.width="100%",l.style.height="65%"):(c.style.width="35%",c.style.height="100%",l.style.height="100%",l.style.width="65%"),k.resize(),t.updateSize(),p.open("GET","https://graph.mapillary.com/images?access_token="+e+"&fields=image_key,compass_angle&limit=1&closeto="+r.toString()+"&bbox="+d.toString(),!0),p.send()}}}}t.addControl(new a);var w=new n.ol.Feature({geometry:new n.ol.geom.Point(ol.proj.fromLonLat(center))});w.setStyle([p]);var b,L=new n.ol.layer.Vector({source:new n.ol.source.Vector({features:[w]}),visible:!1}),x=new n.ol.layer.Vector({source:new n.ol.source.Vector,map:t,style:[p]}),k=new mapillary.Viewer({accessToken:e,component:{cover:!1},container:"mly"});k.on("image",(function(e){x.getVisible()&&x.setVisible(!1);var o=n.ol.proj.fromLonLat([e.image.originalLngLat.lng,e.image.originalLngLat.lat]);t.getView().setCenter(o),w.getGeometry().setCoordinates(o),w.setStyle(g(e.image.compassAngle))})),t.on("click",(function(e){!function(e,o){var a=t.forEachFeatureAtPixel(e,(function(e,t){return e}),{layerFilter:function(e){return e===f},hitTolerance:5});if(a){if(o){var n=a.get("compassAngle");if(k.moveTo(a.get("id")).catch((function(e){console.log("Mapillary missing image")})),x.setStyle(g(n)),!L.getVisible()){l.style.display="block";var i=c.parentNode;i.offsetHeight>i.offsetWidth?(c.style.height="35%",c.style.width="100%",l.style.width="100%",l.style.height="65%"):(c.style.width="35%",c.style.height="100%",l.style.height="100%",l.style.width="65%"),k.resize(),t.updateSize(),L.setVisible(!0)}}if(a!==b){if(b&&void 0!==b)try{x.getSource().removeFeature(b)}catch(e){}if(a&&void 0!==a)try{x.getSource().addFeature(a)}catch(e){}b=a}}}(e.pixel,!0)})),window.addEventListener("resize",(function(){if(o.streetLevelOn){var e=c.parentNode;e.offsetHeight>e.offsetWidth?(c.style.height="35%",c.style.width="100%",l.style.width="100%",l.style.height="65%"):(c.style.width="35%",c.style.height="100%",l.style.height="100%",l.style.width="65%"),k.resize(),t.updateSize()}}))}else{var I=function(){},P=function(){if(t.getZoom()<12&&!o.streetLevelOn)alert("Zoom in to get Street Level Imagery");else{var a=document.getElementsByClassName("mapillary-js-canvas")[0],n=document.getElementsByClassName("mapillary-js-dom")[0];if(o.streetLevelOn)t.removeLayer("mimgLayer"),t.removeLayer("streetLevelIcon"),l.style.display="none",c.style.height="100%",c.style.width="100%",t.resize(),void 0!==a&&(a.style.display="none"),void 0!==n&&(n.style.display="none"),u("closed"),o.streetLevelOn=!1;else{var i=t.getCenter().toArray(),r=t.getBounds().toArray();s(r[0][0],r[0][1],r[1][0],r[1][1]);var d=new XMLHttpRequest;z&&(t.addSource("mimgLayer",f),t.addSource("streetLevelIcon",C),z=!1),d.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText);if(void 0!==e.data[0]){var i="0.2";void 0!==o.aerialImageryOn&&o.aerialImageryOn&&(i="0.5"),t.addLayer({id:"mimgLayer",type:"circle",source:"mimgLayer","source-layer":"image",minzoom:14,maxzoom:22,paint:{"circle-color":"rgba(53, 175, 109,"+i+")"}}),t.addLayer({id:"streetLevelIcon",type:"symbol",source:"streetLevelIcon",paint:{"text-color":"#a11d26","text-halo-color":"#fff","text-halo-width":2.25,"text-translate":[0,0]},layout:{"text-field":"","text-size":20,"text-font":["fasolid-900"],"text-rotate":["get","bearing"],"text-anchor":"center","text-offset":[0,0]}}),o.streetLevelOn=!0,u("active"),k.moveTo(e.data[0].id).catch((function(e){console.log("Mapillary missing image")})),t.getZoom()<17.5&&t.zoomTo(17.5),a=document.getElementsByClassName("mapillary-js-canvas")[0],n=document.getElementsByClassName("mapillary-js-dom")[0],void 0!==a&&(a.style.display="initial"),void 0!==n&&(n.style.display="initial")}else l.style.display="none",c.style.height="100%",c.style.width="100%",t.resize(),void 0!==a&&(a.style.display="none"),void 0!==n&&(n.style.display="none"),u("closed"),t.getZoom()<=15?alert("No street level images available here.  Try zooming in."):alert("No street level images available here.")}else 4==this.readyState&&(l.style.display="none",c.style.height="100%",c.style.width="100%",t.resize(),void 0!==a&&(a.style.display="none"),void 0!==n&&(n.style.display="none"),u("closed"))},l.style.display="block";var m=c.parentNode;m.offsetHeight>m.offsetWidth?(c.style.height="35%",c.style.width="100%",l.style.width="100%",l.style.height="65%"):(c.style.width="35%",c.style.height="100%",l.style.height="100%",l.style.width="65%"),k.resize(),t.resize(),u("opened"),d.open("GET","https://graph.mapillary.com/images?access_token="+e+"&fields=image_key&limit=1&closeto="+i[0]+","+i[1]+"&bbox="+r[0][0]+","+r[0][1]+","+r[1][0]+","+r[1][1],!0),d.send()}}};u("loaded");var C={type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[0,0]},properties:{bearing:90}}};f={type:"vector",tiles:["https://tiles.mapillary.com/maps/vtp/mly1_public/2/{z}/{x}/{y}?access_token="+e],minzoom:14,maxzoom:14};I.prototype.onAdd=function(e){this._map=e,this._container=document.createElement("div"),this._container.className="maplibregl-ctrl maplibregl-ctrl-group",this._container.style.cssText="pointer-events: auto;";var t=document.createElement("button");t.setAttribute("id","streetLevButton"),t.addEventListener("click",P),this._container.appendChild(t);var o=document.createElement("span");return o.style.cssText='background-image: url("https://api.slpy.com/symbols/walking-solid.svg");background-size: 1em;',o.className="maplibregl-ctrl-icon",t.appendChild(o),this._container},I.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map=void 0},I=new I,t.addControl(I,"bottom-right"),o.streetLevelOn=!1;var z=!0;(k=new mapillary.Viewer({accessToken:e,component:{cover:!1},container:"mly"})).on("image",(function(e){var o=[e.image.originalLngLat.lng,e.image.originalLngLat.lat],a={type:"Feature",geometry:{type:"Point",coordinates:o},properties:{bearing:e.image.compassAngle-45}};t.getSource("streetLevelIcon").setData(a),t.flyTo({center:o})})),t.on("click",(function(e){if(void 0!==o.streetLevelOn&&o.streetLevelOn){var a=t.queryRenderedFeatures(e.point,{layers:["mimgLayer"]});if(void 0!==a[0]){var n=a[0].properties.id;k.moveTo(n).catch((function(e){console.log("Mapillary missing image")}))}}})),window.addEventListener("resize",(function(){if(o.streetLevelOn){var e=c.parentNode;e.offsetHeight>e.offsetWidth?(c.style.height="35%",c.style.width="100%",l.style.width="100%",l.style.height="65%"):(c.style.width="35%",c.style.height="100%",l.style.height="100%",l.style.width="65%"),k.resize(),t.resize()}}))}}}var h={addressAutocomplete:function(e,o){if("string"==typeof e)var a=document.getElementById(e);else if(!e||"form"!==target.nodeName.toLowerCase()&&"textarea"!==e.nodeName.toLowerCase())console.log("Target form for address autocomplete is not a valid Form element or id.");else a=e;if(o.autocompleteType="address","form"===a.tagName.toLowerCase()){for(var n=a.querySelectorAll("input[autocomplete], textarea[autocomplete]"),i={},r=0;r<n.length;r++){var l=n[r].getAttribute("autocomplete");if(l){var s="0";if(void 0!==l.split(" ")[1]){var c=l.lastIndexOf(" ");s=l.slice(0,c),l=l.slice(c+1),void 0===i[s]&&(i[s]={})}switch(l){case"street-address":case"address-line1":i[s]["street-line"]=n[r];break;case"address-level1":i[s]["address-level1"]=n[r];break;case"address-level2":i[s]["address-level2"]=n[r];break;case"address-level3":i[s]["address-level3"]=n[r];break;case"address-level4":i[s]["address-level4"]=n[r];break;case"postal-code":i[s]["postal-code"]=n[r];break;case"country":i[s].country=n[r];break;case"country-name":i[s]["country-name"]=n[r]}}}var d=[];for(var m in i)i.hasOwnProperty(m)&&(void 0!==i[m]["street-line"]?(void 0!==i[m]["street-line"].id&&""!=i[m]["street-line"].id||(i[m]["street-line"].id="StAuto-"+m),function(e,a){var n=t(a[e]["street-line"].id,o,(function(t,o){for(var n in t.value=o.street,a[e])switch(n){case"address-level1":a[e]["address-level1"].value=o.region;break;case"address-level2":a[e]["address-level2"].value=o.city;break;case"postal-code":a[e]["postal-code"].value=o.postcode;break;case"country":a[e].country.value=o.country;break;case"country-code":a[e]["country-code"].value=o["country-code"]}}));void 0!==n.updateAutocomplete&&d.push(n)}(m,i)):console.log("API: An input with autocomplete attribute 'street-address' or 'address-line1' was not found."));return d}},addAerialImagery:function(e){var t=!0,i=[[[-104.853516,29.774649],[-80.90332,41.808621]],[[-114.697266,31.733423],[-106.54541,49.09563]],[[-125.727539,32.407206],[-114.609375,49.125338]],[[-108.149414,31.735093],[-104.633789,49.152471]],[[-81.101074,31.864267],[-69.675293,42.359457]],[[-83.693848,24.493357],[-79.848633,30.395503]],[[-101.645508,28.849233],[-84.528809,29.749476]],[[-100.623779,25.743899],[-95.339355,28.827531]],[[-106.479492,30.340827],[-104.699707,32.162079]],[[-112.543945,31.25324],[-108.105469,31.964051]],[[-104.897461,41.758319],[-82.375488,46.029057]],[[-104.919434,45.943561],[-83.210449,47.548488]],[[-104.941406,47.48012],[-88.088379,48.298688]],[[-104.952393,48.277197],[-92.362061,49.418971]],[[-79.969482,42.295311],[-69.829102,43.573655]],[[-76.640625,43.53305],[-66.52771,45.077231]],[[-71.5979,45.03054],[-66.994629,47.493728]],[[-160.532227,18.773407],[-154.423828,22.493078]],[[-67.985919,17.265936],[-64.52648,18.884333]],[[-168.354492,52.855864],[-140.800781,71.441149]],[[-142.03125,54.626423],[-129.726563,60.533801]]];if(void 0!==n.ol){var r=function(){var t=e.getView().getZoom();if(t<8.5)return!0;if(t>19)return!1;var o=!1,a=0,r=e.getView().getCenter();do{var l=new n.ol.extent.boundingExtent([n.ol.proj.fromLonLat(i[a][0]),n.ol.proj.fromLonLat(i[a][1])]);o=n.ol.extent.containsCoordinate(l,r),a++}while(!o&&a<20);return o},l=new n.ol.layer.Tile({source:new n.ol.source.XYZ({format:new n.ol.format.MVT,maxZoom:16,url:"https://api.slpy.com/v1/app/aerial-imagery/{z}/{x}/{y}.png?key="+a.apiKey}),minZoom:0,maxZoom:19,zindex:0}),s=new n.ol.layer.Tile({source:new n.ol.source.XYZ({format:new n.ol.format.MVT,maxZoom:16,url:"https://api.slpy.com/v1/app/aerial-topo/{z}/{x}/{y}.png?key="+a.apiKey}),minZoom:0,maxZoom:19,zindex:0});class t extends n.ol.control.Control{constructor(e){var t=e||{},o=document.createElement("button");o.style.cssText='background-image: url("https://www.slpy.com/img/AerialImagery.png");background-size: contain;border-radius: 4px; width: 45px; height: 45px',o.setAttribute("id","AerialImageryIcon");var a=document.createElement("div");a.className="ol-control",a.setAttribute("id","AerialImageryButton"),a.style.cssText="bottom: 0; right: 8px; margin-bottom: 50px; width: 45px; height: 45px",a.appendChild(o),super({element:a,target:t.target}),o.addEventListener("click",this.AerialImageryControl.bind(this),!1)}AerialImageryControl(){o.aerialImageryOn?(o.oldIE?this.getMap().removeLayer(s):(this.getMap().removeLayer(l),void 0!==o.streetLevelOn&&o.streetLevelOn&&mapillarySource.setStyle(photoDot)),document.getElementById("AerialImageryIcon").style.backgroundImage="url('https://www.slpy.com/img/AerialImagery.png')",o.aerialImageryOn=!1,e.getLayers().forEach((function(e){e.getSource().refresh()}))):r()?(o.aerialImageryOn=!0,o.oldIE=!0,o.oldIE?e.addLayer(s):(e.getLayers().forEach((function(e){e.getSource().refresh()})),e.getLayers().insertAt(0,l),void 0!==o.streetLevelOn&&o.streetLevelOn&&mapillarySource.setStyle(photoDotAerial)),document.getElementById("AerialImageryIcon").style.backgroundImage="url('https://www.slpy.com/img/VectorImagery.png')"):e.getView().getZoom()>18?alert("No Aerial Imagery at this level.  Try zooming out."):alert("No Aerial Imagery available in this region.")}}e.addControl(new t);var c=!0,d=document.getElementById("AerialImageryButton");r()||(d.style.display="none",c=!1),e.on("moveend",(function(){r()&&!c?(d.style.display="block",c=!0):!r()&&c&&(d.style.display="none",c=!1,o.aerialImageryOn&&document.getElementById("AerialImageryIcon").click())}))}else if(o.maplibreLoaded){var m=function(){var t=e.getZoom();if(t<7.5)return!0;if(t>18)return!1;var o=!1,a=0,r=e.getCenter();do{o=new n.maplibregl.LngLatBounds(i[a]).contains(r),a++}while(!o&&a<20);return o},p="",y=function(){},u=function(){if(o.aerialImageryOn){if(void 0!==o.streetLevelOn)if(o.streetLevelOn){var a=e.getSource("streetLevelIcon"),n=e.getSource("mimgLayer"),i=e.getLayer("mimgLayer"),r=e.getLayer("streetLevelIcon");e.setStyle(p),n||e.addSource("mimgLayer",{type:"vector",tiles:n.tiles,minzoom:n.minzoom,maxzoom:n.maxzoom}),a||e.addSource("streetLevelIcon",{type:"geojson",data:a._data}),i||e.addLayer({id:"mimgLayer",type:"circle",source:"mimgLayer","source-layer":"mapillary-images",minzoom:i.minzoom,maxzoom:i.maxzoom,paint:i.paint_}),r||e.addLayer({id:"streetLevelIcon",type:"symbol",source:"streetLevelIcon",paint:r.paint_,layout:r.layout_})}else e.setStyle(p),e.getLayer("mimgLayer")&&e.removeLayer("mimgLayer"),e.getLayer("streetLevelIcon")&&e.removeLayer("streetLevelIcon");else e.setStyle(p);document.getElementById("AerialImageryIcon").style.backgroundImage="url('https://www.slpy.com/img/AerialImagery.png')",o.aerialImageryOn=!1}else m()?(t&&(e.addSource("satellite",g),t=!1),p=e.getStyle(),void 0!==o.streetLevelOn&&o.streetLevelOn&&e.setPaintProperty("mimgLayer","circle-color","rgba(53, 175, 109,0.5)"),e.addLayer({id:"satellite",type:"raster",source:"satellite",minzoom:0,maxzoom:18},"necountries-4"),document.getElementById("AerialImageryIcon").style.backgroundImage="url('https://www.slpy.com/img/VectorImagery.png')",e.setLayoutProperty("roads-casing","visibility","none"),e.setLayoutProperty("roads-motorway-casing","visibility","none"),e.setLayoutProperty("highway-area-fill","visibility","none"),e.setLayoutProperty("highway-motorway-shadow","visibility","none"),e.setLayoutProperty("highway-trunk-shadow","visibility","none"),e.setLayoutProperty("roads-low-zoom-shadow","visibility","none"),e.setPaintProperty("highway-motorway","line-color","#edaa82"),e.setPaintProperty("roads","line-opacity",.5),e.setPaintProperty("roads-low-zoom-secondary","line-opacity",.5),e.setPaintProperty("roads-low-zoom-trunk","line-opacity",.3),e.setPaintProperty("highway-motorway","line-opacity",.5),e.setPaintProperty("highway-trunk","line-color","#bbb"),e.setPaintProperty("highway-trunk","line-width",1),e.setPaintProperty("highway-trunk","line-opacity",.5),e.setPaintProperty("ferry-routes","line-opacity",.5),e.setPaintProperty("roads-text-name","text-color","#000"),e.setPaintProperty("roads-text-name","text-halo-width",1.25),e.setPaintProperty("placenames","text-color","#fff"),e.setPaintProperty("placenames","text-halo-color","#000"),e.setPaintProperty("placenames","text-halo-width",1),e.setPaintProperty("placenames-small","text-color","#fff"),e.setPaintProperty("placenames-small","text-halo-color","#555"),e.setPaintProperty("placenames-small","text-halo-width",1.5),e.setPaintProperty("ocean-points","text-halo-color","#4f6f80"),e.setPaintProperty("ocean-points","text-color","#fff"),e.setPaintProperty("state-names","text-halo-color","rgba(114, 83, 128, 0.6)"),e.setPaintProperty("state-names","text-color","rgba(255, 255, 255, 0.6)"),e.setPaintProperty("state-names-low-zoom","text-halo-color","rgba(114, 83, 128, 0.6)"),e.setPaintProperty("state-names-low-zoom","text-color","rgba(255, 255, 255, 0.6)"),e.setPaintProperty("amenity-points-landuse","text-halo-color","#fff"),e.setPaintProperty("amenity-points-landuse","text-halo-width",1),e.setPaintProperty("text-poly-low-zoom","text-halo-color","#fff"),e.setPaintProperty("text-poly-low-zoom","text-halo-width",.5),e.setPaintProperty("amenity-points-low-icon","text-halo-width",.5),e.setPaintProperty("amenity-points-icon","text-halo-width",.5),e.setPaintProperty("amenity-points-mid-icon","text-halo-width",.5),e.setPaintProperty("amenity-points-high-icon","text-halo-width",.5),e.setPaintProperty("amenity-points-low","text-halo-width",.6),e.setPaintProperty("amenity-points-text","text-halo-width",.6),e.setPaintProperty("amenity-points-mid","text-halo-width",.6),e.setPaintProperty("amenity-points-high","text-halo-width",.6),e.setPaintProperty("necountries-4","line-color","#222"),e.setPaintProperty("necountries-2","line-color","#222"),e.setPaintProperty("admin-mid-zoom-2","line-color","#222"),e.setPaintProperty("admin-mid-zoom-3","line-color","#222"),e.setPaintProperty("admin-mid-zoom-4","line-color","#222"),e.setPaintProperty("admin-high-zoom-2","line-color","#222"),e.setPaintProperty("admin-high-zoom-3","line-color","#222"),e.setPaintProperty("admin-high-zoom-4","line-color","#222"),o.aerialImageryOn=!0):e.getZoom()>18?alert("No Aerial Imagery at this level.  Try zooming out."):alert("No Aerial Imagery available in this region.")},g={type:"raster",scheme:"xyz",tiles:["https://api.slpy.com/v1/app/aerial-imagery/{z}/{x}/{y}.png?key="+a.apiKey],minzoom:0,maxzoom:16,tileSize:256};y.prototype.onAdd=function(e){this._map=e,this._container=document.createElement("div"),this._container.className="maplibregl-ctrl maplibregl-ctrl-group",this._container.style.cssText="pointer-events: auto;",this._container.setAttribute("id","AerialImageryButton");var t=document.createElement("button");t.style.width="45px",t.style.height="45px",t.addEventListener("click",u),this._container.appendChild(t);var o=document.createElement("span");return o.style.cssText='background-image: url("https://www.slpy.com/img/AerialImagery.png");background-size: contain;border-radius: 4px;',o.setAttribute("id","AerialImageryIcon"),o.className="maplibregl-ctrl-icon",t.appendChild(o),this._container},y.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map=void 0},y=new y,e.addControl(y,"bottom-right");c=!0,d=document.getElementById("AerialImageryButton");m()||(d.style.display="none",c=!1),e.on("idle",(function(){m()&&!c?(d.style.display="block",c=!0):!m()&&c&&(d.style.display="none",c=!1,o.aerialImageryOn&&u())}))}},addAutocomplete:t,addMarkers:function(e,t,o){o=void 0===o?"default":o;var a=[];if(void 0!==n.ol){for(var i=0;i<e.length;i++){if("default"==o)a.push(p([e[i].data[1],e[i].data[0]],e[i].name,i,o));else{var r=p([e[i].data[1],e[i].data[0]],e[i].name,i,o);a.push(r[0],r[1])}void 0!==e[i].data[2]&&""!==e[i].data[2]&&(m=!0)}if(c=new n.ol.source.Vector({features:a}),d=new n.ol.layer.Vector({source:c,className:"ol-markers"}),t.once("postrender",(function(e){t.addLayer(d)})),m){if(null==document.getElementById("popup")){var l=document.createElement("div");l.innerHTML='<a href="#" id="popup-closer" class="ol-popup-closer"></a><div id="popup-content"></div>',l.id="popup",l.classList.add("ol-popup"),t.getTargetElement().appendChild(l)}var s=document.getElementById("popup"),y=document.getElementById("popup-content"),u=document.getElementById("popup-closer");markerOverlay=new n.ol.Overlay({element:s,autoPan:!0,position:void 0,autoPanAnimation:{duration:250}}),t.addOverlay(markerOverlay),u.onclick=function(){return markerOverlay.setPosition(void 0),u.blur(),!1},t.on("singleclick",(function(o){var a=t.forEachFeatureAtPixel(o.pixel,(function(e){return e.getId()}));"string"==typeof a&&(markerIndex=a.replace("marker:",""),markerIndex>=0&&""!=e[markerIndex].data[2]&&void 0!==e[markerIndex].data[2]?(s.style.display="block",y.innerHTML=e[markerIndex].data[2],markerOverlay.setPosition(n.ol.proj.fromLonLat([e[markerIndex].data[1],e[markerIndex].data[0]]))):s.style.display="none")}))}}else{var g='\x3c!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e<path d="M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/></svg>',h='\x3c!--! Font Awesome Pro 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e<path d="M384 192c0 87.4-117 243-168.3 307.2c-12.3 15.3-35.1 15.3-47.4 0C117 435 0 279.4 0 192C0 86 86 0 192 0S384 86 384 192z"/></svg>';for(i=0;i<e.length;i++){var v='<svg xmlns="http://www.w3.org/2000/svg" id="marker-'+parseInt([i]).toString()+'" style="fill: #a11c25;width:27px; height:36px;stroke:#fff;stroke-width:15px;filter: drop-shadow(1px 2px 1px rgba(0,0,0,0.4));" viewBox="0 0 384 512">';if(m=!1,void 0!==e[i].data[2]&&""!==e[i].data[2]&&(m=!0),"default"==o){if(m)(f=document.createElement("span")).innerHTML=v+g,new n.maplibregl.Marker({element:f,anchor:"bottom",offset:[0,5]}).setLngLat([e[i].data[1],e[i].data[0]]).setPopup(new n.maplibregl.Popup({offset:[0,-36],className:"popup-"+[i]}).setHTML(e[i].data[2])).addTo(t);else(f=document.createElement("span")).innerHTML=v+g,new n.maplibregl.Marker({element:f,anchor:"bottom",offset:[0,5]}).setLngLat([e[i].data[1],e[i].data[0]]).addTo(t)}else{var f,w,b='position: absolute;font-weight: bold;top:5px;display: block; width:27px;left:0px;font-size:14px;color:white;text-align:center;text-shadow:-1px -1px 0 rgba(0,0,0,0.25), 1px -1px 0 rgba(0,0,0,0.25), -1px 1px 0 rgba(0,0,0,0.25), 1px 1px 0 rgba(0,0,0,0.25);font-family:"Open Sans", "Arial", "Verdana", "sans-serif"';if(m)(f=document.createElement("span")).innerHTML=v+h,(w=document.createElement("span")).innerHTML=(parseInt([i])+1).toString(),w.setAttribute("style",b),f.appendChild(w),new n.maplibregl.Marker({element:f,anchor:"bottom",offset:[0,5]}).setLngLat([e[i].data[1],e[i].data[0]]).setPopup(new n.maplibregl.Popup({offset:[0,-36],className:"popup-"+[i]}).setHTML(e[i].data[2])).addTo(t);else(f=document.createElement("span")).innerHTML=v+h,(w=document.createElement("span")).innerHTML=(parseInt([i])+1).toString(),w.setAttribute("style",b),f.appendChild(w),new n.maplibregl.Marker({element:f,anchor:"bottom",offset:[0,5]}).setLngLat([e[i].data[1],e[i].data[0]]).addTo(t)}}}},highlightMarker:function(e){if(void 0!==d){var t=d.getSource().getFeatureById("marker:"+e);if(null!==t){var o=t.getStyle().getImage();void 0!==o.iconImage_&&void 0!==o.iconImage_.color_&&(o.iconImage_.color_=[0,130,200,1]),t.getStyle().setZIndex(1)}}else{var a=document.getElementById("marker-"+e);a&&(a.style.fill="#0082c8",a.parentElement.style.zIndex=1)}},dehighlightMarker:function(e){if(void 0!==d){var t=d.getSource().getFeatureById("marker:"+e);if(null!==t){var o=t.getStyle().getImage();void 0!==o.iconImage_&&void 0!==o.iconImage_.color_&&(o.iconImage_.color_=[161,28,37,1]),t.getStyle().setZIndex(0)}}else{var a=document.getElementById("marker-"+e);a&&(a.style.fill="#a11c25",a.parentElement.style.zIndex=0)}},removeMarker:function(e,t){if((t=void 0===t?-1:t)<0&&(t=0),void 0!==n.ol){if(void 0!==d){var o=d.getSource().getFeatureById("marker:"+t);null!==o&&c.removeFeature(o)}if(void 0!==e[t])if(void 0!==e[t].data[2])if(""!==e[t].data[2])document.getElementById("popup").style.display="none"}else{var a=document.getElementById("marker-"+t);if(a){var i=document.querySelector(".maplibre-popup.popup-"+t);i&&i.remove(),a.parentElement.remove()}}},createMarker:p,setMarkerOpen:function(e,t){if(t=void 0===t?-1:t,void 0!==n.ol){var o=document.getElementById("popup"),a=document.getElementById("popup-content");t<0&&(t=0),o.style.display="block",a.innerHTML=e[t].data[2];try{markerOverlay.setPosition(n.ol.proj.fromLonLat([e[t].data[1],e[t].data[0]]))}catch(e){}}else{var i=document.getElementById("marker-"+t);i&&i.parentElement.click()}},quickMarkersCenter:function(e){for(var t=0,o=0,a=[],n=[],i=e.length,r=0;r<i;++r)t+=Number(e[r].data[0]),o+=Number(e[r].data[1]),a.push(e[r].data[0]),n.push(e[r].data[1]);var l=s(Math.max.apply(Math,a),Math.max.apply(Math,n),Math.min.apply(Math,a),Math.min.apply(Math,n)),c=13;switch(!0){case l<1:c=14;break;case l<4:c=13;break;case l<10:c=12;break;case l<20:c=11;break;case l<40:c=10;break;case l<100:c=9;break;case l<250:c=8;break;case l<400:c=7;break;case l<750:c=6;break;case l<2e3:c=5;break;case l<4e3:c=4;break;case l>=4e3:c=3}return[t/=i,o/=i,c]},addMapillary:g,isWebGL2Supported:i,loadScript:r,setInteractionOnFocus:function(e,t){var a=document.getElementById(e);a.style.position="relative",a.tabIndex=1,a.insertAdjacentHTML("afterbegin",'<p id="mapOverlayNotice" style="position:absolute;z-index:10;margin-top:20px;width:100%;height:100%;font-weight:bold;font-size:22px;color:black;display:none;text-align:center;justify-content: center; align-items: center;"><span style="background:white;padding: 10px;border-radius: 10px;box-shadow: 2px 2px 4px #555;">Click the map to pan and zoom.</span></p>');var i=document.getElementById("mapOverlayNotice");void 0!==n.ol?(o.openlayersLoaded&&t.getInteractions().forEach((function(e){(e instanceof n.ol.interaction.DragPan||e instanceof n.ol.interaction.MouseWheelZoom)&&e.setActive(!1)}),this),a.onclick=function(){a.removeEventListener("wheel",l,!1),a.removeEventListener("touchmove",l,!1),o.openlayersLoaded&&t.getInteractions().forEach((function(e){(e instanceof n.ol.interaction.DragPan||e instanceof n.ol.interaction.MouseWheelZoom)&&e.setActive(!0)}),this)}):(o.maplibreLoaded&&(t.scrollZoom.disable(),t.dragPan.disable()),a.onclick=function(){a.removeEventListener("wheel",l,!1),a.removeEventListener("touchmove",l,!1),o.maplibreLoaded&&(t.scrollZoom.enable(),t.dragPan.enable())});var r=null,l=function(e){document.activeElement!==a&&(a.style.opacity="0.7",i.style.display="flex",null!==r&&clearTimeout(r),r=setTimeout((function(){i.style.display="none",a.style.opacity="1"}),500))};a.addEventListener("wheel",l,!1),a.addEventListener("touchmove",l,!1)},setTransform:function(e,t){if(void 0!==t)if(void 0===n.ol)if(void 0!==o.mapStyleUrl){for(var a=o.mapStyleUrl.split("?"),i=a[0],r=a[1].split("&"),l=[],s=0;s<r.length;s++)-1===r[s].indexOf("transform=")&&l.push(r[s]);o.mapStyleUrl=i+"?"+l.join("&"),""!=e&&"default"!=e&&(o.mapStyleUrl=o.mapStyleUrl+"&transform="+e),t.setStyle(o.mapStyleUrl)}else console.log("Could not retrieve original url. mapStyleUrl is undefined.");else console.log("Can not currently set Transform with OpenLayers.  Requires MapLibre.");else console.log("Map was undefined.  The second parameter should be of type Map.")},flyTo:function(e,t){if(void 0!==n.ol)var o=t.getView(),a=n.ol.proj.toLonLat(o.getCenter()),i=n.ol.proj.fromLonLat([e.lon,e.lat]),r=o.getZoom(),l=e.quality,c=function(){},d=2,m=!1;else{l=e.quality;var p=t.getCenter();a=Object.values(p),i=[e.lon,e.lat],r=t.getZoom()}var y=s(e.lat,e.lon,a[1],a[0]),u=5e3,g=r-1;switch(!0){case y<1:r>16&&(g=16),u=1e3;break;case y<5:r>15&&(g=15),u=1e3;break;case y<10:r>14&&(g=14),u=1e3;break;case y<40:r>13&&(g=13),u=1e3;break;case y<50:r>12&&(g=12),u=2e3;break;case y<150:r>11&&(g=11),u=2e3;break;case y<250:r>10&&(g=10),u=2e3;break;case y<400:r>9&&(g=9),u=3e3;break;case y<700:r>8&&(g=8),u=3e3;break;case y<1e3:r>7&&(g=7),u=3e3;break;case y<2e3:r>6&&(g=6),u=4e3;break;case y<3500:r>5&&(g=5),u=4e3;break;case y<5e3:r>4&&(g=4),u=4e3;break;case y>=5e3:r>3&&(g=3),u=4e3}switch(r<13&&(r=13),parseInt(l)){case 1:r=4;break;case 2:r=6;break;case 3:r=8;break;case 4:r=10;break;case 5:r=12;break;case 6:r=13;break;case 7:r=14;break;case 8:r=16.5;break;case 9:case 10:r=17}if(g>=r&&(g=r-1),void 0!==n.ol){var h=function(e){--d,m||0!==d&&e||(m=!0,c(e))};o.animate({center:i,duration:u},h),o.animate({zoom:g,duration:u},{zoom:r,duration:u/2},h)}else t.flyTo({center:i,minZoom:g,zoom:r,maxDuration:2.5*u})},toRad:l,distanceInKM:s,distanceInMI:function(e,t,o,a){var n=l(a-t);return e=l(e),o=l(o),3959*Math.acos(Math.sin(e)*Math.sin(o)+Math.cos(e)*Math.cos(o)*Math.cos(n))},mapState:o,settings:a,openlayersParts:{view:{},controls:{},interactions:{}},mapLibraries:n};function v(t){return n.maplibregl=function(){let t={};if("undefined"!=typeof window&&void 0!==window.maplibregl)return window.maplibregl;try{t={...e}}catch(e){console.log(e),console.log("Slpy JS: 'maplibre' could not be found. Make sure https://github.com/maplibre/maplibre-gl-js  is installed and/or the script has been run before this function.")}return t}(),function(e,t){if(void 0===n.maplibregl||!i()){if(0==t){if("string"==typeof(o=e))var o=document.getElementById(e);void 0===n.maplibregl?o.insertAdjacentHTML("afterbegin",'<p id="mapOverlayNotice">The Maplibre GL library could not be found or imported.</p>'):o.insertAdjacentHTML("afterbegin",'<p id="mapOverlayNotice">Your Web Browser is not compatible.  Please upgrade.</p>'),o.innerHTML=""}return!1}return!0}((t=function(e){return e.apiKey||console.log("Slpy Map Missing apiKey: Please add your Slpy apiKey to the options object in the maplibreMap function."),e.container||console.log("Slpy Map Missing container: Please add your container id or element to the options object in the maplibreMap function."),e.center||console.log("Slpy Map Missing center: Please add your center as a [longitude, latitude] element to the options object in the maplibreMap function."),e.zoom||console.log("Slpy Map Missing zoom: Please add a zoom value to the options object in the maplibreMap function. Level 0 is globe, 20 is house level."),void 0!==e.mapType&&"raster"==e.mapType.toLowerCase()?e.mapType="raster":e.mapType="vector",void 0!==e.mapLanguage&&"en"!=e.mapLanguage.toLowerCase()?e.mapLanguage=e.mapLanguage.toLowerCase():e.mapLanguage="en",void 0!==e.mapFilter&&e.mapFilter.length>0&&(a.mapFilter=e.mapFilter),a.apiKey=e.apiKey.toLowerCase(),e}(t)).container,!1)?function(e){o.maplibreLoaded=!0,"undefined"!=typeof MglOptions&&(e=Object.assign(e,MglOptions));var t=!1;o.mapStyleUrl="https://api.slpy.com/style/slpy-mgl-style.json?key="+a.apiKey;var i="top-left";if("raster"==e.mapType?(t=!1,o.mapStyleUrl+="&raster=true"):e.mapStyle&&"3d"==e.mapStyle.toLowerCase()&&(t=!0,o.mapStyleUrl+="&style=3d"),void 0!==e.mapTransform&&e.mapTransform.length>0&&(o.mapStyleUrl+="&transform="+e.mapTransform.toLowerCase()),void 0!==a.mapFilter&&a.mapFilter.length>0){o.mapStyleUrl+="&filter=",o.mapStyleUrl+="&filter=";for(var r=0;r<a.mapFilter.length;r++)o.mapStyleUrl+=a.mapFilter[r].toLowerCase().replace("_points","")+",";o.mapStyleUrl=o.mapStyleUrl.substring(0,o.mapStyleUrl.length-1)}"en"!=e.mapLanguage&&(o.mapStyleUrl+="&lang="+e.mapLanguage);var l={container:e.container,style:o.mapStyleUrl,center:e.center,zoom:e.zoom,antialias:t,hash:!1,attributionControl:!1};if(""!==e)for(var s in e)l[s]=e[s];return void 0!==e.navControl&&"none"==e.navControl.toLowerCase()?new n.maplibregl.Map(l).addControl(new n.maplibregl.AttributionControl({compact:!1})):(e.navControl&&(i=e.navControl),new n.maplibregl.Map(l).addControl(new n.maplibregl.AttributionControl({compact:!1})).addControl(new n.maplibregl.NavigationControl,i))}(t):""}const f={maplibreMap:v,...h};export{h as generalFunctions,v as maplibreMap,f as slpy};
